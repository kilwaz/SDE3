-- MySQL dump 10.13  Distrib 5.5.46, for debian-linux-gnu (x86_64)
--
-- Host: localhost    Database: sde
-- ------------------------------------------------------
-- Server version	5.5.46-0+deb7u1

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `data_table_rows`
--

DROP TABLE IF EXISTS `data_table_rows`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `data_table_rows` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `node_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `node_id` (`node_id`),
  CONSTRAINT `data_table_rows_ibfk_1` FOREIGN KEY (`node_id`) REFERENCES `node` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=287 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `data_table_rows`
--

LOCK TABLES `data_table_rows` WRITE;
/*!40000 ALTER TABLE `data_table_rows` DISABLE KEYS */;
INSERT INTO `data_table_rows` VALUES (1,1690),(2,1690),(246,2757),(247,2757),(248,2757),(249,2757),(250,2757),(251,2757),(252,2757),(253,2759),(254,2759),(255,2759),(256,2759),(269,2819),(270,2819),(271,2819),(272,2819),(273,2819),(274,2819),(275,2819),(276,2821),(277,2821),(278,2821),(279,2821),(280,2835),(281,2835),(282,2835),(283,2835),(284,2835),(285,2835),(286,2835);
/*!40000 ALTER TABLE `data_table_rows` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `data_table_values`
--

DROP TABLE IF EXISTS `data_table_values`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `data_table_values` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `data_table_id` int(11) DEFAULT NULL,
  `data_key` varchar(1000) DEFAULT NULL,
  `data_value` varchar(1000) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `data_table_id` (`data_table_id`),
  CONSTRAINT `data_table_values_ibfk_1` FOREIGN KEY (`data_table_id`) REFERENCES `data_table_rows` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=3469 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `data_table_values`
--

LOCK TABLES `data_table_values` WRITE;
/*!40000 ALTER TABLE `data_table_values` DISABLE KEYS */;
INSERT INTO `data_table_values` VALUES (2856,246,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(2857,246,'TestEmployee','86345795'),(2858,246,'TestRepeat','4'),(2859,246,'LogTimeZone','Etc/GMT+7'),(2860,246,'URL','http://10.255.210.10:8180/spl/focal/Login'),(2861,246,'AppUsername','selenium'),(2862,246,'InternalURL','http://10.255.210.10:8180/spl/focal/'),(2863,246,'DBPassword','v6_demo_qa'),(2864,246,'AppPassword','testing'),(2865,246,'CacheRepeat','1'),(2866,246,'CodeLine','V6'),(2867,246,'EnvName','V6 Demo QA (Oracle)'),(2868,246,'DBUsername','v6_demo_qa'),(2869,246,'LogReportId','R62004'),(2870,247,'DBConnection',''),(2871,247,'TestEmployee',''),(2872,247,'TestRepeat',''),(2873,247,'LogTimeZone',''),(2874,247,'URL',''),(2875,247,'AppUsername',''),(2876,247,'InternalURL',''),(2877,247,'DBPassword',''),(2878,247,'AppPassword',''),(2879,247,'CacheRepeat',''),(2880,247,'CodeLine',''),(2881,247,'EnvName',''),(2882,247,'DBUsername',''),(2883,247,'LogReportId',''),(2884,247,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(2885,247,'TestEmployee','14529157'),(2886,247,'TestRepeat','4'),(2887,247,'LogTimeZone','Etc/GMT+7'),(2888,247,'URL','http://10.255.210.10:8780/spl/focal/Login'),(2889,247,'AppUsername','Emily'),(2890,247,'InternalURL','http://10.255.210.10:8780/spl/focal/'),(2891,247,'DBPassword','v6_victrex_uat'),(2892,247,'AppPassword','Meyer01'),(2893,247,'CacheRepeat','1'),(2894,247,'CodeLine','V6'),(2895,247,'EnvName','Victrex UAT'),(2896,247,'DBUsername','v6_victrex_uat'),(2897,247,'LogReportId','R62004'),(2898,248,'DBConnection',''),(2899,248,'TestEmployee',''),(2900,248,'TestRepeat',''),(2901,248,'LogTimeZone',''),(2902,248,'URL',''),(2903,248,'AppUsername',''),(2904,248,'InternalURL',''),(2905,248,'DBPassword',''),(2906,248,'AppPassword',''),(2907,248,'CacheRepeat',''),(2908,248,'CodeLine',''),(2909,248,'EnvName',''),(2910,248,'DBUsername',''),(2911,248,'LogReportId',''),(2912,248,'DBConnection','jdbc:mysql://10.255.210.4:3306/v6_demo_qa'),(2913,248,'TestEmployee','86345795'),(2914,248,'TestRepeat','4'),(2915,248,'LogTimeZone','Etc/GMT+7'),(2916,248,'URL','http://10.255.210.12:8580/spl/focal/Login'),(2917,248,'AppUsername','selenium'),(2918,248,'InternalURL','http://10.255.210.12:8580/spl/focal/'),(2919,248,'DBPassword','v6_demo_qa'),(2920,248,'AppPassword','testing'),(2921,248,'CacheRepeat','1'),(2922,248,'CodeLine','V6'),(2923,248,'EnvName','V6 Demo QA (MySQL)'),(2924,248,'DBUsername','v6_demo_qa'),(2925,248,'LogReportId','R62004'),(2926,249,'DBConnection',''),(2927,249,'TestEmployee',''),(2928,249,'TestRepeat',''),(2929,249,'LogTimeZone',''),(2930,249,'URL',''),(2931,249,'AppUsername',''),(2932,249,'InternalURL',''),(2933,249,'DBPassword',''),(2934,249,'AppPassword',''),(2935,249,'CacheRepeat',''),(2936,249,'CodeLine',''),(2937,249,'EnvName',''),(2938,249,'DBUsername',''),(2939,249,'LogReportId',''),(2940,249,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(2941,249,'TestEmployee','9683095'),(2942,249,'TestRepeat','4'),(2943,249,'LogTimeZone','Etc/GMT+7'),(2944,249,'URL','http://10.255.210.10:8580/spl/focal/Login'),(2945,249,'AppUsername','selenium'),(2946,249,'InternalURL','http://10.255.210.10:8580/spl/focal/'),(2947,249,'DBPassword','netsuite_baseline'),(2948,249,'AppPassword','testing'),(2949,249,'CacheRepeat','1'),(2950,249,'CodeLine','V6'),(2951,249,'EnvName','Netsuite Baseline'),(2952,249,'DBUsername','netsuite_baseline'),(2953,249,'LogReportId','R62004'),(2954,250,'DBConnection',''),(2955,250,'TestEmployee',''),(2956,250,'TestRepeat',''),(2957,250,'LogTimeZone',''),(2958,250,'URL',''),(2959,250,'AppUsername',''),(2960,250,'InternalURL',''),(2961,250,'DBPassword',''),(2962,250,'AppPassword',''),(2963,250,'CacheRepeat',''),(2964,250,'CodeLine',''),(2965,250,'EnvName',''),(2966,250,'DBUsername',''),(2967,250,'LogReportId',''),(2968,250,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(2969,250,'TestEmployee','128283'),(2970,250,'TestRepeat','4'),(2971,250,'LogTimeZone','Etc/GMT+7'),(2972,250,'URL','http://10.255.210.12:8880/spl/focal/Login'),(2973,250,'AppUsername','selenium'),(2974,250,'InternalURL','http://10.255.210.12:8880/spl/focal/'),(2975,250,'DBPassword','v6_stores_ne_uat'),(2976,250,'AppPassword','testing'),(2977,250,'CacheRepeat','1'),(2978,250,'CodeLine','V6'),(2979,250,'EnvName','Sephora Stores NE UAT'),(2980,250,'DBUsername','v6_stores_ne_uat'),(2981,250,'LogReportId','R62004'),(2982,251,'DBConnection',''),(2983,251,'TestEmployee',''),(2984,251,'TestRepeat',''),(2985,251,'LogTimeZone',''),(2986,251,'URL',''),(2987,251,'AppUsername',''),(2988,251,'InternalURL',''),(2989,251,'DBPassword',''),(2990,251,'AppPassword',''),(2991,251,'CacheRepeat',''),(2992,251,'CodeLine',''),(2993,251,'EnvName',''),(2994,251,'DBUsername',''),(2995,251,'LogReportId',''),(2996,251,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(2997,251,'TestEmployee','86345795'),(2998,251,'TestRepeat','4'),(2999,251,'LogTimeZone','Etc/GMT+7'),(3000,251,'URL','http://10.255.210.10:8080/spl/focal/Login'),(3001,251,'AppUsername','selenium'),(3002,251,'InternalURL','http://10.255.210.10:8080/spl/focal/'),(3003,251,'DBPassword','v6_demo'),(3004,251,'AppPassword','testing'),(3005,251,'CacheRepeat','1'),(3006,251,'CodeLine','V6'),(3007,251,'EnvName','V6 Demo Oracle Sales'),(3008,251,'DBUsername','v6_demo'),(3009,251,'LogReportId','R62004'),(3010,252,'DBConnection',''),(3011,252,'TestEmployee',''),(3012,252,'TestRepeat',''),(3013,252,'LogTimeZone',''),(3014,252,'URL',''),(3015,252,'AppUsername',''),(3016,252,'InternalURL',''),(3017,252,'DBPassword',''),(3018,252,'AppPassword',''),(3019,252,'CacheRepeat',''),(3020,252,'CodeLine',''),(3021,252,'EnvName',''),(3022,252,'DBUsername',''),(3023,252,'LogReportId',''),(3024,252,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(3025,252,'TestEmployee','EMP310011'),(3026,252,'TestRepeat','4'),(3027,252,'LogTimeZone','Etc/GMT+7'),(3028,252,'URL','http://10.255.210.13:9080/login-qa/hsbc/Login'),(3029,252,'AppUsername','selenium'),(3030,252,'InternalURL','http://10.255.210.13:9080/focal-qa/hsbc/'),(3031,252,'DBPassword','hsbc_qa_large'),(3032,252,'AppPassword','testing'),(3033,252,'CacheRepeat','1'),(3034,252,'CodeLine','HSBC'),(3035,252,'EnvName','HSBC Websphere Blackfeather 9080'),(3036,252,'DBUsername','hsbc_qa_large'),(3037,252,'LogReportId','R70000'),(3038,253,'Address','alex@spl.com'),(3039,253,'Start','Y'),(3040,253,'Report','Y'),(3041,253,'Popup','Y'),(3042,253,'Worksheet','Y'),(3043,253,'Admin','Y'),(3044,253,'Zipped','Y'),(3045,254,'Address',''),(3046,254,'Start',''),(3047,254,'Report',''),(3048,254,'Popup',''),(3049,254,'Worksheet',''),(3050,254,'Admin',''),(3051,254,'Zipped',''),(3052,254,'Address','diana.mecum@spiralinks.com'),(3053,254,'Start','N'),(3054,254,'Report','N'),(3055,254,'Popup','N'),(3056,254,'Worksheet','N'),(3057,254,'Admin','N'),(3058,254,'Zipped','N'),(3059,255,'Address',''),(3060,255,'Start',''),(3061,255,'Report',''),(3062,255,'Popup',''),(3063,255,'Worksheet',''),(3064,255,'Admin',''),(3065,255,'Zipped',''),(3066,255,'Address','mark.bean@spiralinks.com'),(3067,255,'Start','N'),(3068,255,'Report','N'),(3069,255,'Popup','N'),(3070,255,'Worksheet','N'),(3071,255,'Admin','N'),(3072,255,'Zipped','N'),(3073,256,'Address',''),(3074,256,'Start',''),(3075,256,'Report',''),(3076,256,'Popup',''),(3077,256,'Worksheet',''),(3078,256,'Admin',''),(3079,256,'Zipped',''),(3080,256,'Address','rao.chenna@spiralinks.com'),(3081,256,'Start','N'),(3082,256,'Report','N'),(3083,256,'Popup','N'),(3084,256,'Worksheet','N'),(3085,256,'Admin','N'),(3086,256,'Zipped','N'),(3100,1,'Hello12','fsdf'),(3101,2,'Hello12','asfdsafd'),(3102,1,'My alex','asdf'),(3103,2,'My alex','d'),(3104,1,'Friend move','asdf'),(3105,2,'Friend move','asdf'),(3106,1,'Dave lol','ds'),(3107,2,'Dave lol','fdas'),(3110,1,'WORK','oh'),(3111,2,'WORK','man'),(3173,269,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(3174,269,'TestEmployee','86345795'),(3175,269,'TestRepeat','1'),(3176,269,'LogTimeZone','Etc/GMT+8'),(3177,269,'URL','http://10.255.210.10:8180/spl/focal/Login'),(3178,269,'AppUsername','selenium'),(3179,269,'InternalURL','http://10.255.210.10:8180/spl/focal/'),(3180,269,'DBPassword','v6_demo_qa'),(3181,269,'AppPassword','testing'),(3182,269,'CacheRepeat','0'),(3183,269,'CodeLine','V6'),(3184,269,'EnvName','V6 Demo QA (Oracle)'),(3185,269,'DBUsername','v6_demo_qa'),(3186,269,'LogReportId','R62004'),(3187,270,'DBConnection',''),(3188,270,'TestEmployee',''),(3189,270,'TestRepeat',''),(3190,270,'LogTimeZone',''),(3191,270,'URL',''),(3192,270,'AppUsername',''),(3193,270,'InternalURL',''),(3194,270,'DBPassword',''),(3195,270,'AppPassword',''),(3196,270,'CacheRepeat',''),(3197,270,'CodeLine',''),(3198,270,'EnvName',''),(3199,270,'DBUsername',''),(3200,270,'LogReportId',''),(3201,270,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(3202,270,'TestEmployee','14529157'),(3203,270,'TestRepeat','4'),(3204,270,'LogTimeZone','Etc/GMT+8'),(3205,270,'URL','http://10.255.210.10:8780/spl/focal/Login'),(3206,270,'AppUsername','Emily'),(3207,270,'InternalURL','http://10.255.210.10:8780/spl/focal/'),(3208,270,'DBPassword','v6_victrex_uat'),(3209,270,'AppPassword','Meyer01'),(3210,270,'CacheRepeat','1'),(3211,270,'CodeLine','V6'),(3212,270,'EnvName','Victrex UAT'),(3213,270,'DBUsername','v6_victrex_uat'),(3214,270,'LogReportId','R62004'),(3215,271,'DBConnection',''),(3216,271,'TestEmployee',''),(3217,271,'TestRepeat',''),(3218,271,'LogTimeZone',''),(3219,271,'URL',''),(3220,271,'AppUsername',''),(3221,271,'InternalURL',''),(3222,271,'DBPassword',''),(3223,271,'AppPassword',''),(3224,271,'CacheRepeat',''),(3225,271,'CodeLine',''),(3226,271,'EnvName',''),(3227,271,'DBUsername',''),(3228,271,'LogReportId',''),(3229,271,'DBConnection','jdbc:mysql://10.255.210.4:3306/v6_demo_qa'),(3230,271,'TestEmployee','86345795'),(3231,271,'TestRepeat','4'),(3232,271,'LogTimeZone','Etc/GMT+8'),(3233,271,'URL','http://10.255.210.12:8580/spl/focal/Login'),(3234,271,'AppUsername','selenium'),(3235,271,'InternalURL','http://10.255.210.12:8580/spl/focal/'),(3236,271,'DBPassword','v6_demo_qa'),(3237,271,'AppPassword','testing'),(3238,271,'CacheRepeat','1'),(3239,271,'CodeLine','V6'),(3240,271,'EnvName','V6 Demo QA (MySQL)'),(3241,271,'DBUsername','v6_demo_qa'),(3242,271,'LogReportId','R62004'),(3243,272,'DBConnection',''),(3244,272,'TestEmployee',''),(3245,272,'TestRepeat',''),(3246,272,'LogTimeZone',''),(3247,272,'URL',''),(3248,272,'AppUsername',''),(3249,272,'InternalURL',''),(3250,272,'DBPassword',''),(3251,272,'AppPassword',''),(3252,272,'CacheRepeat',''),(3253,272,'CodeLine',''),(3254,272,'EnvName',''),(3255,272,'DBUsername',''),(3256,272,'LogReportId',''),(3257,272,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(3258,272,'TestEmployee','9683095'),(3259,272,'TestRepeat','4'),(3260,272,'LogTimeZone','Etc/GMT+8'),(3261,272,'URL','http://10.255.210.10:8580/spl/focal/Login'),(3262,272,'AppUsername','selenium'),(3263,272,'InternalURL','http://10.255.210.10:8580/spl/focal/'),(3264,272,'DBPassword','netsuite_baseline'),(3265,272,'AppPassword','testing'),(3266,272,'CacheRepeat','1'),(3267,272,'CodeLine','V6'),(3268,272,'EnvName','Netsuite Baseline'),(3269,272,'DBUsername','netsuite_baseline'),(3270,272,'LogReportId','R62004'),(3271,273,'DBConnection',''),(3272,273,'TestEmployee',''),(3273,273,'TestRepeat',''),(3274,273,'LogTimeZone',''),(3275,273,'URL',''),(3276,273,'AppUsername',''),(3277,273,'InternalURL',''),(3278,273,'DBPassword',''),(3279,273,'AppPassword',''),(3280,273,'CacheRepeat',''),(3281,273,'CodeLine',''),(3282,273,'EnvName',''),(3283,273,'DBUsername',''),(3284,273,'LogReportId',''),(3285,273,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(3286,273,'TestEmployee','128283'),(3287,273,'TestRepeat','4'),(3288,273,'LogTimeZone','Etc/GMT+8'),(3289,273,'URL','http://10.255.210.12:8880/spl/focal/Login'),(3290,273,'AppUsername','selenium'),(3291,273,'InternalURL','http://10.255.210.12:8880/spl/focal/'),(3292,273,'DBPassword','v6_stores_ne_uat'),(3293,273,'AppPassword','testing'),(3294,273,'CacheRepeat','1'),(3295,273,'CodeLine','V6'),(3296,273,'EnvName','Sephora Stores NE UAT'),(3297,273,'DBUsername','v6_stores_ne_uat'),(3298,273,'LogReportId','R62004'),(3299,274,'DBConnection',''),(3300,274,'TestEmployee',''),(3301,274,'TestRepeat',''),(3302,274,'LogTimeZone',''),(3303,274,'URL',''),(3304,274,'AppUsername',''),(3305,274,'InternalURL',''),(3306,274,'DBPassword',''),(3307,274,'AppPassword',''),(3308,274,'CacheRepeat',''),(3309,274,'CodeLine',''),(3310,274,'EnvName',''),(3311,274,'DBUsername',''),(3312,274,'LogReportId',''),(3313,274,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(3314,274,'TestEmployee','86345795'),(3315,274,'TestRepeat','4'),(3316,274,'LogTimeZone','Etc/GMT+8'),(3317,274,'URL','http://10.255.210.10:8080/spl/focal/Login'),(3318,274,'AppUsername','selenium'),(3319,274,'InternalURL','http://10.255.210.10:8080/spl/focal/'),(3320,274,'DBPassword','v6_demo'),(3321,274,'AppPassword','testing'),(3322,274,'CacheRepeat','1'),(3323,274,'CodeLine','V6'),(3324,274,'EnvName','V6 Demo Oracle Sales'),(3325,274,'DBUsername','v6_demo'),(3326,274,'LogReportId','R62004'),(3327,275,'DBConnection',''),(3328,275,'TestEmployee',''),(3329,275,'TestRepeat',''),(3330,275,'LogTimeZone',''),(3331,275,'URL',''),(3332,275,'AppUsername',''),(3333,275,'InternalURL',''),(3334,275,'DBPassword',''),(3335,275,'AppPassword',''),(3336,275,'CacheRepeat',''),(3337,275,'CodeLine',''),(3338,275,'EnvName',''),(3339,275,'DBUsername',''),(3340,275,'LogReportId',''),(3341,275,'DBConnection','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL'),(3342,275,'TestEmployee','EMP310011'),(3343,275,'TestRepeat','4'),(3344,275,'LogTimeZone','Etc/GMT+8'),(3345,275,'URL','http://10.255.210.13:9080/login-qa/hsbc/Login'),(3346,275,'AppUsername','selenium'),(3347,275,'InternalURL','http://10.255.210.13:9080/focal-qa/hsbc/'),(3348,275,'DBPassword','hsbc_qa_large'),(3349,275,'AppPassword','testing'),(3350,275,'CacheRepeat','1'),(3351,275,'CodeLine','HSBC'),(3352,275,'EnvName','HSBC Websphere Blackfeather 9080'),(3353,275,'DBUsername','hsbc_qa_large'),(3354,275,'LogReportId','R70000'),(3355,276,'Address','alex@spl.com'),(3356,276,'Start','Y'),(3357,276,'Report','Y'),(3358,276,'Popup','Y'),(3359,276,'Worksheet','Y'),(3360,276,'Admin','Y'),(3361,276,'Zipped','Y'),(3362,277,'Address',''),(3363,277,'Start',''),(3364,277,'Report',''),(3365,277,'Popup',''),(3366,277,'Worksheet',''),(3367,277,'Admin',''),(3368,277,'Zipped',''),(3369,277,'Address','diana.mecum@spiralinks.com'),(3370,277,'Start','N'),(3371,277,'Report','N'),(3372,277,'Popup','N'),(3373,277,'Worksheet','N'),(3374,277,'Admin','N'),(3375,277,'Zipped','N'),(3376,278,'Address',''),(3377,278,'Start',''),(3378,278,'Report',''),(3379,278,'Popup',''),(3380,278,'Worksheet',''),(3381,278,'Admin',''),(3382,278,'Zipped',''),(3383,278,'Address','mark.bean@spiralinks.com'),(3384,278,'Start','N'),(3385,278,'Report','N'),(3386,278,'Popup','N'),(3387,278,'Worksheet','N'),(3388,278,'Admin','N'),(3389,278,'Zipped','N'),(3390,279,'Address',''),(3391,279,'Start',''),(3392,279,'Report',''),(3393,279,'Popup',''),(3394,279,'Worksheet',''),(3395,279,'Admin',''),(3396,279,'Zipped',''),(3397,279,'Address','rao.chenna@spiralinks.com'),(3398,279,'Start','N'),(3399,279,'Report','N'),(3400,279,'Popup','N'),(3401,279,'Worksheet','N'),(3402,279,'Admin','N'),(3403,279,'Zipped','N'),(3404,280,'Admin Pages','Y'),(3405,280,'Worksheet Popups','Y'),(3406,280,'Perf Worksheet Popups','Y'),(3407,280,'Reports','Y'),(3408,280,'EnvName','V6 Demo QA (Oracle)'),(3409,281,'Admin Pages',''),(3410,281,'Worksheet Popups',''),(3411,281,'Perf Worksheet Popups',''),(3412,281,'Reports',''),(3413,281,'EnvName',''),(3414,281,'Admin Pages','Y'),(3415,281,'Worksheet Popups','Y'),(3416,281,'Perf Worksheet Popups','Y'),(3417,281,'Reports','Y'),(3418,281,'EnvName','V6 Demo QA (MySQL)'),(3419,282,'Admin Pages',''),(3420,282,'Worksheet Popups',''),(3421,282,'Perf Worksheet Popups',''),(3422,282,'Reports',''),(3423,282,'EnvName',''),(3424,282,'Admin Pages','Y'),(3425,282,'Worksheet Popups','Y'),(3426,282,'Perf Worksheet Popups','Y'),(3427,282,'Reports','Y'),(3428,282,'EnvName','Victrex UAT'),(3429,283,'Admin Pages',''),(3430,283,'Worksheet Popups',''),(3431,283,'Perf Worksheet Popups',''),(3432,283,'Reports',''),(3433,283,'EnvName',''),(3434,283,'Admin Pages','Y'),(3435,283,'Worksheet Popups','Y'),(3436,283,'Perf Worksheet Popups','N'),(3437,283,'Reports','Y'),(3438,283,'EnvName','Netsuite Baseline'),(3439,284,'Admin Pages',''),(3440,284,'Worksheet Popups',''),(3441,284,'Perf Worksheet Popups',''),(3442,284,'Reports',''),(3443,284,'EnvName',''),(3444,284,'Admin Pages','Y'),(3445,284,'Worksheet Popups','Y'),(3446,284,'Perf Worksheet Popups','N'),(3447,284,'Reports','Y'),(3448,284,'EnvName','Sephora Stores NE UAT'),(3449,285,'Admin Pages',''),(3450,285,'Worksheet Popups',''),(3451,285,'Perf Worksheet Popups',''),(3452,285,'Reports',''),(3453,285,'EnvName',''),(3454,285,'Admin Pages','Y'),(3455,285,'Worksheet Popups','Y'),(3456,285,'Perf Worksheet Popups','Y'),(3457,285,'Reports','Y'),(3458,285,'EnvName','V6 Demo Oracle Sales'),(3459,286,'Admin Pages',''),(3460,286,'Worksheet Popups',''),(3461,286,'Perf Worksheet Popups',''),(3462,286,'Reports',''),(3463,286,'EnvName',''),(3464,286,'Admin Pages','Y'),(3465,286,'Worksheet Popups','Y'),(3466,286,'Perf Worksheet Popups','N'),(3467,286,'Reports','Y'),(3468,286,'EnvName','HSBC Websphere Blackfeather 9080');
/*!40000 ALTER TABLE `data_table_values` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `http_headers`
--

DROP TABLE IF EXISTS `http_headers`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `http_headers` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `request_id` int(11) DEFAULT NULL,
  `header_name` varchar(1000) DEFAULT NULL,
  `header_value` varchar(1000) DEFAULT NULL,
  `header_type` varchar(100) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `request_id` (`request_id`),
  CONSTRAINT `http_headers_ibfk_1` FOREIGN KEY (`request_id`) REFERENCES `recorded_requests` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=115009 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `http_headers`
--

LOCK TABLES `http_headers` WRITE;
/*!40000 ALTER TABLE `http_headers` DISABLE KEYS */;
/*!40000 ALTER TABLE `http_headers` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `http_proxies`
--

DROP TABLE IF EXISTS `http_proxies`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `http_proxies` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `request_count` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=30 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `http_proxies`
--

LOCK TABLES `http_proxies` WRITE;
/*!40000 ALTER TABLE `http_proxies` DISABLE KEYS */;
/*!40000 ALTER TABLE `http_proxies` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `input`
--

DROP TABLE IF EXISTS `input`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `input` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `node_id` int(11) DEFAULT NULL,
  `variable_name` varchar(100) DEFAULT NULL,
  `variable_value` varchar(100) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `node_id` (`node_id`),
  CONSTRAINT `input_ibfk_1` FOREIGN KEY (`node_id`) REFERENCES `node` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=448 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `input`
--

LOCK TABLES `input` WRITE;
/*!40000 ALTER TABLE `input` DISABLE KEYS */;
INSERT INTO `input` VALUES (425,2707,'((username))','selenium'),(426,2707,'((password))','testing'),(427,2707,'[[url]]','http://10.255.210.13:9080/login-qa/hsbc/Login'),(428,2707,'[[cacheRepeat]]','0'),(429,2707,'[[testRepeat]]','1'),(430,2707,'[[testEmployee]]','EMP310011'),(431,2707,'[[internalurl]]','http://10.255.210.13:9080/focal-qa/hsbc/'),(432,2707,'[[logTimeZone]]','Etc/GMT+7'),(433,2707,'[[logReportId]]','R70000'),(434,2707,'[[admincode]]','123asfhiuuihuiasdviofhioufvhioasduhvuioshmfdvuiofhsdifhmsdfuiovsdhfiouhasdfiovuhasdfviouhasfiouahoa'),(435,2718,'EnvName','HSBC Websphere Blackfeather 9080'),(436,2762,'hello23','omg lol what is this?'),(437,2775,'((username))','selenium'),(438,2775,'((password))','testing'),(439,2775,'[[url]]','http://10.255.210.13:9080/login-qa/hsbc/Login'),(440,2775,'[[cacheRepeat]]','0'),(441,2775,'[[testRepeat]]','1'),(442,2775,'[[testEmployee]]','EMP310011'),(443,2775,'[[internalurl]]','http://10.255.210.13:9080/focal-qa/hsbc/'),(444,2775,'[[logTimeZone]]','Etc/GMT+7'),(445,2775,'[[logReportId]]','R70000'),(446,2775,'[[admincode]]','123asfhiuuihuiasdviofhioufvhioasduhvuioshmfdvuiofhsdifhmsdfuiovsdhfiouhasdfiovuhasdfviouhasfiouahoa'),(447,2786,'EnvName','HSBC Websphere Blackfeather 9080');
/*!40000 ALTER TABLE `input` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `node`
--

DROP TABLE IF EXISTS `node`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `node` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `program_id` int(11) DEFAULT NULL,
  `node_type` enum('ConsoleNode','LogicNode','SwitchNode','TestResultNode','LinuxNode','BashNode','InputNode','TimerNode','TriggerNode','WindowsNode','BatchNode','EmailNode','CopyNode','TestNode','RequestTrackerNode','DataBaseNode','ExportNode','CustomObjectNode','ChartNode','FileStoreNode','DataTableNode') DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `program_id` (`program_id`),
  CONSTRAINT `node_ibfk_1` FOREIGN KEY (`program_id`) REFERENCES `program` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=2838 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `node`
--

LOCK TABLES `node` WRITE;
/*!40000 ALTER TABLE `node` DISABLE KEYS */;
INSERT INTO `node` VALUES (1049,17,'TestNode'),(1202,17,'RequestTrackerNode'),(1203,17,'LogicNode'),(1211,17,'CustomObjectNode'),(1212,17,'ExportNode'),(1213,17,'LogicNode'),(1214,17,'LogicNode'),(1215,17,'ConsoleNode'),(1248,107,'TestNode'),(1249,107,'TestNode'),(1251,107,'TestNode'),(1252,107,'TestNode'),(1253,107,'TestNode'),(1262,107,'TestNode'),(1263,107,'TestNode'),(1264,107,'RequestTrackerNode'),(1265,107,'LogicNode'),(1306,107,'TestNode'),(1307,107,'TestNode'),(1309,107,'LogicNode'),(1312,107,'TestNode'),(1313,107,'TestNode'),(1314,107,'ExportNode'),(1315,107,'TestNode'),(1316,107,'TestNode'),(1317,107,'TestNode'),(1564,107,'FileStoreNode'),(1565,107,'LogicNode'),(1566,107,'LogicNode'),(1690,107,'DataTableNode'),(2073,141,'LogicNode'),(2074,141,'ExportNode'),(2077,141,'ExportNode'),(2078,141,'TimerNode'),(2079,141,'LogicNode'),(2195,141,'LogicNode'),(2420,141,'LogicNode'),(2705,107,'LogicNode'),(2706,153,'LogicNode'),(2707,153,'InputNode'),(2708,153,'RequestTrackerNode'),(2709,153,'DataBaseNode'),(2710,153,'LogicNode'),(2711,153,'ExportNode'),(2712,153,'CustomObjectNode'),(2713,153,'LogicNode'),(2714,153,'TestNode'),(2715,153,'LogicNode'),(2716,153,'CustomObjectNode'),(2717,153,'LogicNode'),(2718,153,'InputNode'),(2719,153,'LogicNode'),(2720,153,'TestNode'),(2721,153,'LogicNode'),(2722,153,'LogicNode'),(2723,153,'LogicNode'),(2724,153,'SwitchNode'),(2725,153,'CustomObjectNode'),(2726,153,'TimerNode'),(2727,153,'LogicNode'),(2728,153,'LogicNode'),(2729,153,'CustomObjectNode'),(2730,153,'LogicNode'),(2731,153,'TestNode'),(2732,153,'LogicNode'),(2733,153,'LogicNode'),(2734,153,'ConsoleNode'),(2735,153,'ExportNode'),(2736,153,'CustomObjectNode'),(2737,153,'LogicNode'),(2738,153,'LogicNode'),(2739,153,'TestNode'),(2740,153,'LogicNode'),(2741,153,'ExportNode'),(2742,153,'LogicNode'),(2743,153,'RequestTrackerNode'),(2744,153,'LogicNode'),(2745,153,'TestNode'),(2746,153,'LogicNode'),(2747,153,'LogicNode'),(2748,153,'TestNode'),(2749,153,'LogicNode'),(2750,153,'ExportNode'),(2751,153,'LogicNode'),(2752,153,'LogicNode'),(2753,153,'TestNode'),(2754,153,'LogicNode'),(2755,153,'ExportNode'),(2756,153,'LogicNode'),(2757,153,'DataTableNode'),(2758,153,'LogicNode'),(2759,153,'DataTableNode'),(2760,153,'ExportNode'),(2761,153,'CustomObjectNode'),(2762,107,'InputNode'),(2763,107,'ConsoleNode'),(2764,107,'TriggerNode'),(2774,154,'LogicNode'),(2775,154,'InputNode'),(2776,154,'RequestTrackerNode'),(2777,154,'DataBaseNode'),(2778,154,'LogicNode'),(2779,154,'ExportNode'),(2780,154,'CustomObjectNode'),(2781,154,'LogicNode'),(2782,154,'TestNode'),(2783,154,'LogicNode'),(2784,154,'CustomObjectNode'),(2785,154,'LogicNode'),(2786,154,'InputNode'),(2787,154,'LogicNode'),(2788,154,'TestNode'),(2789,154,'LogicNode'),(2790,154,'LogicNode'),(2791,154,'LogicNode'),(2792,154,'SwitchNode'),(2793,154,'CustomObjectNode'),(2794,154,'TimerNode'),(2795,154,'LogicNode'),(2796,154,'LogicNode'),(2797,154,'CustomObjectNode'),(2798,154,'LogicNode'),(2799,154,'TestNode'),(2800,154,'LogicNode'),(2801,154,'TestNode'),(2802,154,'LogicNode'),(2803,154,'ExportNode'),(2804,154,'LogicNode'),(2805,154,'RequestTrackerNode'),(2806,154,'LogicNode'),(2807,154,'TestNode'),(2808,154,'LogicNode'),(2809,154,'LogicNode'),(2810,154,'TestNode'),(2811,154,'LogicNode'),(2812,154,'ExportNode'),(2813,154,'LogicNode'),(2814,154,'LogicNode'),(2815,154,'TestNode'),(2816,154,'LogicNode'),(2817,154,'ExportNode'),(2818,154,'LogicNode'),(2819,154,'DataTableNode'),(2820,154,'LogicNode'),(2821,154,'DataTableNode'),(2822,154,'ExportNode'),(2823,154,'CustomObjectNode'),(2824,154,'ExportNode'),(2825,154,'ExportNode'),(2826,154,'ExportNode'),(2827,154,'LogicNode'),(2828,154,'TestNode'),(2829,154,'LogicNode'),(2830,154,'TestNode'),(2831,154,'LogicNode'),(2832,154,'ExportNode'),(2833,154,'ExportNode'),(2834,154,'LogicNode'),(2835,154,'DataTableNode'),(2836,107,'RequestTrackerNode'),(2837,107,'TestNode');
/*!40000 ALTER TABLE `node` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `node_colour`
--

DROP TABLE IF EXISTS `node_colour`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `node_colour` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `node_type` enum('ConsoleNode','LogicNode','SwitchNode','TestResultNode','LinuxNode','BashNode','InputNode','TimerNode','TriggerNode','WindowsNode','BatchNode','EmailNode','CopyNode','TestNode','RequestTrackerNode','DataBaseNode','ExportNode','CustomObjectNode','ChartNode','FileStoreNode','DataTableNode') DEFAULT NULL,
  `colour_r` int(11) DEFAULT NULL,
  `colour_g` int(11) DEFAULT NULL,
  `colour_b` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `node_colour`
--

LOCK TABLES `node_colour` WRITE;
/*!40000 ALTER TABLE `node_colour` DISABLE KEYS */;
INSERT INTO `node_colour` VALUES (1,'LogicNode',179,230,179),(2,'ConsoleNode',179,26,26),(3,'TimerNode',255,255,102),(4,'SwitchNode',255,179,102),(5,'BashNode',230,230,153),(6,'LinuxNode',179,153,255),(7,'TriggerNode',128,77,128),(8,'InputNode',255,204,179),(9,'CopyNode',179,230,230),(10,'WindowsNode',255,255,77),(11,'BatchNode',128,179,179),(12,'RequestTrackerNode',51,102,102),(13,'TestResultNode',230,230,179),(14,'TestNode',179,179,26),(15,'DataBaseNode',255,255,153),(16,'ExportNode',179,179,179),(17,'CustomObjectNode',77,102,204),(18,'DataTableNode',230,128,77),(19,'InputNode',128,51,77),(20,'InputNode',255,204,230);
/*!40000 ALTER TABLE `node_colour` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `node_details`
--

DROP TABLE IF EXISTS `node_details`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `node_details` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `node_id` int(11) DEFAULT NULL,
  `object_name` varchar(100) DEFAULT NULL,
  `object_value` blob,
  `object_class` enum('java.lang.Double','java.lang.Integer','java.lang.String') DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `node_id` (`node_id`),
  CONSTRAINT `node_details_ibfk_1` FOREIGN KEY (`node_id`) REFERENCES `node` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=18133 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `node_details`
--

LOCK TABLES `node_details` WRITE;
/*!40000 ALTER TABLE `node_details` DISABLE KEYS */;
INSERT INTO `node_details` VALUES (6950,1049,'Test','// Logging in\ntrack>trackerNode::Worksheet Tracker\nurl>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::a\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Go to the worksheet\nframe>select::default\nwait>presence::id::Worksheet\nclick>id::Worksheet\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\n\n// Looping through worksheet rows and columns\nloop>start::row>list::tag::td>xPath:://*[@id=\"row0\"]\n    // These are for inputs which open popups\n    loop>start::cell>list::tag::input>loop::row\n        call>function::testPopup\n    loop>end::cell\n\n    // This is for a tags which open popups\n    loop>start::cell>list::tag::a>loop::row\n        call>function::testPopup\n    loop>end::cell\nloop>end::row\n\nfunction>start::testPopup\n    if>start::ifReference>loop::cell>attribute::onclick>contains::_actionCallbackINPUT\n        click>loop::cell\n        // Waiting for the popup to open\n        wait>specificTime::2000\n        \n        // Loop through all popups and if they are open close them\n        frame>select::default\n        loop>start::popup>list::tag::div>xPath:://*[@id=\"indexLaptop\"]>direct::true\n            if>start::classCheck>loop::popup>class::true>contains::ui-dialog\n                if>start::visible>loop::popup>attribute::style>contains::block\n                    // Check to see if the popup loaded correctly or is a 1002 error\n                    set>var::firstVar>value::string::No popup name found\n                    set>var::errorVar>value::string::No error\n                    loop>start::findPopupTitle>list::tag::span>loop::popup\n                        if>start::errorCheck>loop::findPopupTitle>class::true>contains::ui-dialog-title\n                            set>var::firstVar>value::loop::findPopupTitle>content::true\n                        if>end::errorCheck\n                    loop>end::findPopupTitle\n                    \n                    set>var::errorDone>value::string::no error\n                    loop>start::errorCheckLoop>list::tag::span>loop::popup\n                        if>start::errorCheck>loop::errorCheckLoop>content::true>contains::1002\n                            set>var::errorDone>value::string::error\n                            set>var::errorVar>value::string::1002 Error seen\n                            run>node::Popup Track>popupTitle::var::firstVar>hasError::var::errorVar\n                        if>end::errorCheck\n                    loop>end::errorCheckLoop\n                    \n                    // If there is no error report that\n                    if>start::errorCheck>var::errorDone>equals::no error\n                        run>node::Popup Track>popupTitle::var::firstVar>hasError::var::errorVar\n                    if>end::errorCheck\n                    \n                    // Close the popup here\n                    loop>start::spanPress>list::tag::span>loop::popup\n                        if>start::buttonCheck>loop::spanPress>class::true>contains::ui-icon-closethick\n                            click>loop::spanPress\n                        if>end::buttonCheck\n                    loop>end::spanPress\n                if>end::visible\n            if>end::classCheck\n        loop>end::popup\n        wait>frameLoaded::frame::content\n        frame>id::content\n    if>end::ifReference\nfunction>end::testPopup\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nexit>','java.lang.String'),(6951,1049,'X','311.0','java.lang.Double'),(6952,1049,'Id','1049','java.lang.Integer'),(6953,1049,'Y','521.0','java.lang.Double'),(6954,1049,'ContainedText','Worksheet','java.lang.String'),(6955,1049,'NextNodeToRun','Generate Excel','java.lang.String'),(7885,1202,'X','413.0','java.lang.Double'),(7886,1202,'Id','1202','java.lang.Integer'),(7887,1202,'Y','453.0','java.lang.Double'),(7888,1202,'ContainedText','Worksheet Tracker','java.lang.String'),(7889,1202,'NextNodeToRun','','java.lang.String'),(7890,1203,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    CustomObjectNode popupResultsNode = (CustomObjectNode)getNode(\"Popup results\");\n    ConsoleNode console = (ConsoleNode)getNode(\"Console\");\n    \n    String popupTitle = (String)nodeRunParams.getParams().get(\"popupTitle\");\n    String hasError = (String)nodeRunParams.getParams().get(\"hasError\");\n    \n    log.info(popupTitle + \" \" + hasError);\n    \n    HashMap<String, String> popupResults = new HashMap();\n    \n    // Create data first time if it is available\n    if(popupResultsNode.getCustomObject(\"popupResults\") != null && popupResultsNode.getCustomObject(\"popupResults\").getPayload() != null) {\n        popupResults = (HashMap<String, String>)popupResultsNode.getCustomObject(\"popupResults\").getPayload();\n    }\n    \n    popupResults.put(popupTitle, hasError);\n    console.writeLineToConsole(\"Saved \" + popupTitle + \" -> \" + hasError);\n    popupResultsNode.addCustomObject(popupResults, \"popupResults\");\n}','java.lang.String'),(7891,1203,'X','425.0','java.lang.Double'),(7892,1203,'Id','1203','java.lang.Integer'),(7893,1203,'Y','583.0','java.lang.Double'),(7894,1203,'ContainedText','Popup Track','java.lang.String'),(7895,1203,'NextNodeToRun','','java.lang.String'),(7938,1211,'X','593.0','java.lang.Double'),(7939,1211,'Id','1211','java.lang.Integer'),(7940,1211,'Y','634.0','java.lang.Double'),(7941,1211,'ContainedText','Popup results','java.lang.String'),(7942,1211,'NextNodeToRun','','java.lang.String'),(7943,1212,'FileOutputDirectory','C:/Users/alex/Downloads','java.lang.String'),(7944,1212,'FileOutputName','Popups-[DATE]','java.lang.String'),(7945,1212,'X','592.0','java.lang.Double'),(7946,1212,'Id','1212','java.lang.Integer'),(7947,1212,'Y','485.0','java.lang.Double'),(7948,1212,'ContainedText','Popup Excel','java.lang.String'),(7949,1212,'NextNodeToRun','','java.lang.String'),(7950,1213,'Logic','public void function() {\n    CustomObjectNode popupResults = (CustomObjectNode)getNode(\"Popup results\");\n    popupResults.deleteCustomObject(\"popupResults\");\n    \n    run(\"Worksheet\");\n}','java.lang.String'),(7951,1213,'X','103.0','java.lang.Double'),(7952,1213,'Id','1213','java.lang.Integer'),(7953,1213,'Y','629.0','java.lang.Double'),(7954,1213,'ContainedText','Setup','java.lang.String'),(7955,1213,'NextNodeToRun','','java.lang.String'),(7956,1214,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    CustomObjectNode popupResultsNode = (CustomObjectNode)getNode(\"Popup results\");\n    ConsoleNode console = (ConsoleNode)getNode(\"Console\");\n   \n    HashMap<String, String> popupResults = new HashMap();\n   \n    // Create data first time if it is available\n    if(popupResultsNode.getCustomObject(\"popupResults\") != null && popupResultsNode.getCustomObject(\"popupResults\").getPayload() != null) {\n        popupResults = (HashMap<String, String>)popupResultsNode.getCustomObject(\"popupResults\").getPayload();\n    }\n    \n    console.writeLineToConsole(\"Generating Excel\");\n    \n    for(String title : popupResults.keySet()) {\n        console.writeLineToConsole(\"LOADED \" + title + \" -> \" + popupResults.get(title));\n    }\n    \n    Integer lineCount = 1;\n    if(popupResults != null) {\n        // Have to set max size of excel output manually..\n        Export export = new Export(200,100);\n        \n        // Header row\n        export.add(new ExportValue(\"Popup Name\",0,0));\n        export.add(new ExportValue(\"Error Report\",0,1));\n        \n        // Popup Error information added in\n        for(String title : popupResults.keySet()) {\n            export.add(new ExportValue(title,lineCount,0));\n            export.add(new ExportValue(popupResults.get(title),lineCount,1));\n            lineCount++;\n        }\n           \n        nodeRunParams.setOneTimeVariable(export);\n        runAndWait(\"Popup Excel\", nodeRunParams);   \n    } else {\n        log.info(\"No data to export!\");\n    }\n}','java.lang.String'),(7957,1214,'X','420.0','java.lang.Double'),(7958,1214,'Id','1214','java.lang.Integer'),(7959,1214,'Y','521.0','java.lang.Double'),(7960,1214,'ContainedText','Generate Excel','java.lang.String'),(7961,1214,'NextNodeToRun','','java.lang.String'),(7962,1215,'X','601.0','java.lang.Double'),(7963,1215,'Id','1215','java.lang.Integer'),(7964,1215,'Y','564.0','java.lang.Double'),(7965,1215,'ContainedText','Console','java.lang.String'),(7966,1215,'NextNodeToRun','','java.lang.String'),(8182,1248,'Test','url>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::a\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nframe>frameLoaded::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\nloop>start::ref>list::tag::a>element::xPath:://*[@id=\"hierarchySelectTable\"]\n    frame>select::default\n    wait>presence::id::content\n    frame>frameLoaded::content\n    frame>id::content\n    wait>presence::id::hierarchySelectIframe\n    frame>frameLoaded::hierarchySelectIframe\n    frame>id::hierarchySelectIframe\n    log>loop::ref\n    click>loop::ref\n    frame>select::default\n    frame>id::content\n    frame>frameLoaded::displaySummary\nloop>end::ref\nexit>','java.lang.String'),(8183,1248,'X','224.0','java.lang.Double'),(8184,1248,'Id','1248','java.lang.Integer'),(8185,1248,'Y','168.0','java.lang.Double'),(8186,1248,'ContainedText','Script','java.lang.String'),(8187,1248,'NextNodeToRun','','java.lang.String'),(8188,1249,'Test','// What?\nfunction>start::unused\n    log>message::not printed\nfunction>end::unused\n\nurl>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\nif>start::ifReference>id::j_username>attribute::id>exists::true\n    input>id::j_username>value::a\n    call>function::login\nif>end::ifReference\nexit>\nend>\n\nfunction>start::whatup\n    exit>\nfunction>end::whatup\n\nfunction>start::login\n    log>message::in login\n    wait>specificTime::1000\n    wait>specificTime::1000\n    call>function::whatup\nfunction>end::login\n\nlog>message::oops, shouldn\'t be here\nend>','java.lang.String'),(8189,1249,'X','343.0','java.lang.Double'),(8190,1249,'Id','1249','java.lang.Integer'),(8191,1249,'Y','166.0','java.lang.Double'),(8192,1249,'ContainedText','User input','java.lang.String'),(8193,1249,'NextNodeToRun','','java.lang.String'),(8200,1251,'Test','url>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\nloop>start::ref>list::tag::input>element::xPath:://*[@id=\"loginValidation\"]\n    if>start::ifReference>loop::ref>attribute::id>equals::j_username\n        input>loop::ref>value::This is the username>characterDelay::75\n    if>end::ifReference\n    if>start::ifReference>loop::ref>attribute::id>equals::j_password\n        input>loop::ref>value::This is the password>characterDelay::75\n    if>end::ifReference\nloop>end::ref\nexit>','java.lang.String'),(8201,1251,'X','76.0','java.lang.Double'),(8202,1251,'Id','1251','java.lang.Integer'),(8203,1251,'Y','174.0','java.lang.Double'),(8204,1251,'ContainedText','Login page if test','java.lang.String'),(8205,1251,'NextNodeToRun','','java.lang.String'),(8206,1252,'Test','// Logging in\nurl>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::a\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Expand all nodes first\nclick>id::expandAllSelect\nwait>specificTime::500\nframe>select::default\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Looping through Hierarchy, each visible a link\nloop>start::ref>list::tag::a>element::xPath:://*[@id=\"hierarchySelectTable\"]\n    frame>select::default\n    wait>presence::id::content\n    wait>frameLoaded::frame::content\n    frame>id::content\n    wait>presence::id::hierarchySelectIframe\n    wait>frameLoaded::frame::hierarchySelectIframe\n    frame>id::hierarchySelectIframe\n    if>start::ifReference>loop::ref>attribute::ondblclick>exists::true\n        //log>loop::ref\n        click>loop::ref\n    if>end::ifReference\n    frame>select::default\n    frame>id::content\n    wait>frameLoaded::frame::displaySummary\nloop>end::ref\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nexit>','java.lang.String'),(8207,1252,'X','130.0','java.lang.Double'),(8208,1252,'Id','1252','java.lang.Integer'),(8209,1252,'Y','267.0','java.lang.Double'),(8210,1252,'ContainedText','Hierarchy if test','java.lang.String'),(8211,1252,'NextNodeToRun','','java.lang.String'),(8212,1253,'Test','url>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\nframe>select::default\ninput>id::j_username>value::this is a message>characterDelay::300\nselect>id::selectOpt>select::Reports Menu6\nwait>specificTime::2000\nexit>\nend>','java.lang.String'),(8213,1253,'X','276.0','java.lang.Double'),(8214,1253,'Id','1253','java.lang.Integer'),(8215,1253,'Y','255.0','java.lang.Double'),(8216,1253,'ContainedText','Select Test','java.lang.String'),(8217,1253,'NextNodeToRun','','java.lang.String'),(8267,1262,'Test','log>message::starting\ncall>function::test\nlog>message::after call\n\nfunction>start::test\n    log>message::in function\n    call>function::test2\n    log>message::after 2nd call\nfunction>end::test\n\nfunction>start::test2\n    log>message::extra in function\nfunction>end::test2\n\nlog>message::at the end','java.lang.String'),(8268,1262,'X','484.0','java.lang.Double'),(8269,1262,'Id','1262','java.lang.Integer'),(8270,1262,'Y','251.0','java.lang.Double'),(8271,1262,'ContainedText','Functions','java.lang.String'),(8272,1262,'NextNodeToRun','','java.lang.String'),(8273,1263,'Test','track>trackerNode::TrackLog\n\n// Logging in\nurl>url::http://10.255.210.10:8180/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::a\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run the Log report\nframe>select::default\nwait>presence::id::mainmenu106\nclick>id::mainmenu106\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::R62004\nclick>id::R62004\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nexit>\nend>','java.lang.String'),(8274,1263,'X','353.0','java.lang.Double'),(8275,1263,'Id','1263','java.lang.Integer'),(8276,1263,'Y','419.0','java.lang.Double'),(8277,1263,'ContainedText','Run log report','java.lang.String'),(8278,1263,'NextNodeToRun','Read log','java.lang.String'),(8279,1264,'X','529.0','java.lang.Double'),(8280,1264,'Id','1264','java.lang.Integer'),(8281,1264,'Y','363.0','java.lang.Double'),(8282,1264,'ContainedText','TrackLog','java.lang.String'),(8283,1264,'NextNodeToRun','','java.lang.String'),(8284,1265,'Logic','public void function() {\n  \n}','java.lang.String'),(8285,1265,'X','567.0','java.lang.Double'),(8286,1265,'Id','1265','java.lang.Integer'),(8287,1265,'Y','453.0','java.lang.Double'),(8288,1265,'ContainedText','Read log','java.lang.String'),(8289,1265,'NextNodeToRun','','java.lang.String'),(8552,1306,'Test','track>trackerNode::TrackLog\n\n// Logging in\nurl>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::a\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run the Log report\nframe>select::default\nwait>presence::id::mainmenu106\nclick>id::mainmenu106\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\nloop>start::reports>list::tag::a>xPath:://*[@id=\"pageLeftLargeMenu\"]\n    click>loop::reports\n    wait>specificTime::500\n    wait>presence::id::reportPageIframe\n    wait>frameLoaded::frame::reportPageIframe\n    frame>id::reportPageIframe\n    wait>presence::id::runReportButton\n    click>id::runReportButton\n    wait>specificTime::500\n    wait>finishAllRequests::60000\n    frame>select::default\n    wait>presence::id::content\n    wait>frameLoaded::frame::content\n    frame>id::content\n    wait>presence::id::pageLeftLargeMenu\nloop>end::reports\n\n// Run the Log report\nframe>select::default\nwait>presence::id::mainmenu106\nclick>id::mainmenu106\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::R62004\nclick>id::R62004\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\nwait>finishAllRequests::60000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nexit>\nend>','java.lang.String'),(8553,1306,'X','370.0','java.lang.Double'),(8554,1306,'Id','1306','java.lang.Integer'),(8555,1306,'Y','485.0','java.lang.Double'),(8556,1306,'ContainedText','Run Reports','java.lang.String'),(8557,1306,'NextNodeToRun','Read log','java.lang.String'),(8558,1307,'Test','// Logging in\ntrack>trackerNode::TrackLog\nurl>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::a\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Go to the worksheet\nframe>select::default\nwait>presence::id::Worksheet\nclick>id::Worksheet\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\n\n// Looping through worksheet rows and columns\nloop>start::row>list::tag::td>xPath:://*[@id=\"row0\"]\n    // These are for inputs which open popups\n    loop>start::cell>list::tag::input>loop::row\n        call>function::testPopup\n    loop>end::cell\n\n    // This is for a tags which open popups\n    loop>start::cell>list::tag::a>loop::row\n        call>function::testPopup\n    loop>end::cell\nloop>end::row\n\nfunction>start::testPopup\n    if>start::ifReference>loop::cell>attribute::onclick>contains::_actionCallbackINPUT\n        click>loop::cell\n        // Waiting for the popup to open\n        wait>specificTime::2000\n        \n        // Loop through all popups and if they are open close them\n        frame>select::default\n        loop>start::popup>list::tag::div>xPath:://*[@id=\"indexLaptop\"]>direct::true\n            if>start::classCheck>loop::popup>class::true>contains::ui-dialog\n                if>start::visible>loop::popup>attribute::style>contains::block\n                    // Check to see if the popup loaded correctly or is a 1002 error\n                    set>var::firstVar>value::string::No popup name found\n                    set>var::errorVar>value::string::No error\n                    loop>start::findPopupTitle>list::tag::span>loop::popup\n                        if>start::errorCheck>loop::findPopupTitle>class::true>contains::ui-dialog-title\n                            set>var::firstVar>value::loop::findPopupTitle>content::true\n                        if>end::errorCheck\n                    loop>end::findPopupTitle\n                    \n                    set>var::errorDone>value::string::no error\n                    loop>start::errorCheckLoop>list::tag::span>loop::popup\n                        if>start::errorCheck>loop::errorCheckLoop>content::true>contains::1002\n                            set>var::errorDone>value::string::error\n                            set>var::errorVar>value::string::1002 Error seen\n                            run>node::Popup Track>popupTitle::var::firstVar>hasError::var::errorVar\n                        if>end::errorCheck\n                    loop>end::errorCheckLoop\n                    \n                    // If there is no error report that\n                    if>start::errorCheck>var::errorDone>equals::no error\n\n                    if>end::errorCheck\n                    \n                    // Close the popup here\n                    loop>start::spanPress>list::tag::span>loop::popup\n                        if>start::buttonCheck>loop::spanPress>class::true>contains::ui-icon-closethick\n                            click>loop::spanPress\n                        if>end::buttonCheck\n                    loop>end::spanPress\n                if>end::visible\n            if>end::classCheck\n        loop>end::popup\n        wait>frameLoaded::frame::content\n        frame>id::content\n    if>end::ifReference\nfunction>end::testPopup\n\n// Run the Log report\nframe>select::default\nwait>presence::id::mainmenu106\nclick>id::mainmenu106\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::R62004\nclick>id::R62004\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::1000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nexit>','java.lang.String'),(8559,1307,'X','352.0','java.lang.Double'),(8560,1307,'Id','1307','java.lang.Integer'),(8561,1307,'Y','548.0','java.lang.Double'),(8562,1307,'ContainedText','Worksheet Errors','java.lang.String'),(8563,1307,'NextNodeToRun','Read log','java.lang.String'),(8572,1309,'Logic','public void function() {\n   new EmailMessage()\n        .to(\"alex@spl.com\")\n        .from(\"alex@spl.com\")\n        .subject(\"SDE3 current log file\")\n        .content(\"this doesn\'t seem to show..\")\n        .attach(LogManager.getInstance().getLogOutputFilePath())\n        .host(\"mail.spl.com\")\n        .send();\n}','java.lang.String'),(8573,1309,'X','561.0','java.lang.Double'),(8574,1309,'Id','1309','java.lang.Integer'),(8575,1309,'Y','543.0','java.lang.Double'),(8576,1309,'ContainedText','Send Email','java.lang.String'),(8577,1309,'NextNodeToRun','','java.lang.String'),(8590,1312,'Test','track>trackerNode::Tracker1\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nframe>frameLoaded::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>select::default\nclick>xPath:://*[@id=\"mainmenu102\"]\nframe>select::default\nframe>id::axmorMenuContent\nwait>presence::xPath:://*[@id=\"expandallTree\"]\nclick>xPath:://*[@id=\"expandallTree\"]\n\nwait>specificTime::1000\n\nwait>presence::xPath:://*[@id=\"treeViewDiv\"]\nloop>start::adminMenus>list::tag::a>xPath:://*[@id=\"treeViewDiv\"]\n    click>loop::adminMenus\n    wait>specificTime::500\n    frame>select::default\n    wait>presence::id::content\n    frame>frameLoaded::content\n    frame>select::default\n    wait>presence::id::axmorMenuContent\n    frame>id::axmorMenuContent\nloop>end::adminMenus\n\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nexit>\nend>','java.lang.String'),(8591,1312,'X','-5.0','java.lang.Double'),(8592,1312,'Id','1312','java.lang.Integer'),(8593,1312,'Y','567.0','java.lang.Double'),(8594,1312,'ContainedText','New V6 Admin','java.lang.String'),(8595,1312,'NextNodeToRun','','java.lang.String'),(8596,1313,'Test','test>resultNode::Results>element::xPath:://*[@id=\"accordion1\"]/table/tbody/tr/td[3]/table/tbody/tr/td[1]>equals::Tanwar, (Aman) Aman\ntest>resultNode::Results>element::xPath:://*[@id=\"accordion1\"]/table/tbody/tr/td[3]/table/tbody/tr/td[1]>equals::Tanwar, (Aman)Aman','java.lang.String'),(8597,1313,'X','-21.0','java.lang.Double'),(8598,1313,'Id','1313','java.lang.Integer'),(8599,1313,'Y','494.0','java.lang.Double'),(8600,1313,'ContainedText','Tests, Example','java.lang.String'),(8601,1313,'NextNodeToRun','','java.lang.String'),(8602,1314,'FileOutputDirectory','C:/Users/alex/Downloads','java.lang.String'),(8603,1314,'FileOutputName','Report Test [DATE]','java.lang.String'),(8604,1314,'X','671.0','java.lang.Double'),(8605,1314,'Id','1314','java.lang.Integer'),(8606,1314,'Y','453.0','java.lang.Double'),(8607,1314,'ContainedText','Excel','java.lang.String'),(8608,1314,'NextNodeToRun','','java.lang.String'),(8609,1315,'Test','track>trackerNode::TrackLog\n\n// Logging in\nurl>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::a\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::50\nwait>finishAllRequests::30000\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nexit>\nend>','java.lang.String'),(8610,1315,'X','-123.0','java.lang.Double'),(8611,1315,'Id','1315','java.lang.Integer'),(8612,1315,'Y','443.0','java.lang.Double'),(8613,1315,'ContainedText','Wait for requests','java.lang.String'),(8614,1315,'NextNodeToRun','','java.lang.String'),(8615,1316,'Test','track>trackerNode::Track\n\n// Logging in\nurl>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::a\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::50\nwait>finishAllRequests::30000\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nexit>\nend>','java.lang.String'),(8616,1316,'X','-103.0','java.lang.Double'),(8617,1316,'Id','1316','java.lang.Integer'),(8618,1316,'Y','619.0','java.lang.Double'),(8619,1316,'ContainedText','Javascript test','java.lang.String'),(8620,1316,'NextNodeToRun','','java.lang.String'),(8621,1317,'Test','log>message::normal message\nlog>message::[[!this>causes>errors!]]','java.lang.String'),(8622,1317,'X','-184.0','java.lang.Double'),(8623,1317,'Id','1317','java.lang.Integer'),(8624,1317,'Y','548.0','java.lang.Double'),(8625,1317,'ContainedText','Escape Test','java.lang.String'),(8626,1317,'NextNodeToRun','','java.lang.String'),(10195,1564,'X','-300.0','java.lang.Double'),(10196,1564,'Id','1564','java.lang.Integer'),(10197,1564,'Y','239.0','java.lang.Double'),(10198,1564,'ContainedText','File Store','java.lang.String'),(10199,1564,'NextNodeToRun','','java.lang.String'),(10200,1565,'Logic','public void function() {\n   FileStoreNode fileStoreNode = (FileStoreNode)getNode(\"File Store\");\n   SDEFile sdeFile = DataBank.createNewSDEFile(fileStoreNode);\n   \n   java.io.File file = sdeFile.getFile();\n   if(file.exists()){\n       log.info(file);\n   }\n   log.info(\"Finished\");\n}','java.lang.String'),(10201,1565,'X','-440.0','java.lang.Double'),(10202,1565,'Id','1565','java.lang.Integer'),(10203,1565,'Y','203.0','java.lang.Double'),(10204,1565,'ContainedText','File test','java.lang.String'),(10205,1565,'NextNodeToRun','','java.lang.String'),(10206,1566,'Logic','public void function() {\n   FileStoreNode fileStoreNode = (FileStoreNode)getNode(\"File Store\");\n   \n   SDEFile sdeFile = fileStoreNode.getSDEFile(555);\n   log.info(sdeFile.getFile());\n}','java.lang.String'),(10207,1566,'X','-444.0','java.lang.Double'),(10208,1566,'Id','1566','java.lang.Integer'),(10209,1566,'Y','271.0','java.lang.Double'),(10210,1566,'ContainedText','Show file','java.lang.String'),(10211,1566,'NextNodeToRun','','java.lang.String'),(11010,1690,'X','-120.0','java.lang.Double'),(11011,1690,'Id','1690','java.lang.Integer'),(11012,1690,'Y','283.0','java.lang.Double'),(11013,1690,'ContainedText','Data Table','java.lang.String'),(11014,1690,'NextNodeToRun','','java.lang.String'),(13406,2073,'Logic','public void function() {\n    Export export = new Export(200,100);\n    \n    Random random = new Random();\n    \n    for(int i = 0; i < 100;i++){\n        export.add(new ExportValue(\"Menu\" + i,i,0));\n        export.add(new ExportValue(random.nextInt((100 - 0) + 1) + 0,i,1));\n    }\n    \n    export.sort(1,true,0);\n    \n    ExportNode exportNode = (ExportNode)getNode(\"Export\");\n    exportNode.setFileOutputDirectory(\"C:/Users/alex/Downloads/SDEOutputlol\");\n    \n    ExportNode exportNode2 = (ExportNode)getNode(\"Export2\");\n    exportNode2.setFileOutputDirectory(\"C:/Users/alex/Downloads/SDEOutputlol\");\n    \n    nodeRunParams.setOneTimeVariable(export);\n    runAndWait(\"Export\", nodeRunParams);\n    runAndWait(\"Export2\", nodeRunParams);\n}','java.lang.String'),(13407,2073,'X','293.0','java.lang.Double'),(13408,2073,'Id','2073','java.lang.Integer'),(13409,2073,'Y','276.0','java.lang.Double'),(13410,2073,'ContainedText','New LogicNode','java.lang.String'),(13411,2073,'NextNodeToRun','Timer','java.lang.String'),(13412,2074,'FileOutputDirectory','C:/Users/alex/Downloads/SDEOutput','java.lang.String'),(13413,2074,'FileOutputName','Output','java.lang.String'),(13414,2074,'X','479.0','java.lang.Double'),(13415,2074,'Id','2074','java.lang.Integer'),(13416,2074,'Y','224.0','java.lang.Double'),(13417,2074,'ContainedText','Export','java.lang.String'),(13418,2074,'NextNodeToRun','','java.lang.String'),(13430,2077,'FileOutputDirectory','C:/Users/alex/Downloads/SDEOutput','java.lang.String'),(13431,2077,'FileOutputName','Output2','java.lang.String'),(13432,2077,'X','478.0','java.lang.Double'),(13433,2077,'Id','2077','java.lang.Integer'),(13434,2077,'Y','277.0','java.lang.Double'),(13435,2077,'ContainedText','Export2','java.lang.String'),(13436,2077,'NextNodeToRun','','java.lang.String'),(13437,2078,'MilliSecsWait','3000','java.lang.Integer'),(13438,2078,'FrequencyDurationCount','','java.lang.String'),(13439,2078,'FrequencyDuration','','java.lang.String'),(13440,2078,'Frequency','Once','java.lang.String'),(13441,2078,'Repetition','','java.lang.String'),(13442,2078,'StartDateYear','0','java.lang.Integer'),(13443,2078,'StartDateMonth','0','java.lang.Integer'),(13444,2078,'StartDateDay','0','java.lang.Integer'),(13445,2078,'StartTime','','java.lang.String'),(13446,2078,'EndDateYear','0','java.lang.Integer'),(13447,2078,'EndDateMonth','0','java.lang.Integer'),(13448,2078,'EndDateDay','0','java.lang.Integer'),(13449,2078,'EndTime','','java.lang.String'),(13450,2078,'RepetitionCount','','java.lang.String'),(13451,2078,'StartChoice','Instantly','java.lang.String'),(13452,2078,'X','480.0','java.lang.Double'),(13453,2078,'Id','2078','java.lang.Integer'),(13454,2078,'Y','336.0','java.lang.Double'),(13455,2078,'ContainedText','Timer','java.lang.String'),(13456,2078,'NextNodeToRun','Zip','java.lang.String'),(13457,2079,'Logic','public void function() {\n   log.info(\"ZIPPING!\");\n   ExportNode export = (ExportNode)getNode(\"Export\");\n   ExportNode export2 = (ExportNode)getNode(\"Export2\");\n   \n   java.io.File export1File = new java.io.File(export.getConstructedFileName());\n   java.io.File export2File = new java.io.File(export2.getConstructedFileName());\n   \n   log.info(export.getConstructedFileName());\n   log.info(export2.getConstructedFileName());\n   \n   SDEUtils.zipDirectory(\"C:/Users/alex/Downloads/SDEOutputlol\",\"C:/Users/alex/Downloads/SDEZIPPED.zip\");\n}','java.lang.String'),(13458,2079,'X','599.0','java.lang.Double'),(13459,2079,'Id','2079','java.lang.Integer'),(13460,2079,'Y','275.0','java.lang.Double'),(13461,2079,'ContainedText','Zip','java.lang.String'),(13462,2079,'NextNodeToRun','','java.lang.String'),(14168,2195,'Logic','public void function() {\n    log.info(\"Start\");\n    try {\n        Thread.sleep(1000);\n    } catch (Exception ex) {\n        \n    }\n    log.info(\"End\");\n}','java.lang.String'),(14169,2195,'X','474.0','java.lang.Double'),(14170,2195,'Id','2195','java.lang.Integer'),(14171,2195,'Y','443.0','java.lang.Double'),(14172,2195,'ContainedText','New LogicNode','java.lang.String'),(14173,2195,'NextNodeToRun','a','java.lang.String'),(15550,2420,'Logic','public void function() {\n   log.info(\"a\");\n}','java.lang.String'),(15551,2420,'X','624.0','java.lang.Double'),(15552,2420,'Id','2420','java.lang.Integer'),(15553,2420,'Y','400.0','java.lang.Double'),(15554,2420,'ContainedText','a','java.lang.String'),(15555,2420,'NextNodeToRun','','java.lang.String'),(17317,2705,'Logic','public void function() {\n   SDEUtils.disconnectTest();\n}','java.lang.String'),(17318,2705,'X','-424.0','java.lang.Double'),(17319,2705,'Id','2705','java.lang.Integer'),(17320,2705,'Y','392.0','java.lang.Double'),(17321,2705,'ContainedText','New LogicNode','java.lang.String'),(17322,2705,'NextNodeToRun','','java.lang.String'),(17323,2706,'Logic','private String finalStr = \"\";\nprivate DataBaseNode dbNode;\n\npublic void function() {\n    // Get the nodes we need\n    \n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Login Test\");\n    \n    // Init DB and get the node\n    runAndWait(\"Oracle\");\n    dbNode = (DataBaseNode)getNode(\"Oracle\");\n    \n    // This gets the main root admin menu\n    String adminMenuId = findAdminMenuId(\"Admin\");\n\n    // This gets the import menu, we need to avoid this as while these are within the admin menu tree they are hard coded to not display, so we shouldn\'t be looking for them\n    String importMenuId = findAdminMenuId(\"ImportMenuMainPage\");\n    \n    // This gets the annual import menu, we need to do the same as the above import menu for this as well\n    String annualImportMenuId = findAdminMenuId(\"AnnualImport\");\n    String archiveMaintMenuId = findAdminMenuId(\"Archive Maint\");\n    \n    // Get all the menu references from the database\n    finalStr = \"\"; // Set to blank in case we have something left over from a previous test\n    createMenuReference(adminMenuId,\"\"); // The menu id here is the top level menu we want to test all the children of\n    //createMenuReference(archiveMaintMenuId,\"\"); // Fast test menu\n\n    finalStr = finalStr.substring(0,finalStr.length() - 1); // Remove the trailing comma\n    \n    String[] menuReferenceSplit = finalStr.split(\",\");\n    \n    log.info(annualImportMenuId);\n    \n    // Generate the script to run selenium looping through all the menu references we have created\n    String generatedCode = \"\";\n    for(String menuReference : menuReferenceSplit){\n        if(!menuReference.contains(\"<\"+importMenuId) && !menuReference.contains(\"<\"+annualImportMenuId)){ // If the menu reference makes use of the import menu we don\'t want, skip it\n           generatedCode += testAdminPage(menuReference); \n        } else {\n            log.info(\"Skipped \" + menuReference);\n        }\n    }\n    \n    log.info(generatedCode);\n    \n    // Apply the inputs and run the test\n    inputNode.setInputsByName(\"[[admincode]]\",generatedCode);\n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    // Tidy up our database connection\n    dbNode.getDbConnection().close();\n    \n    // Run the selenium test\n    runAndWait(\"Login Test\", nodeRunParams);\n    // Run the logic to output excel file\n    nodeRunParams.setOneTimeVariable(finalStr);\n    log.info(\"About to hand over to export\");\n    runAndWait(\"V6 Create Export\", nodeRunParams);\n}\n\npublic String createMenuReference(String menuSeqId, String pathSoFar) {\n    String thisPath = \"\";\n    \n    // We add this menu onto the path we are already creating, but not the first time when the path is already blank\n    if(pathSoFar.equals(\"\")){\n        thisPath = menuSeqId;\n    } else {\n        thisPath = pathSoFar + \"<\" + menuSeqId;\n    }\n    \n    // Query to find the children menu items of the current menu\n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_seq_id from fr_menus where parent_menu_seq_id = \" + menuSeqId));\n\n    Boolean bottomMenu = true;\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        String menuReference = \"\";\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuReference = selectResultRow.getLong(\"menu_seq_id\").toString();\n        } else {\n            menuReference = selectResultRow.getBigDecimal(\"MENU_SEQ_ID\").toString();\n        }\n        \n        createMenuReference(menuReference,thisPath);\n        bottomMenu = false;\n    }\n    \n    // If we have reached the bottom of the menu chain it is time to record the path we used to get here\n    if(bottomMenu) {\n        // We don\'t want to include menus which have no html path set as these are not value menus\n        selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select html_path from fr_menus where menu_seq_id = \" + menuSeqId));\n        \n        Boolean hasPath = false;\n        for (SelectResultRow selectResultRow : selectResult.getResults()) {\n            hasPath = true;\n        }\n        \n        // If it has an html path we add it to the rest of the final string\n        if(hasPath) {\n           finalStr += pathSoFar + \"<\" + menuSeqId + \",\"; \n        } else {\n            log.info(\"Skipping \" + menuSeqId + \" as no path\");\n        }\n    }\n    \n    return thisPath;\n}\n\npublic String findAdminMenuId(String menuName){\n    String menuId = \"\";\n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_seq_id from fr_menus where menu_name = \'\" + menuName + \"\'\"));\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuId = selectResultRow.getLong(\"menu_seq_id\").toString();\n        } else {\n            menuId = selectResultRow.getBigDecimal(\"MENU_SEQ_ID\").toString();\n        }\n    }\n    \n    return menuId;\n}\n\npublic String testAdminPage(String menuReference) {\n    String[] splitMenu = menuReference.split(\"<\");\n    String returnString = \"\";\n    \n    returnString += \"frame>id::axmorMenuContent\" + \"\\r\\n\"; // Select the axmor menu frame\n    \n    for(int i = 0;i < splitMenu.length - 1;i++) {\n        returnString += \"wait>presence::xPath:://*[@id=\\\"\" + splitMenu[i] +\"\\\"]/ins\" + \"\\r\\n\";\n        returnString += \"click>xPath:://*[@id=\\\"\" + splitMenu[i] + \"\\\"]/ins\" + \"\\r\\n\";\n        returnString += \"wait>specificTime::500\" + \"\\r\\n\";\n    }\n\n    returnString += \"wait>presence::xPath:://*[@id=\\\"\" + splitMenu[splitMenu.length - 1] +\"\\\"]/a\" + \"\\r\\n\";\n    returnString += \"click>xPath:://*[@id=\\\"\" + splitMenu[splitMenu.length - 1] +\"\\\"]/a\" + \"\\r\\n\";\n    returnString += \"wait>specificTime::800\" + \"\\r\\n\";\n    returnString += \"frame>select::default\" + \"\\r\\n\"; // Return to the main window frame to clean up at the end\n    \n    returnString += \"frame>frameLoaded::content\" + \"\\r\\n\"; // Wait for the frame to be loaded\n    returnString += \"frame>id::axmorMenuContent\" + \"\\r\\n\"; // Select the axmor menu frame\n    \n    for(int i = splitMenu.length - 2;i > -1;i--) {\n        returnString += \"wait>presence::xPath:://*[@id=\\\"\" + splitMenu[i] +\"\\\"]/ins\" + \"\\r\\n\";\n        returnString += \"click>xPath:://*[@id=\\\"\" + splitMenu[i] + \"\\\"]/ins\" + \"\\r\\n\";\n        returnString += \"wait>specificTime::500\" + \"\\r\\n\";\n    }\n    \n    returnString += \"frame>select::default\" + \"\\r\\n\"; // Return to the main window frame to clean up at the end\n    \n    return returnString;\n}','java.lang.String'),(17324,2706,'X','1631.0','java.lang.Double'),(17325,2706,'Id','2706','java.lang.Integer'),(17326,2706,'Y','-25.0','java.lang.Double'),(17327,2706,'ContainedText','V6 Selenium','java.lang.String'),(17328,2706,'NextNodeToRun','','java.lang.String'),(17329,2707,'X','2310.0','java.lang.Double'),(17330,2707,'Id','2707','java.lang.Integer'),(17331,2707,'Y','384.0','java.lang.Double'),(17332,2707,'ContainedText','Login Input','java.lang.String'),(17333,2707,'NextNodeToRun','','java.lang.String'),(17334,2708,'X','2310.0','java.lang.Double'),(17335,2708,'Id','2708','java.lang.Integer'),(17336,2708,'Y','292.0','java.lang.Double'),(17337,2708,'ContainedText','Tracker1','java.lang.String'),(17338,2708,'NextNodeToRun','','java.lang.String'),(17339,2709,'ConnectionString','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL','java.lang.String'),(17340,2709,'Username','hsbc_qa_large','java.lang.String'),(17341,2709,'Password','hsbc_qa_large','java.lang.String'),(17342,2709,'X','2309.0','java.lang.Double'),(17343,2709,'Id','2709','java.lang.Integer'),(17344,2709,'Y','246.0','java.lang.Double'),(17345,2709,'ContainedText','Oracle','java.lang.String'),(17346,2709,'NextNodeToRun','','java.lang.String'),(17347,2710,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    log.info(\"Excel file is starting...\");\n    \n    // This is passed in from the Logic node previously\n    String finalStr = (String)nodeRunParams.getOneTimeVariable();\n    \n    if(finalStr != null) {\n        log.info(finalStr);\n    }\n    \n    RequestTrackerNode tracker = (RequestTrackerNode)getNode(\"Tracker1\");\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Saved Tests\");\n    \n    // Connects to the database and gets the node\n    runAndWait(\"Oracle\");\n    DataBaseNode dbNode = (DataBaseNode)getNode(\"Oracle\");\n    \n    // We split the string up using the commas\n    String[] menuReferenceSplit = finalStr.split(\",\");\n    Integer rowCounter = 1;\n    \n    // Little bit complicated hash map structure...\n    HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>> exportRequestData = new HashMap<>();\n    \n    // Try and load the old data if there is any\n    if(saveNode.getCustomObject(\"exportData\") != null && saveNode.getCustomObject(\"exportData\").getPayload() != null) {\n        exportRequestData = (HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>>)saveNode.getCustomObject(\"exportData\").getPayload();\n    }\n    \n    HashMap<HashMap<String, String>,LinkedHashMap<String, Object>> thisTestData = new HashMap<>();\n    \n    for(String menuReference : menuReferenceSplit) {\n        try {\n            String[] individualMenuSplit = menuReference.split(\"<\");\n            \n            SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_description, html_path from fr_menus where menu_seq_id = \" + individualMenuSplit[individualMenuSplit.length - 1]));\n        \n            String htmlPath = \"\";\n            String menuDescription = \"\";\n            for (SelectResultRow selectResultRow : selectResult.getResults()) {\n                if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n                    htmlPath = selectResultRow.getString(\"html_path\");\n                    menuDescription = selectResultRow.getString(\"menu_description\");\n                } else {\n                    htmlPath = selectResultRow.getString(\"HTML_PATH\");\n                    menuDescription = selectResultRow.getString(\"MENU_DESCRIPTION\");\n                }\n            }\n            \n            log.info(htmlPath + \" and \" + menuDescription);\n            \n            // Little bit risky but we are finding the second section of the htmlPath to get the page name\n            InputNode inputNode = (InputNode)getNode(\"Login Input\");\n            String url = inputNode.getInputByName(\"[[url]]\").getVariableValue();\n            String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n            if(htmlPath != null){ // If for some reason we cannot find this path we skip it, this can happen if the menu item has null in the database for html path\n                htmlPath = internalURL + htmlPath.split(\"\'\")[1];\n                \n                List<WebProxyRequest> requestList = tracker.getRequestsByURL(htmlPath);\n        \n                // Average out the request times\n                Integer count = 0;\n                Long totalTime = 0l;\n                for(WebProxyRequest webProxyRequest : requestList) {\n                    totalTime += webProxyRequest.getRequestDuration();\n                    count++;\n                }\n                \n                Double averageTime = 0d;\n                if(count != 0){\n                    averageTime = totalTime.doubleValue() / count;  \n                }\n                \n                LinkedHashMap<String, Object> rowDataHash = new LinkedHashMap<>();\n                rowDataHash.put(\"averageTime\", Math.round(averageTime));\n                rowDataHash.put(\"count\",count);\n                \n                HashMap<String, String> requestDataHash = new HashMap<>();\n                requestDataHash.put(\"menuDescription\",menuDescription);\n                System.out.println(\"HTML PATH IS \" + htmlPath);\n                requestDataHash.put(\"htmlPath\",htmlPath);\n                \n                // Arrange the data correctly\n                thisTestData.put(requestDataHash, rowDataHash);\n            \n                rowCounter++;\n            } \n        } catch (Exception ex) {\n            ex.printStackTrace();\n        }\n    }\n\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n\n    // Add the data for this test 1\n    exportRequestData.put(envName, thisTestData);\n    \n    saveNode.addCustomObject(exportRequestData ,\"exportData\");\n\n    // Clean up the database connection we used\n    dbNode.getDbConnection().close();\n    \n    log.info(\"Excel data is completed\");\n    \n    // Repeat the test\n    runAndWait(\"V6 Repeater\");\n}','java.lang.String'),(17348,2710,'X','1755.0','java.lang.Double'),(17349,2710,'Id','2710','java.lang.Integer'),(17350,2710,'Y','-25.0','java.lang.Double'),(17351,2710,'ContainedText','V6 Create Export','java.lang.String'),(17352,2710,'NextNodeToRun','','java.lang.String'),(17353,2711,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(17354,2711,'FileOutputName','HSBC Websphere Blackfeather 9080Admin Test-[DATE]','java.lang.String'),(17355,2711,'X','2430.0','java.lang.Double'),(17356,2711,'Id','2711','java.lang.Integer'),(17357,2711,'Y','14.0','java.lang.Double'),(17358,2711,'ContainedText','Export','java.lang.String'),(17359,2711,'NextNodeToRun','Email Export Result','java.lang.String'),(17360,2712,'X','2311.0','java.lang.Double'),(17361,2712,'Id','2712','java.lang.Integer'),(17362,2712,'Y','152.0','java.lang.Double'),(17363,2712,'ContainedText','Saved Tests','java.lang.String'),(17364,2712,'NextNodeToRun','','java.lang.String'),(17365,2713,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Saved Tests\");\n    CustomObject savedData = saveNode.getCustomObject(\"exportData\");\n    \n    // This keep track of what requests are part of what rows, so they can be added to with subsequent tests\n    HashMap<String, Integer> requestRows = new HashMap<>();\n    \n    if(savedData != null){\n        HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>> exportRequestData = (HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>>) savedData.getPayload(); \n        \n        if(exportRequestData != null) {\n            // Have to set max size of excel output manually..\n            Export export = new Export(200,100);\n            \n            // Header row\n            export.add(new ExportValue(\"Menu\",1,0));\n            export.add(new ExportValue(\"URL\",1,1));\n            export.add(new ExportValue(\"Revision\",0,1));\n            \n            Integer testCounter = 0;\n            // Loops through the test numbers\n            for(String testName : exportRequestData.keySet()) {\n                Integer rowCounter = 2;\n                // Loops through reach request and writes the data\n                for(HashMap<String,String> requestData : exportRequestData.get(testName).keySet()) {\n                    LinkedHashMap<String, Object> rowDataHash = exportRequestData.get(testName).get(requestData);\n                    \n                    Integer columnsPerTest = 3;\n                    \n                    // Look up the row number for the current request, if it isn\'t there, we add it\n                    Integer rowNumber = requestRows.get(requestData.get(\"menuDescription\"));\n                    if(rowNumber == null) {\n                        requestRows.put(requestData.get(\"menuDescription\"), rowCounter);\n                        rowNumber = rowCounter;\n                        rowCounter++;\n                        \n                        export.add(new ExportValue(requestData.get(\"menuDescription\"), rowNumber, 0));\n                        export.add(new ExportValue(requestData.get(\"htmlPath\"), rowNumber, 1));\n                    } \n                    \n                    export.add(new ExportValue(\"Request Count\",1,2+(testCounter*columnsPerTest)));\n                    export.add(new ExportValue(\"Avg Duration (ms)\",1,3+(testCounter*columnsPerTest)));\n                    //export.add(new ExportValue(\"Change from previous test (ms)\",1,4+(testCounter*columnsPerTest)));\n                    \n                    // Adds revision number to header of test\n                    export.add(new ExportValue(testName,0,2+(testCounter*columnsPerTest)));\n                    \n                    export.add(new ExportValue(rowDataHash.get(\"averageTime\"), rowNumber, 3+(testCounter*columnsPerTest)));\n                    export.add(new ExportValue(rowDataHash.get(\"count\"), rowNumber, 2+(testCounter*columnsPerTest)));\n                    //export.add(new ExportFormula(\"OFFSET(INDIRECT(ADDRESS(ROW(),COLUMN())),0,-4)-OFFSET(INDIRECT(ADDRESS(ROW(),COLUMN())),0,-1)\", rowNumber, 4+(testCounter*columnsPerTest)));\n                }\n                testCounter++;\n            }\n           \n           \n            for (Integer row = 0; row < export.getRowCount(); row++) {\n                for (Integer col = 0; col < export.getColCount(); col++) {\n                    ExportCell exportCell = export.getValue(row, col);\n                    if (exportCell instanceof ExportValue) {\n                        ExportValue exportValue = (ExportValue) exportCell;\n                        log.info(row + \"/\" + col + \" - \" + exportValue.getDataValue());\n                    }\n                }\n            }\n           \n            InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n            ExportNode exportNode = (ExportNode)getNode(\"Export\");\n            exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Admin Test-[DATE]\");\n            export.sort(0,true,2);\n            nodeRunParams.setOneTimeVariable(export);\n\n            // Find the current output folder location\n            CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n            exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n            \n            runAndWait(\"Export\", nodeRunParams);\n            log.info(\"Excel written\");\n        } else {\n            log.info(\"No data to export!\");\n        }\n    } else {\n        log.info(\"No data to export!\");\n    }\n}\n\nprivate String getLetter(int i) {\n    return i > 0 && i < 27 ? String.valueOf((char)(i + 64)) : null;\n}','java.lang.String'),(17366,2713,'X','2313.0','java.lang.Double'),(17367,2713,'Id','2713','java.lang.Integer'),(17368,2713,'Y','14.0','java.lang.Double'),(17369,2713,'ContainedText','Write Excel','java.lang.String'),(17370,2713,'NextNodeToRun','','java.lang.String'),(17371,2714,'Test','track>trackerNode::Tracker1\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>select::default\nclick>xPath:://*[@id=\"mainmenu102\"]\nframe>select::default\nframe>id::axmorMenuContent\nwait>specificTime::1000\nwait>presence::xPath:://*[@id=\"expandallTree\"]\nclick>xPath:://*[@id=\"expandallTree\"]\n\nwait>frameLoaded::axmorMenuContent\nwait>specificTime::1000\n\nwait>presence::xPath:://*[@id=\"treeViewDiv\"]\nloop>start::adminMenus>list::tag::a>xPath:://*[@id=\"treeViewDiv\"]\n    click>loop::adminMenus\n    wait>specificTime::500\n    frame>select::default\n    wait>presence::id::content\n    wait>frameLoaded::content\n    frame>select::default\n    wait>presence::id::axmorMenuContent\n    frame>id::axmorMenuContent\nloop>end::adminMenus\n\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17372,2714,'X','2312.0','java.lang.Double'),(17373,2714,'Id','2714','java.lang.Integer'),(17374,2714,'Y','107.0','java.lang.Double'),(17375,2714,'ContainedText','Login Test','java.lang.String'),(17376,2714,'NextNodeToRun','','java.lang.String'),(17377,2715,'Logic','public void function() {\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Repeat count\");\n   \n    log.info(\"Starting to repeat..\");\n    \n    InputNode inputNode = (InputNode) getNode(\"Login Input\");\n    String cacheRepeat = inputNode.getInputByName(\"[[cacheRepeat]]\").getVariableValue();\n    String testRepeat = inputNode.getInputByName(\"[[testRepeat]]\").getVariableValue();\n    \n    Integer timesToClearCache = Integer.parseInt(cacheRepeat); // Keep in mind that before this point we have already run the selenium test once\n    Integer timesToRepeat = Integer.parseInt(testRepeat);\n    \n    // The first time we come to the repeater we start to keep track of the counter setting it to one\n    if(!(saveNode.getCustomObject(\"repeatCount\") != null && saveNode.getCustomObject(\"repeatCount\").getPayload() != null)) {\n        log.info(\"Starting counter at one!\");\n        saveNode.addCustomObject(1,\"repeatCount\");\n    }\n    \n    // Once the counter has been set we do the required action of repeat again, clear the tracker or write the excel file once finished\n    if(saveNode.getCustomObject(\"repeatCount\") != null && saveNode.getCustomObject(\"repeatCount\").getPayload() != null) {\n        Integer count = (Integer)saveNode.getCustomObject(\"repeatCount\").getPayload();\n        log.info(\"Counter is \" + count);\n        if (count < timesToClearCache) {\n            log.info(\"Repeating!!\");\n            run(\"V6 Selenium\");\n        }\n        \n        // This is the real test where timings will be collected\n        if(count >= timesToClearCache && count < timesToClearCache + timesToRepeat){\n            log.info(\"Running real test \" + (count - timesToClearCache));\n            run(\"V6 Selenium\");\n        }\n        \n        count++;\n        saveNode.addCustomObject(count,\"repeatCount\");\n        \n        if(count > timesToClearCache + timesToRepeat){ // At this point we are done with the tests for this environment\n            log.info(\"Repeater heading to write excel now\");\n            run(\"Write Excel\");\n            run(\"Admin Log Logic\");\n        }\n    } \n}','java.lang.String'),(17378,2715,'X','1904.0','java.lang.Double'),(17379,2715,'Id','2715','java.lang.Integer'),(17380,2715,'Y','-25.0','java.lang.Double'),(17381,2715,'ContainedText','V6 Repeater','java.lang.String'),(17382,2715,'NextNodeToRun','','java.lang.String'),(17383,2716,'X','2310.0','java.lang.Double'),(17384,2716,'Id','2716','java.lang.Integer'),(17385,2716,'Y','198.0','java.lang.Double'),(17386,2716,'ContainedText','Repeat count','java.lang.String'),(17387,2716,'NextNodeToRun','','java.lang.String'),(17388,2717,'Logic','public void function() {\n    CustomObjectNode repeatCount = (CustomObjectNode)getNode(\"Repeat count\");\n    repeatCount.deleteCustomObject(\"repeatCount\");\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Saved Tests\");\n    saveNode.deleteCustomObject(\"exportData\");\n    RequestTrackerNode requestNode = (RequestTrackerNode)getNode(\"Tracker1\");\n    requestNode.clearAllRequests();\n    log.info(\"Count, Export Data and Request Tracker reset\");\n}','java.lang.String'),(17389,2717,'X','1782.0','java.lang.Double'),(17390,2717,'Id','2717','java.lang.Integer'),(17391,2717,'Y','148.0','java.lang.Double'),(17392,2717,'ContainedText','Reset','java.lang.String'),(17393,2717,'NextNodeToRun','','java.lang.String'),(17394,2718,'X','2310.0','java.lang.Double'),(17395,2718,'Id','2718','java.lang.Integer'),(17396,2718,'Y','338.0','java.lang.Double'),(17397,2718,'ContainedText','Environment Name','java.lang.String'),(17398,2718,'NextNodeToRun','','java.lang.String'),(17399,2719,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    log.info(\"Excel file is starting...\");\n    \n    // This is passed in from the Logic node previously\n    String finalStr = (String)nodeRunParams.getOneTimeVariable();\n    \n    if(finalStr != null) {\n        log.info(finalStr);\n    }\n    \n    RequestTrackerNode tracker = (RequestTrackerNode)getNode(\"Tracker1\");\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Saved Tests\");\n    \n    // Connects to the database and gets the node\n    runAndWait(\"Oracle\");\n    DataBaseNode dbNode = (DataBaseNode)getNode(\"Oracle\");\n    \n    // We split the string up using the commas\n    String[] menuReferenceSplit = finalStr.split(\",\");\n    Integer rowCounter = 1;\n    \n    // Little bit complicated hash map structure...\n    HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>> exportRequestData = new HashMap<>();\n    \n    // Try and load the old data if there is any\n    if(saveNode.getCustomObject(\"exportData\") != null && saveNode.getCustomObject(\"exportData\").getPayload() != null) {\n        exportRequestData = (HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>>)saveNode.getCustomObject(\"exportData\").getPayload();\n    }\n    \n    HashMap<HashMap<String, String>,LinkedHashMap<String, Object>> thisTestData = new HashMap<>();\n    \n    for(String menuReference : menuReferenceSplit) {\n        try {\n            String[] individualMenuSplit = menuReference.split(\"<\");\n            \n            SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_name, menu_description, html_path from fr_menus where menu_seq_id = \" + individualMenuSplit[individualMenuSplit.length - 1]));\n        \n            String htmlPath = \"\";\n            String menuDescription = \"\";\n            for (SelectResultRow selectResultRow : selectResult.getResults()) {\n                if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n                    htmlPath = selectResultRow.getString(\"menu_name\");\n                    menuDescription = selectResultRow.getString(\"menu_description\");\n                } else {\n                    htmlPath = selectResultRow.getString(\"MENU_NAME\");\n                    menuDescription = selectResultRow.getString(\"MENU_DESCRIPTION\");\n                }\n            }\n            \n            log.info(htmlPath + \" and \" + menuDescription);\n            \n            // Little bit risky but we are finding the second section of the htmlPath to get the page name\n            InputNode inputNode = (InputNode)getNode(\"Login Input\");\n            String url = inputNode.getInputByName(\"[[url]]\").getVariableValue();\n            String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n            if(htmlPath != null){ // If for some reason we cannot find this path we skip it, this can happen if the menu item has null in the database for html path\n                \n                if (\"Allocations\".equals(htmlPath)) {\n                    htmlPath = \"AllocationSingle\";    \n                } else if (\"Market Data\".equals(htmlPath)) {\n                    htmlPath = \"adminMarketData\";       \n                } else if (\"SystemValues\".equals(htmlPath)) {\n                    htmlPath = \"CompFrequencies\";       \n                } else if (\"ImportLog\".equals(htmlPath)) {\n                    htmlPath = \"ImportsLog\";       \n                } else if (\"Dates\".equals(htmlPath)) {\n                    htmlPath = \"RoleDates\";       \n                } else if (\"PurgeMaintenance\".equals(htmlPath)) {\n                    htmlPath = \"PurgeMaint\";       \n                } else if (\"Deferral\".equals(htmlPath)) {\n                    htmlPath = \"deferralActDisp\";       \n                } else if (\"StatementsArchiveMaintenance\".equals(htmlPath)) {\n                    htmlPath = \"ArchiveMaint\";\n                } else if (\"AnnualArchiveMaintenance\".equals(htmlPath)) {\n                    htmlPath = \"AdvanceArchiveMaint\";    \n                } else if (\"CompFrequencies\".equals(htmlPath)) {\n                    htmlPath = \"CompFrequenciesView\";       \n                } else if (\"ReportsController\".equals(htmlPath)) {\n                    htmlPath = \"ReportController\";       \n                } else if (\"LookupValues\".equals(htmlPath)) {\n                    htmlPath = \"ShowLookupTypes\";       \n                } else if (\"HierarchyUsers\".equals(htmlPath)) {\n                    htmlPath = \"Users\";       \n                } else if (\"AwardTypes\".equals(htmlPath)) {\n                    htmlPath = \"BonusTypes\";       \n                } else if (\"ChargeProfile\".equals(htmlPath)) {\n                    htmlPath = \"AdminChargeProfile\";       \n                } else if (\"IncentivePlans\".equals(htmlPath)) {\n                    htmlPath = \"IncentivePlansView\";       \n                } else if (\"AwardTypesVestingRules\".equals(htmlPath)) {\n                    htmlPath = \"VestingPlanBonusTypes\";       \n                } else if (\"HierarchyDepartments\".equals(htmlPath)) {\n                    htmlPath = \"HierarchyBuilder\";       \n                }\n                \n                htmlPath = internalURL + htmlPath;\n\n                List<WebProxyRequest> requestList = tracker.getRequestsByURL(htmlPath);\n        \n                // Average out the request times\n                Integer count = 0;\n                Long totalTime = 0l;\n                for(WebProxyRequest webProxyRequest : requestList) {\n                    totalTime += webProxyRequest.getRequestDuration();\n                    count++;\n                }\n                \n                Double averageTime = 0d;\n                if(count != 0){\n                    averageTime = totalTime.doubleValue() / count;  \n                }\n                log.info(\"Average time for \" + htmlPath + \" is \" + averageTime);\n                \n                LinkedHashMap<String, Object> rowDataHash = new LinkedHashMap<>();\n                rowDataHash.put(\"averageTime\", Math.round(averageTime));\n                rowDataHash.put(\"count\",count);\n                \n                HashMap<String, String> requestDataHash = new HashMap<>();\n                requestDataHash.put(\"menuDescription\",menuDescription);\n                requestDataHash.put(\"htmlPath\",htmlPath);\n                \n                // Arrange the data correctly\n                thisTestData.put(requestDataHash, rowDataHash);\n            \n                rowCounter++;\n            } \n        } catch (Exception ex) {\n            log.error(\"Error in HSBC create report\",ex);\n        }\n    }\n\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n\n    // Add the data for this test 1\n    exportRequestData.put(envName, thisTestData);\n    \n    saveNode.addCustomObject(exportRequestData ,\"exportData\");\n\n    // Clean up the database connection we used\n    dbNode.getDbConnection().close();\n    \n    log.info(\"Excel data is completed\");\n    \n    // Repeat the test\n    runAndWait(\"HSBC Repeater\");\n}','java.lang.String'),(17400,2719,'X','1767.0','java.lang.Double'),(17401,2719,'Id','2719','java.lang.Integer'),(17402,2719,'Y','302.0','java.lang.Double'),(17403,2719,'ContainedText','HSBC Create Export','java.lang.String'),(17404,2719,'NextNodeToRun','','java.lang.String'),(17405,2720,'Test','track>trackerNode::Tracker1\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>select::default\nclick>id::mainmenu4\nwait>frameLoaded::content\n\n[[admincode]]\n\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nwait>finishAllRequests::60000\nexit>','java.lang.String'),(17406,2720,'X','2312.0','java.lang.Double'),(17407,2720,'Id','2720','java.lang.Integer'),(17408,2720,'Y','60.0','java.lang.Double'),(17409,2720,'ContainedText','HSBC Logic','java.lang.String'),(17410,2720,'NextNodeToRun','','java.lang.String'),(17411,2721,'Logic','private String finalStr = \"\";\nprivate DataBaseNode dbNode;\n\npublic void function() {\n    // Get the nodes we need\n    \n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"HSBC Logic\");\n    \n    // Init DB and get the node\n    runAndWait(\"Oracle\");\n    dbNode = (DataBaseNode)getNode(\"Oracle\");\n    \n    // This gets the main root admin menu\n    adminMenuId = findAdminMenuId(\"Admin\");\n\n    // This gets the import menu, we need to avoid this as while these are within the admin menu tree they are hard coded to not display, so we shouldn\'t be looking for them\n    //String importMenuId = findAdminMenuId(\"ImportMenuMainPage\");\n    \n    // This gets the annual import menu, we need to do the same as the above import menu for this as well\n    String annualImportMenuId = findAdminMenuId(\"AnnualImport\");\n    \n    String archiveMaintMenuId = findAdminMenuId(\"Archive Maint\");\n    \n    // Get all the menu references from the database\n    finalStr = \"\"; // Set to blank in case we have something left over from a previous test\n    createMenuReference(adminMenuId,\"\"); // The menu id here is the top level menu we want to test all the children of\n    //createMenuReference(archiveMaintMenuId,\"\"); // Fast test menu\n\n    finalStr = finalStr.substring(0,finalStr.length() - 1); // Remove the trailing comma\n    \n    String[] menuReferenceSplit = finalStr.split(\",\");\n    \n    log.info(annualImportMenuId);\n    log.info(\"FINAL \" + finalStr);\n    \n    // Generate the script to run selenium looping through all the menu references we have created\n    String generatedCode = \"\";\n    for(String menuReference : menuReferenceSplit){\n        log.info(\"Checking \" + menuReference);\n        if(!menuReference.contains(\"<\"+annualImportMenuId)){ // If the menu reference makes use of the import menu we don\'t want, skip it\n           generatedCode += testAdminPage(menuReference); \n        } else {\n            log.info(\"Skipped \" + menuReference);\n        }\n    }\n    \n    log.info(\"Generated code is \" + generatedCode);\n    \n    // Apply the inputs and run the test\n    inputNode.setInputsByName(\"[[admincode]]\",generatedCode);\n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    // Tidy up our database connection\n    dbNode.getDbConnection().close();\n    \n    // Run the selenium test\n    runAndWait(\"HSBC Logic\", nodeRunParams);\n    // Run the logic to output excel file\n    nodeRunParams.setOneTimeVariable(finalStr);\n    log.info(\"About to hand over to export\");\n    runAndWait(\"HSBC Create Export\", nodeRunParams);\n}\n\npublic String createMenuReference(String menuSeqId, String pathSoFar) {\n    String thisPath = \"\";\n    \n    // We add this menu onto the path we are already creating, but not the first time when the path is already blank\n    if(pathSoFar.equals(\"\")){\n        thisPath = menuSeqId;\n    } else {\n        thisPath = pathSoFar + \"<\" + menuSeqId;\n    }\n    \n    // Query to find the children menu items of the current menu\n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_seq_id from fr_menus where parent_menu_seq_id = \" + menuSeqId));\n\n    Boolean bottomMenu = true;\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        String menuReference = \"\";\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuReference = selectResultRow.getLong(\"menu_seq_id\").toString();\n        } else {\n            menuReference = selectResultRow.getBigDecimal(\"MENU_SEQ_ID\").toString();\n        }\n        \n        createMenuReference(menuReference,thisPath);\n        bottomMenu = false;\n    }\n    \n    // If we have reached the bottom of the menu chain it is time to record the path we used to get here\n    if(bottomMenu) {\n        // We don\'t want to include menus which have no html path set as these are not value menus\n        selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select html_path from fr_menus where menu_seq_id = \" + menuSeqId));\n        \n        Boolean hasPath = false;\n        for (SelectResultRow selectResultRow : selectResult.getResults()) {\n            hasPath = true;\n        }\n        \n        // If it has an html path we add it to the rest of the final string\n        if(hasPath) {\n           finalStr += pathSoFar + \"<\" + menuSeqId + \",\"; \n        } else {\n            log.info(\"Skipping \" + menuSeqId + \" as no path\");\n        }\n    }\n    \n    return thisPath;\n}\n\npublic String findAdminMenuId(String menuName){\n    String menuId = \"\";\n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_seq_id from fr_menus where menu_name = \'\" + menuName + \"\'\"));\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuId = selectResultRow.getLong(\"menu_seq_id\").toString();\n        } else {\n            menuId = selectResultRow.getBigDecimal(\"MENU_SEQ_ID\").toString();\n        }\n    }\n    \n    return menuId;\n}\n\npublic String findAdminMenuName(String menuId){\n    String menuName = \"\";\n    \n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_name from fr_menus where menu_seq_id = \" + menuId + \"\"));\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuName = selectResultRow.getString(\"menu_name\").toString();\n        } else {\n            menuName = selectResultRow.getString(\"MENU_NAME\").toString();\n        }\n    }\n    \n    return menuName;\n}\n\nprivate String adminMenuId = \"\";\nprivate String currentSecondLevelMenu = \"\";\npublic String testAdminPage(String menuReference) {\n    String[] splitMenu = menuReference.split(\"<\");\n    String returnString = \"\";\n    \n    Boolean secondLevelMenu = false;\n    if(splitMenu.length == 2){\n       secondLevelMenu = true; \n    }\n    \n    for(int i = 0;i < splitMenu.length - 1;i++) {\n        String menuName = findAdminMenuName(splitMenu[i]);\n        log.info(\"Looking at \" + menuReference + \" - \" + splitMenu[i] + \" - \" + menuName);\n        if(!splitMenu[i].equals(adminMenuId)){ // The admin menu will always be open so we don\'t ever need to add this\n            String menuNameSecond = findAdminMenuName(splitMenu[i]);\n            String menuNameThird = findAdminMenuName(splitMenu[i + 1]);\n            if(!splitMenu[i].equals(currentSecondLevelMenu)){ // This means we need to change the second level menu item onto the next thing\n                returnString += \"wait>presence::xPath:://*[@id=\\\"\" + menuNameSecond +\"\\\"]\" + \"\\r\\n\";\n                returnString += \"click>xPath:://*[@id=\\\"\" + menuNameSecond +\"\\\"]\" + \"\\r\\n\";\n                returnString += \"wait>specificTime::1500\" + \"\\r\\n\";\n                returnString += \"frame>frameLoaded::content\" + \"\\r\\n\"; // Wait for the frame to be loaded\n                currentSecondLevelMenu = splitMenu[i];\n            }\n            \n            returnString += \"wait>presence::xPath:://*[@id=\\\"\" + \"empSummaryBanner\" + \"\\\"]\" + \"\\r\\n\";\n            returnString += \"frame>frameLoaded::empSummaryBanner\" + \"\\r\\n\";\n            returnString += \"frame>id::empSummaryBanner\" + \"\\r\\n\";\n            returnString += \"wait>presence::xPath:://*[@id=\\\"\" + menuNameThird +\"\\\"]\" + \"\\r\\n\";\n            returnString += \"click>xPath:://*[@id=\\\"\" + menuNameThird +\"\\\"]\" + \"\\r\\n\";\n            returnString += \"wait>specificTime::1500\" + \"\\r\\n\";\n            returnString += \"frame>select::default\" + \"\\r\\n\";\n            returnString += \"frame>frameLoaded::content\" + \"\\r\\n\"; // Wait for the frame to be loaded\n        }\n        \n        // This is for if the menu has no children\n        if(secondLevelMenu){\n            String menuNameSecond = findAdminMenuName(splitMenu[i + 1]);\n            returnString += \"wait>presence::xPath:://*[@id=\\\"\" + menuNameSecond +\"\\\"]\" + \"\\r\\n\";\n            returnString += \"click>xPath:://*[@id=\\\"\" + menuNameSecond +\"\\\"]\" + \"\\r\\n\";\n            returnString += \"wait>specificTime::1500\" + \"\\r\\n\";\n            returnString += \"frame>frameLoaded::content\" + \"\\r\\n\"; // Wait for the frame to be loaded\n            currentSecondLevelMenu = splitMenu[i];\n        }\n    }\n    \n    return returnString;\n}','java.lang.String'),(17412,2721,'X','1636.0','java.lang.Double'),(17413,2721,'Id','2721','java.lang.Integer'),(17414,2721,'Y','301.0','java.lang.Double'),(17415,2721,'ContainedText','HSBC Selenium','java.lang.String'),(17416,2721,'NextNodeToRun','','java.lang.String'),(17417,2722,'Logic','public void function() {\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Repeat count\");\n   \n    log.info(\"Starting to repeat..\");\n   \n    InputNode inputNode = (InputNode) getNode(\"Login Input\");\n    String cacheRepeat = inputNode.getInputByName(\"[[cacheRepeat]]\").getVariableValue();\n    String testRepeat = inputNode.getInputByName(\"[[testRepeat]]\").getVariableValue();\n    \n    Integer timesToClearCache = Integer.parseInt(cacheRepeat); // Keep in mind that before this point we have already run the selenium test once\n    Integer timesToRepeat = Integer.parseInt(testRepeat);\n    \n    // The first time we come to the repeater we start to keep track of the counter setting it to one\n    if(!(saveNode.getCustomObject(\"repeatCount\") != null && saveNode.getCustomObject(\"repeatCount\").getPayload() != null)) {\n        log.info(\"Starting counter at one!\");\n        saveNode.addCustomObject(1,\"repeatCount\");\n    }\n    \n    // Once the counter has been set we do the required action of repeat again, clear the tracker or write the excel file once finished\n    if(saveNode.getCustomObject(\"repeatCount\") != null && saveNode.getCustomObject(\"repeatCount\").getPayload() != null) {\n        Integer count = (Integer)saveNode.getCustomObject(\"repeatCount\").getPayload();\n        log.info(\"Counter is \" + count);\n        if (count < timesToClearCache) {\n            log.info(\"Repeating!!\");\n            run(\"HSBC Selenium\");\n        } \n        \n        // This is the real test where timings will be collected\n        if(count >= timesToClearCache && count < timesToClearCache + timesToRepeat){\n            log.info(\"Running real test \" + (count - timesToClearCache));\n            run(\"HSBC Selenium\");\n        }\n        \n        count++;\n        saveNode.addCustomObject(count,\"repeatCount\");\n        \n        if(count > timesToClearCache + timesToRepeat){ // At this point we are done with the tests for this environment\n            log.info(\"Repeater heading to write excel now\");\n            run(\"Write Excel\");\n            run(\"Admin Log Logic\");\n        }\n    } \n}','java.lang.String'),(17418,2722,'X','1935.0','java.lang.Double'),(17419,2722,'Id','2722','java.lang.Integer'),(17420,2722,'Y','302.0','java.lang.Double'),(17421,2722,'ContainedText','HSBC Repeater','java.lang.String'),(17422,2722,'NextNodeToRun','','java.lang.String'),(17423,2723,'Logic','public void function() {\n    log.info(\"Running the test\");\n    \n    SwitchNode switchNode = (SwitchNode)getNode(\"Environment Select\");\n    List<Switch> aSwitches = switchNode.getSwitches();\n    \n    String envNames = \"\\r\\n\";\n    \n    for(Switch aSwitch : aSwitches){\n        if(aSwitch.isEnabled()){\n           envNames += \"\\r\\n \" + aSwitch.getTarget(); \n        }\n    }\n        \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Starting test\")\n        .content(\"Starting SDE test for: \" + envNames)\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Start\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n        \n    run(\"Setup Envs\");\n    run(\"Schedule\");\n}','java.lang.String'),(17424,2723,'X','435.0','java.lang.Double'),(17425,2723,'Id','2723','java.lang.Integer'),(17426,2723,'Y','90.0','java.lang.Double'),(17427,2723,'ContainedText','Start Here','java.lang.String'),(17428,2723,'NextNodeToRun','','java.lang.String'),(17429,2724,'X','987.0','java.lang.Double'),(17430,2724,'Id','2724','java.lang.Integer'),(17431,2724,'Y','8.0','java.lang.Double'),(17432,2724,'ContainedText','Environment Select','java.lang.String'),(17433,2724,'NextNodeToRun','','java.lang.String'),(17434,2725,'X','1129.0','java.lang.Double'),(17435,2725,'Id','2725','java.lang.Integer'),(17436,2725,'Y','170.0','java.lang.Double'),(17437,2725,'ContainedText','Envs to run','java.lang.String'),(17438,2725,'NextNodeToRun','','java.lang.String'),(17439,2726,'MilliSecsWait','2000','java.lang.Integer'),(17440,2726,'FrequencyDurationCount','','java.lang.String'),(17441,2726,'FrequencyDuration','','java.lang.String'),(17442,2726,'Frequency','Once','java.lang.String'),(17443,2726,'Repetition','','java.lang.String'),(17444,2726,'StartDateYear','0','java.lang.Integer'),(17445,2726,'StartDateMonth','0','java.lang.Integer'),(17446,2726,'StartDateDay','0','java.lang.Integer'),(17447,2726,'StartTime','','java.lang.String'),(17448,2726,'EndDateYear','0','java.lang.Integer'),(17449,2726,'EndDateMonth','0','java.lang.Integer'),(17450,2726,'EndDateDay','0','java.lang.Integer'),(17451,2726,'EndTime','','java.lang.String'),(17452,2726,'RepetitionCount','','java.lang.String'),(17453,2726,'StartChoice','Instantly','java.lang.String'),(17454,2726,'X','662.0','java.lang.Double'),(17455,2726,'Id','2726','java.lang.Integer'),(17456,2726,'Y','341.0','java.lang.Double'),(17457,2726,'ContainedText','Schedule','java.lang.String'),(17458,2726,'NextNodeToRun','Test Controller','java.lang.String'),(17459,2727,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    DataBaseNode databaseNode = (DataBaseNode)getNode(\"Oracle\");\n    InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    InputNode loginInput = (InputNode)getNode(\"Login Input\");\n    \n    CustomObjectNode envCounterNode = (CustomObjectNode)getNode(\"Env Counter\");\n    CustomObjectNode envsToRun = (CustomObjectNode)getNode(\"Envs to run\");\n    List<HashMap<String, String>> environments = (List<HashMap<String, String>>) envsToRun.getCustomObject(\"envs\").getPayload();\n    Integer envCounter = (Integer) envCounterNode.getCustomObject(\"envCounter\").getPayload();\n    \n    //log.info(\"Env Counter = \" + envCounter);\n    \n    // Each time the script loops around this if statement moves onto the next environment to test and starts again until we have tested all environments\n    if(envCounter < environments.size()){\n        HashMap<String, String> envInfo = environments.get(envCounter);\n        // log.info(\"INFORMATION\");\n        // for(String name : envInfo.keySet()){\n        //     log.info(name + \" -> \" + envInfo.get(name));\n        // }\n        \n        databaseNode.setUsername(envInfo.get(\"DBUsername\"));\n        databaseNode.setPassword(envInfo.get(\"DBPassword\"));\n        databaseNode.setConnectionString(envInfo.get(\"DBConnection\"));\n        environmentName.getInputByName(\"EnvName\").setVariableValue(envInfo.get(\"EnvName\"));\n        loginInput.getInputByName(\"[[url]]\").setVariableValue(envInfo.get(\"URL\"));\n        loginInput.getInputByName(\"[[internalurl]]\").setVariableValue(envInfo.get(\"InternalURL\"));\n        loginInput.getInputByName(\"[[cacheRepeat]]\").setVariableValue(envInfo.get(\"CacheRepeat\"));\n        loginInput.getInputByName(\"[[testRepeat]]\").setVariableValue(envInfo.get(\"TestRepeat\"));\n        loginInput.getInputByName(\"((username))\").setVariableValue(envInfo.get(\"AppUsername\"));\n        loginInput.getInputByName(\"((password))\").setVariableValue(envInfo.get(\"AppPassword\"));\n        loginInput.getInputByName(\"[[testEmployee]]\").setVariableValue(envInfo.get(\"TestEmployee\"));\n        loginInput.getInputByName(\"[[logTimeZone]]\").setVariableValue(envInfo.get(\"LogTimeZone\"));\n        loginInput.getInputByName(\"[[logReportId]]\").setVariableValue(envInfo.get(\"LogReportId\"));\n        \n        log.info(\"Running \" + envInfo.get(\"EnvName\"));\n        \n        runAndWait(\"Reset\");\n        if(\"V6\".equals(envInfo.get(\"CodeLine\"))) {\n            runAndWait(\"V6 Selenium\");\n        } else if(\"HSBC\".equals(envInfo.get(\"CodeLine\"))){\n            runAndWait(\"HSBC Selenium\");\n        }\n    } else {\n        CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n        log.info(\"Trying to zip \" + fileLocation.getCustomObject(\"outputFolder\").getPayload());\n        \n        SDEUtils.zipDirectory((String)fileLocation.getCustomObject(\"outputFolder\").getPayload(),(String)fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/../TestResults.zip\");\n        \n        DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n        List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n        \n        EmailMessage emailMessage = new EmailMessage()\n            .from(\"SDE@spl.com\")\n            .username(\"alex@spl.com\")\n            .password(\"4o%2!oqZ#On!tepv111!\")\n            .subject(\"SDE3 - All Results\")\n            .attach(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/../TestResults.zip\")\n            .content(\"Nothing goes here\")\n            .protocol(\"imaps\")\n            .host(\"mail.spl.com\")\n            .port(\"587\");\n        \n        for(DataTableRow dataTableRow : dataTableRowList){\n            HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n            \n            if(\"Y\".equals(dataTableRowData.get(\"Zipped\").getDataValue())){\n                emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n            }\n        }\n    \n        emailMessage.send();\n        \n        log.info(\"All test completed!\"); \n    }\n    \n    envCounter++;\n    envCounterNode.addCustomObject(envCounter,\"envCounter\");\n}','java.lang.String'),(17460,2727,'X','1361.0','java.lang.Double'),(17461,2727,'Id','2727','java.lang.Integer'),(17462,2727,'Y','339.0','java.lang.Double'),(17463,2727,'ContainedText','Test Controller','java.lang.String'),(17464,2727,'NextNodeToRun','','java.lang.String'),(17465,2728,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    // Clear our any old data first\n    CustomObjectNode envsToRun = (CustomObjectNode)getNode(\"Envs to run\");\n    CustomObjectNode envCounter = (CustomObjectNode)getNode(\"Env Counter\");\n    CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n    envsToRun.deleteCustomObject(\"envs\");\n    envCounter.deleteCustomObject(\"envCounter\");\n    fileLocation.deleteCustomObject(\"outputFolder\");\n   \n    // Create a new fresh list ready to be used\n    List<HashMap<String, String>> environments = new ArrayList();\n    envsToRun.addCustomObject(environments,\"envs\");\n    envCounter.addCustomObject(0,\"envCounter\");\n    \n    // Output folder\n    ExportNode defaultExportNode = (ExportNode)getNode(\"Output Directory\");\n    defaultExportNode.buildConstructedFileName();\n    String fileLocationStr = new String(defaultExportNode.getConstructedDirectory());\n    log.info(\"Output directory = \" + fileLocationStr);\n    fileLocation.addCustomObject(fileLocationStr,\"outputFolder\");\n    run(\"Process Env Info\");\n}','java.lang.String'),(17466,2728,'X','620.0','java.lang.Double'),(17467,2728,'Id','2728','java.lang.Integer'),(17468,2728,'Y','93.0','java.lang.Double'),(17469,2728,'ContainedText','Setup Envs','java.lang.String'),(17470,2728,'NextNodeToRun','','java.lang.String'),(17471,2729,'X','1131.0','java.lang.Double'),(17472,2729,'Id','2729','java.lang.Integer'),(17473,2729,'Y','229.0','java.lang.Double'),(17474,2729,'ContainedText','Env Counter','java.lang.String'),(17475,2729,'NextNodeToRun','','java.lang.String'),(17476,2730,'Logic','public void function() {\n    CustomObjectNode popupResults = (CustomObjectNode)getNode(\"Popup results\");\n    popupResults.deleteCustomObject(\"popupResults\");\n    \n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Worksheet\");\n    \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Worksheet\", nodeRunParams);\n}','java.lang.String'),(17477,2730,'X','2075.0','java.lang.Double'),(17478,2730,'Id','2730','java.lang.Integer'),(17479,2730,'Y','-307.0','java.lang.Double'),(17480,2730,'ContainedText','Popup Setup','java.lang.String'),(17481,2730,'NextNodeToRun','','java.lang.String'),(17482,2731,'Test','// Logging in\ntrack>trackerNode::Tracker1\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Search for employee id we are testing against and then go to worksheet via search results\nframe>select::default\nwait>presence::id::searchInput\ninput>id::searchInput>value::[[testEmployee]]>characterDelay::100\nwait>presence::id::GoImage\nclick>id::GoImage\nwait>specificTime::1000\nwait>presence::xPath:://*[@id=\"searchResultsDiv\"]\nloop>start::searchResult>list::tag::a>xPath:://*[@id=\"searchResultsDiv\"]\n    if>start::clickResult>loop::searchResult>attribute::id>contains::searchPopup\n        click>loop::searchResult\n    if>end::clickResult\n    if>start::clickResult>loop::searchResult>attribute::href>contains::ProcessWorksheetFunctions\n        click>loop::searchResult\n    if>end::clickResult\nloop>end::searchResult\nwait>specificTime::1000\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\n\n// Looping through worksheet rows and columns\nloop>start::row>list::tag::td>xPath:://*[@id=\"row0\"]\n    // These are for inputs which open popups\n    loop>start::cell>list::tag::input>loop::row\n        call>function::testPopup\n    loop>end::cell\n\n    // This is for a tags which open popups\n    loop>start::cell>list::tag::a>loop::row\n        call>function::testPopup\n    loop>end::cell\nloop>end::row\n\nfunction>start::testPopup\n    if>start::ifReference>loop::cell>attribute::onclick>contains::_actionCallbackINPUT\n        click>loop::cell\n        // Waiting for the popup to open\n        wait>specificTime::2000\n        \n        // Loop through all popups and if they are open close them\n        frame>select::default\n        loop>start::popup>list::tag::div>xPath:://*[@id=\"indexLaptop\"]>direct::true\n            if>start::classCheck>loop::popup>class::true>contains::ui-dialog\n                if>start::visible>loop::popup>attribute::style>contains::block\n                    // Check to see if the popup loaded correctly or is a 1002 error\n                    set>var::firstVar>value::string::No popup name found\n                    set>var::errorVar>value::string::No error\n                    loop>start::findPopupTitle>list::tag::span>loop::popup\n                        if>start::errorCheck>loop::findPopupTitle>class::true>contains::ui-dialog-title\n                            set>var::firstVar>value::loop::findPopupTitle>content::true\n                        if>end::errorCheck\n                    loop>end::findPopupTitle\n                    \n                    set>var::errorDone>value::string::no error\n                    loop>start::errorCheckLoop>list::tag::span>loop::popup\n                        if>start::errorCheck>loop::errorCheckLoop>content::true>contains::1002\n                            set>var::errorDone>value::string::error\n                            set>var::errorVar>value::string::1002 Error seen\n                            run>node::Popup Track>popupTitle::var::firstVar>hasError::var::errorVar\n                        if>end::errorCheck\n                    loop>end::errorCheckLoop\n                    \n                    // If there is no error report that\n                    if>start::errorCheck>var::errorDone>equals::no error\n                        run>node::Popup Track>popupTitle::var::firstVar>hasError::var::errorVar\n                    if>end::errorCheck\n                    \n                    // Close the popup here\n                    loop>start::spanPress>list::tag::span>loop::popup\n                        if>start::buttonCheck>loop::spanPress>class::true>contains::ui-icon-closethick\n                            click>loop::spanPress\n                        if>end::buttonCheck\n                    loop>end::spanPress\n                if>end::visible\n            if>end::classCheck\n        loop>end::popup\n        wait>frameLoaded::frame::content\n        frame>id::content\n    if>end::ifReference\nfunction>end::testPopup\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nwait>finishAllRequests::60000\nexit>','java.lang.String'),(17483,2731,'X','2349.0','java.lang.Double'),(17484,2731,'Id','2731','java.lang.Integer'),(17485,2731,'Y','-418.0','java.lang.Double'),(17486,2731,'ContainedText','Worksheet','java.lang.String'),(17487,2731,'NextNodeToRun','Generate Excel','java.lang.String'),(17488,2732,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    CustomObjectNode popupResultsNode = (CustomObjectNode)getNode(\"Popup results\");\n    ConsoleNode console = (ConsoleNode)getNode(\"Console\");\n   \n    InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    ExportNode exportNode = (ExportNode)getNode(\"Popup Excel\");\n    exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Worksheet Popups-[DATE]\");\n   \n    // Find the current output folder location\n    CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n    exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n   \n    HashMap<String, String> popupResults = new HashMap();\n\n    // Create data first time if it is available\n    if(popupResultsNode.getCustomObject(\"popupResults\") != null && popupResultsNode.getCustomObject(\"popupResults\").getPayload() != null) {\n        popupResults = (HashMap<String, String>)popupResultsNode.getCustomObject(\"popupResults\").getPayload();\n    }\n    \n    console.writeLineToConsole(\"Generating Excel\");\n    \n    for(String title : popupResults.keySet()) {\n        console.writeLineToConsole(\"LOADED \" + title + \" -> \" + popupResults.get(title));\n    }\n    \n    Integer lineCount = 1;\n    if(popupResults != null) {\n        // Have to set max size of excel output manually..\n        Export export = new Export(200,100);\n        \n        // Header row\n        export.add(new ExportValue(\"Popup Name\",0,0));\n        export.add(new ExportValue(\"Error Report\",0,1));\n        \n        // Popup Error information added in\n        for(String title : popupResults.keySet()) {\n            export.add(new ExportValue(title,lineCount,0));\n            export.add(new ExportValue(popupResults.get(title),lineCount,1));\n            lineCount++;\n        }\n        \n        export.sort(0,true,1);\n        nodeRunParams.setOneTimeVariable(export);\n        runAndWait(\"Popup Excel\", nodeRunParams);   \n    } else {\n        log.info(\"No data to export!\");\n    }\n    \n    log.info(\"Excel written\");\n    \n    runAndWait(\"Popup Log Logic\");\n}','java.lang.String'),(17489,2732,'X','2470.0','java.lang.Double'),(17490,2732,'Id','2732','java.lang.Integer'),(17491,2732,'Y','-418.0','java.lang.Double'),(17492,2732,'ContainedText','Generate Excel','java.lang.String'),(17493,2732,'NextNodeToRun','','java.lang.String'),(17494,2733,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    CustomObjectNode popupResultsNode = (CustomObjectNode)getNode(\"Popup results\");\n    ConsoleNode console = (ConsoleNode)getNode(\"Console\");\n    \n    String popupTitle = (String)nodeRunParams.getParams().get(\"popupTitle\");\n    String hasError = (String)nodeRunParams.getParams().get(\"hasError\");\n    \n    log.info(popupTitle + \" \" + hasError);\n    \n    HashMap<String, String> popupResults = new HashMap();\n    \n    // Create data first time if it is available\n    if(popupResultsNode.getCustomObject(\"popupResults\") != null && popupResultsNode.getCustomObject(\"popupResults\").getPayload() != null) {\n        popupResults = (HashMap<String, String>)popupResultsNode.getCustomObject(\"popupResults\").getPayload();\n    }\n    \n    popupResults.put(popupTitle, hasError);\n    console.writeLineToConsole(\"Saved \" + popupTitle + \" -> \" + hasError);\n    popupResultsNode.addCustomObject(popupResults, \"popupResults\");\n}','java.lang.String'),(17495,2733,'X','2475.0','java.lang.Double'),(17496,2733,'Id','2733','java.lang.Integer'),(17497,2733,'Y','-337.0','java.lang.Double'),(17498,2733,'ContainedText','Popup Track','java.lang.String'),(17499,2733,'NextNodeToRun','','java.lang.String'),(17500,2734,'X','2665.0','java.lang.Double'),(17501,2734,'Id','2734','java.lang.Integer'),(17502,2734,'Y','-354.0','java.lang.Double'),(17503,2734,'ContainedText','Console','java.lang.String'),(17504,2734,'NextNodeToRun','','java.lang.String'),(17505,2735,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(17506,2735,'FileOutputName','HSBC Websphere Blackfeather 9080-Worksheet Popups-[DATE]','java.lang.String'),(17507,2735,'X','2654.0','java.lang.Double'),(17508,2735,'Id','2735','java.lang.Integer'),(17509,2735,'Y','-418.0','java.lang.Double'),(17510,2735,'ContainedText','Popup Excel','java.lang.String'),(17511,2735,'NextNodeToRun','Email Popup Excel Result','java.lang.String'),(17512,2736,'X','2649.0','java.lang.Double'),(17513,2736,'Id','2736','java.lang.Integer'),(17514,2736,'Y','-289.0','java.lang.Double'),(17515,2736,'ContainedText','Popup results','java.lang.String'),(17516,2736,'NextNodeToRun','','java.lang.String'),(17517,2737,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Export\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Admin Menu Times - \" + envName)\n        .content(\"No content\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Admin\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(17518,2737,'X','2518.0','java.lang.Double'),(17519,2737,'Id','2737','java.lang.Integer'),(17520,2737,'Y','14.0','java.lang.Double'),(17521,2737,'ContainedText','Email Export Result','java.lang.String'),(17522,2737,'NextNodeToRun','','java.lang.String'),(17523,2738,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Popup Excel\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n\n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Worksheet Popups - \" + envName)\n        .content(\"No content\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Popup\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(17524,2738,'X','2777.0','java.lang.Double'),(17525,2738,'Id','2738','java.lang.Integer'),(17526,2738,'Y','-418.0','java.lang.Double'),(17527,2738,'ContainedText','Email Popup Excel Result','java.lang.String'),(17528,2738,'NextNodeToRun','','java.lang.String'),(17529,2739,'Test','track>trackerNode::TrackLog\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\nloop>start::reports>list::tag::a>xPath:://*[@id=\"pageLeftLargeMenu\"]\n    click>loop::reports\n    wait>specificTime::500\n    wait>presence::id::reportPageIframe\n    wait>frameLoaded::frame::reportPageIframe\n    frame>id::reportPageIframe\n    wait>presence::id::runReportButton\n    \n    if>start::multiEmployee>id::multiEmployeeId>elementExists::true\n        input>id::multiEmployeeId>value::[[testEmployee]]\n    if>end::multiEmployee\n    \n    // This is for HSBC Management Summary report\n    if>start::selectRegion>id::region>elementExists::true\n        select>id::region>select::Europe\n    if>end::selectRegion\n    \n    click>id::runReportButton\n    wait>specificTime::500\n    wait>finishAllRequests::60000\n    frame>select::default\n    wait>presence::id::content\n    wait>frameLoaded::frame::content\n    frame>id::content\n    wait>presence::id::pageLeftLargeMenu\nloop>end::reports\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17530,2739,'X','1871.0','java.lang.Double'),(17531,2739,'Id','2739','java.lang.Integer'),(17532,2739,'Y','-712.0','java.lang.Double'),(17533,2739,'ContainedText','Run Reports','java.lang.String'),(17534,2739,'NextNodeToRun','Report Log Logic','java.lang.String'),(17535,2740,'Logic','public void function() {\n   RequestTrackerNode trackerNode = (RequestTrackerNode)getNode(\"TrackLog\");\n   InputNode inputNode = (InputNode)getNode(\"Login Input\");\n   \n    ExportNode exportNode = (ExportNode)getNode(\"Excel\");\n    InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Report Test-[DATE]\");\n   \n    // Find the current output folder location\n    CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n    exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n   \n   String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n   \n   List<WebProxyRequest> logList = trackerNode.getRequestsByURL(internalURL + \"ReportController\");\n   \n   LinkedHashMap<LogMessage, WebProxyRequest> requestMapping = new LinkedHashMap<>();\n   LinkedHashMap<LogMessage, WebProxyRequest> errorMapping = new LinkedHashMap<>();\n   \n   log.info(\"Report Controllers = \" + logList.size());\n   log.info(\"Internal url is \" + internalURL);\n   for(WebProxyRequest webProxyRequest : logList){\n       if(webProxyRequest.getResponseContent().contains(\"LogFile:\")){\n            List<LogMessage> messageList = decodeLog(webProxyRequest.getResponseContent());\n            \n            WebProxyRequest matchedRequest = null;\n            WebProxyRequest matchedEnterRequest = null;\n            Integer timeDifference = Integer.MAX_VALUE;\n            Integer timeDifferenceEnterRequest = Integer.MAX_VALUE;\n            //log.info(\"Log messages = \" + messageList.size());\n            for(LogMessage message : messageList){\n                //log.info(message.getRawLog());\n                //log.info(\"Is page \" + message.isPageMessage() + \" isEnter \" + message.isEnter());\n                if(message.isPageMessage() && !message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    //log.info(\"We have a leave\");\n                    \n                    List<WebProxyRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifference = Integer.MAX_VALUE;\n                    \n                    //log.info(\"**** \" + messagePageURL);\n                    for(WebProxyRequest webProxyRequest2 : messagePage) {\n                        //log.info(\"Request thing is \" + webProxyRequest2.getRequestURL());\n                        if(message.getTime() != null && webProxyRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),webProxyRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            //log.info(\"Old \" + timeDifference + \" diff \" + secondsDifference);\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifference)){\n                                timeDifference = secondsDifference;\n                                matchedRequest = webProxyRequest2;\n                            }\n                        }\n                    }\n                    if(matchedRequest != null && Math.abs(timeDifference) < 30){\n                        //log.info(\"Added \" + message.getRawLog() + \" to \" + matchedRequest.getRequestURL());\n                        requestMapping.put(message, matchedRequest);\n                    }\n                } else if(message.isPageMessage() && message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    List<WebProxyRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifferenceEnterRequest = Integer.MAX_VALUE;\n                    \n                    //log.info(\"We have an enter here\");\n                    \n                    for(WebProxyRequest webProxyRequest2 : messagePage) {\n                        if(message.getTime() != null && webProxyRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),webProxyRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifferenceEnterRequest)){\n                                timeDifferenceEnterRequest = secondsDifference;\n                                matchedEnterRequest = webProxyRequest2;\n                            }\n                        }\n                    }\n                    //if(matchedEnterRequest != null && Math.abs(timeDifference) < 30){\n                        //requestMapping.put(message, matchedEnterRequest);\n                    //}\n                } else { // These are other random log bits\n                //log.info(\"Found error \" + matchedEnterRequest + \" --- \" + timeDifferenceEnterRequest + \" ---- \" + message.getRawLog());\n                    if (matchedEnterRequest != null && Math.abs(timeDifferenceEnterRequest) < 30) { // We match it up to the last page request, it probably belongs to that?  As far as we know.\n                        //log.info(\"Added error\");\n                        errorMapping.put(message, matchedEnterRequest);\n                    }\n                }\n            }\n        }\n    }\n    \n    // log.info(requestMapping.size() + \" mapped requests\");\n    // log.info(errorMapping.size() + \" errors mapped to requests\");\n    \n    // log.info(\"ERRORS\");\n    // for(LogMessage logMessage : errorMapping.keySet()){\n    //     log.info(\"Error \" + logMessage.getRawLog() + \" belongs to \" + errorMapping.get(logMessage).getRequestURL() + \" at \" + errorMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    // log.info(\"\");\n    // log.info(\"REQUESTS\");\n    // for(LogMessage logMessage : requestMapping.keySet()){\n    //     log.info(\"Request \" + logMessage.getRawLog() + \" belongs to \" + requestMapping.get(logMessage).getRequestURL() + \" at \" + requestMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    \n    reportErrors(requestMapping,errorMapping);\n    \n    runAndWait(\"Test Controller\");\n}\n\npublic void reportErrors(LinkedHashMap<LogMessage, WebProxyRequest> requestMapping, LinkedHashMap<LogMessage, WebProxyRequest> errorMapping) {\n    Integer excelSize = (requestMapping.size() + errorMapping.size()) * 2;\n    \n    log.info(\"Requests \" + requestMapping.size() + \" Error \" + errorMapping.size());\n    log.info(\"Excel size \" + excelSize);\n    \n    if(excelSize < 1){\n        excelSize = 10;\n    }\n    \n    Export export = new Export(excelSize,5);\n    \n    Integer lineCounter = 1;\n            \n    // Header row\n    export.add(new ExportValue(\"Request (\" + requestMapping.size() + \")\",0,0));\n    export.add(new ExportValue(\"Time\",0,1));\n    export.add(new ExportValue(\"User\",0,2));\n    export.add(new ExportValue(\"Duration\",0,3));\n    export.add(new ExportValue(\"Log Errors (\" + errorMapping.size() + \")\",0,4));\n    \n    // Requests\n    for(LogMessage logMessage : requestMapping.keySet()){\n        export.add(new ExportValue(logMessage.getPage(),lineCounter,0));\n        org.joda.time.format.DateTimeFormatter dtfOut = org.joda.time.format.DateTimeFormat.forPattern(\"HH:mm:ss MM/dd/yyyy\");\n        export.add(new ExportValue(dtfOut.print(logMessage.getTime()),lineCounter,1));\n        export.add(new ExportValue(logMessage.getUser(),lineCounter,2));\n        export.add(new ExportValue(logMessage.getDuration(),lineCounter,3));\n        \n        Boolean addedLine = false;\n        for(LogMessage errorLog : errorMapping.keySet()){\n            if(requestMapping.get(logMessage) == errorMapping.get(errorLog)){\n                export.add(new ExportValue(errorLog.getRawLog(),lineCounter,4));\n                lineCounter++;\n                addedLine = true;\n            }\n        }\n        \n        if(!addedLine){\n            lineCounter++;    \n        }\n    }\n    \n    nodeRunParams.setOneTimeVariable(export);\n    runAndWait(\"Excel\", nodeRunParams);\n}\n\npublic List<LogMessage> decodeLog(String logRequest) {\n    String lines[] = logRequest.split(\"\\\\r?\\\\n\");\n\n    org.joda.time.DateTime time = new org.joda.time.DateTime();\n    \n    List<LogMessage> logMessages = new ArrayList<>();\n    \n    for(int i = 0;i< lines.length;i++){\n        String line = lines[i];\n        \n        LogMessage logMessage = new LogMessage();\n        logMessage.setRawLog(line);\n        \n        if(line.contains(\"[monitor]\")) { // This is a page log message\n            HashMap<String, String> result = decodeLogLine(line);\n\n            logMessage.setUser(result.get(\"USER\"));\n            logMessage.setPage(result.get(\"PAGE\"));\n            logMessage.setDuration(result.get(\"DURATION\"));\n            logMessage.setIsEnter(result.get(\"ENTER\"));\n            logMessage.parseTime(result.get(\"TIME\"));\n            logMessage.setIsPageMessage(true);\n        } else { // This is anything else, could be an exception\n            logMessage.setIsPageMessage(false);\n        }\n        \n        logMessages.add(logMessage);\n    }\n    \n    return logMessages;\n}\n\npublic HashMap<String,String> decodeLogLine(String logLine) {\n    String sections[] = logLine.split(\",\");\n    \n    HashMap<String, String> parsedLine = new HashMap<>();\n    \n    //log.info(\"Length = \" + sections.length);\n    if(sections.length == 16 || sections.length == 26){ // All logs have 16 parts\n        String time = sections[0] + \",\" + sections[1].substring(0,3);\n        String enterLeave =  sections[1].substring(20,25);\n        String user = sections[7];\n        String page = sections[9];\n        String duration = sections[11];\n        \n        parsedLine.put(\"TIME\",time);\n        parsedLine.put(\"ENTER\",enterLeave);\n        parsedLine.put(\"PAGE\",page);\n        parsedLine.put(\"USER\",user);\n        parsedLine.put(\"DURATION\",duration);\n    }\n    \n    return parsedLine;\n}\n\nprivate class LogMessage {\n    private String rawLog = \"\";\n    private Boolean isPageMessage = false;\n    private Boolean isEnter = false;\n    private String page = \"\";\n    private String user = \"\";\n    private String duration = \"\";\n    private org.joda.time.DateTime time; \n    \n    public LogMessage() {\n    }\n    \n    public org.joda.time.DateTime getTime() {\n        return time;\n    }\n    \n    public void parseTime(String timeStr) {\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        \n        String timeZoneStr = inputNode.getInputByName(\"[[logTimeZone]]\").getVariableValue();\n        org.joda.time.DateTimeZone zone = null;\n        if(timeZoneStr != null){\n            zone = org.joda.time.DateTimeZone.forID(timeZoneStr);\n        }\n        \n        if(timeStr != null){\n            Integer year = Integer.parseInt(timeStr.substring(0,4));\n            Integer month = Integer.parseInt(timeStr.substring(5,7));\n            Integer day = Integer.parseInt(timeStr.substring(8,10));\n            Integer hour = Integer.parseInt(timeStr.substring(11,13));\n            Integer minute = Integer.parseInt(timeStr.substring(14,16));\n            Integer second = Integer.parseInt(timeStr.substring(17,19));\n            Integer millisecond = Integer.parseInt(timeStr.substring(20,23));\n        \n            if(zone != null){\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond,zone); \n            } else {\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond); \n            }\n        }\n    }\n    \n    public String getDuration() {\n        return duration;\n    }\n    \n    public void setDuration(String duration) {\n        this.duration = duration;\n    }\n    \n    public Boolean isEnter() {\n        return isEnter;\n    }\n    \n    public void setIsEnter(String isEnter){\n        this.isEnter = \"Enter\".equals(isEnter);\n    }\n    \n    public String getPage() {\n        return page;\n    }\n    \n    public void setPage(String page){\n        this.page = page;\n    }\n    \n    public String getUser() {\n        return user;\n    }\n    \n    public void setUser(String user){\n        this.user = user;\n    }\n    \n    public String getRawLog() {\n        return rawLog;\n    }\n    \n    public void setRawLog(String rawLog){\n        this.rawLog = rawLog;\n    }\n    \n    public Boolean isPageMessage() {\n        return isPageMessage;\n    }\n    \n    public void setIsPageMessage(Boolean isPageMessage){\n        this.isPageMessage = isPageMessage;\n    }\n}','java.lang.String'),(17536,2740,'X','2303.0','java.lang.Double'),(17537,2740,'Id','2740','java.lang.Integer'),(17538,2740,'Y','-712.0','java.lang.Double'),(17539,2740,'ContainedText','Read log','java.lang.String'),(17540,2740,'NextNodeToRun','','java.lang.String'),(17541,2741,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(17542,2741,'FileOutputName','HSBC Websphere Blackfeather 9080-Report Test-[DATE]','java.lang.String'),(17543,2741,'X','2416.0','java.lang.Double'),(17544,2741,'Id','2741','java.lang.Integer'),(17545,2741,'Y','-712.0','java.lang.Double'),(17546,2741,'ContainedText','Excel','java.lang.String'),(17547,2741,'NextNodeToRun','Email Report Excel Results','java.lang.String'),(17548,2742,'Logic','public void function() {\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Run Reports\");\n    \n    RequestTrackerNode requestNode = (RequestTrackerNode)getNode(\"TrackLog\");\n    requestNode.clearAllRequests();\n   \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Run Reports\", nodeRunParams);\n}','java.lang.String'),(17549,2742,'X','1714.0','java.lang.Double'),(17550,2742,'Id','2742','java.lang.Integer'),(17551,2742,'Y','-712.0','java.lang.Double'),(17552,2742,'ContainedText','Report Setup','java.lang.String'),(17553,2742,'NextNodeToRun','','java.lang.String'),(17554,2743,'X','2423.0','java.lang.Double'),(17555,2743,'Id','2743','java.lang.Integer'),(17556,2743,'Y','-778.0','java.lang.Double'),(17557,2743,'ContainedText','TrackLog','java.lang.String'),(17558,2743,'NextNodeToRun','','java.lang.String'),(17559,2744,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Excel\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Report Logs - \" + envName)\n        .content(\"No content\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Report\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(17560,2744,'X','2508.0','java.lang.Double'),(17561,2744,'Id','2744','java.lang.Integer'),(17562,2744,'Y','-712.0','java.lang.Double'),(17563,2744,'ContainedText','Email Report Excel Results','java.lang.String'),(17564,2744,'NextNodeToRun','','java.lang.String'),(17565,2745,'Test','track>trackerNode::TrackLog\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\n\n// Run the Log report\nframe>select::default\nwait>specificTime::1000\n\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::[[logReportId]]\nclick>id::[[logReportId]]\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\nwait>finishAllRequests::60000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17566,2745,'X','2181.0','java.lang.Double'),(17567,2745,'Id','2745','java.lang.Integer'),(17568,2745,'Y','-712.0','java.lang.Double'),(17569,2745,'ContainedText','Report Log','java.lang.String'),(17570,2745,'NextNodeToRun','Read log','java.lang.String'),(17571,2746,'Logic','public void function() {\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Report Log\");\n   \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Report Log\", nodeRunParams);\n}','java.lang.String'),(17572,2746,'X','2013.0','java.lang.Double'),(17573,2746,'Id','2746','java.lang.Integer'),(17574,2746,'Y','-712.0','java.lang.Double'),(17575,2746,'ContainedText','Report Log Logic','java.lang.String'),(17576,2746,'NextNodeToRun','','java.lang.String'),(17577,2747,'Logic','public void function() {\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Popup Log\");\n   \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Popup Log\", nodeRunParams);\n}','java.lang.String'),(17578,2747,'X','2627.0','java.lang.Double'),(17579,2747,'Id','2747','java.lang.Integer'),(17580,2747,'Y','-527.0','java.lang.Double'),(17581,2747,'ContainedText','Popup Log Logic','java.lang.String'),(17582,2747,'NextNodeToRun','','java.lang.String'),(17583,2748,'Test','track>trackerNode::Tracker1\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\n\n// Run the Log report\nframe>select::default\nwait>specificTime::1000\n\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::[[logReportId]]\nclick>id::[[logReportId]]\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\nwait>finishAllRequests::60000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17584,2748,'X','2788.0','java.lang.Double'),(17585,2748,'Id','2748','java.lang.Integer'),(17586,2748,'Y','-526.0','java.lang.Double'),(17587,2748,'ContainedText','Popup Log','java.lang.String'),(17588,2748,'NextNodeToRun','Read Popup Log','java.lang.String'),(17589,2749,'Logic','public void function() {\n   RequestTrackerNode trackerNode = (RequestTrackerNode)getNode(\"Tracker1\");\n   InputNode inputNode = (InputNode)getNode(\"Login Input\");\n   \n    ExportNode exportNode = (ExportNode)getNode(\"Popup Excel Log\");\n    InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Popup Test Log-[DATE]\");\n   \n    // Find the current output folder location\n    CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n    exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n   \n   String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n   \n   List<WebProxyRequest> logList = trackerNode.getResultList();\n   \n   LinkedHashMap<LogMessage, WebProxyRequest> requestMapping = new LinkedHashMap<>();\n   LinkedHashMap<LogMessage, WebProxyRequest> errorMapping = new LinkedHashMap<>();\n   \n   log.info(\"Worksheet Requests = \" + logList.size());\n   log.info(\"Internal url is \" + internalURL);\n   for(WebProxyRequest webProxyRequest : logList){\n       if(webProxyRequest.getResponseContent().contains(\"LogFile:\")){\n            List<LogMessage> messageList = decodeLog(webProxyRequest.getResponseContent());\n            \n            WebProxyRequest matchedRequest = null;\n            WebProxyRequest matchedEnterRequest = null;\n            Integer timeDifference = Integer.MAX_VALUE;\n            Integer timeDifferenceEnterRequest = Integer.MAX_VALUE;\n            //log.info(\"Log messages = \" + messageList.size());\n            for(LogMessage message : messageList){\n                //log.info(message.getRawLog());\n                //log.info(\"Is page \" + message.isPageMessage() + \" isEnter \" + message.isEnter());\n                if(message.isPageMessage() && !message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    //log.info(\"We have a leave\");\n                    \n                    List<WebProxyRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifference = Integer.MAX_VALUE;\n                    \n                    //log.info(\"**** \" + messagePageURL);\n                    for(WebProxyRequest webProxyRequest2 : messagePage) {\n                        //log.info(\"Request thing is \" + webProxyRequest2.getRequestURL());\n                        if(message.getTime() != null && webProxyRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),webProxyRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            //log.info(\"Old \" + timeDifference + \" diff \" + secondsDifference);\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifference)){\n                                timeDifference = secondsDifference;\n                                matchedRequest = webProxyRequest2;\n                            }\n                        }\n                    }\n                    if(matchedRequest != null && Math.abs(timeDifference) < 30){\n                        //log.info(\"Added \" + message.getRawLog() + \" to \" + matchedRequest.getRequestURL());\n                        requestMapping.put(message, matchedRequest);\n                    }\n                } else if(message.isPageMessage() && message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    List<WebProxyRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifferenceEnterRequest = Integer.MAX_VALUE;\n                    \n                    //log.info(\"We have an enter here\");\n                    \n                    for(WebProxyRequest webProxyRequest2 : messagePage) {\n                        if(message.getTime() != null && webProxyRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),webProxyRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifferenceEnterRequest)){\n                                timeDifferenceEnterRequest = secondsDifference;\n                                matchedEnterRequest = webProxyRequest2;\n                            }\n                        }\n                    }\n                    //if(matchedEnterRequest != null && Math.abs(timeDifference) < 30){\n                        //requestMapping.put(message, matchedEnterRequest);\n                    //}\n                } else { // These are other random log bits\n                //log.info(\"Found error \" + matchedEnterRequest + \" --- \" + timeDifferenceEnterRequest + \" ---- \" + message.getRawLog());\n                    if (matchedEnterRequest != null && Math.abs(timeDifferenceEnterRequest) < 30) { // We match it up to the last page request, it probably belongs to that?  As far as we know.\n                        //log.info(\"Added error\");\n                        errorMapping.put(message, matchedEnterRequest);\n                    }\n                }\n            }\n        }\n    }\n    \n    // log.info(requestMapping.size() + \" mapped requests\");\n    // log.info(errorMapping.size() + \" errors mapped to requests\");\n    \n    // log.info(\"ERRORS\");\n    // for(LogMessage logMessage : errorMapping.keySet()){\n    //     log.info(\"Error \" + logMessage.getRawLog() + \" belongs to \" + errorMapping.get(logMessage).getRequestURL() + \" at \" + errorMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    // log.info(\"\");\n    // log.info(\"REQUESTS\");\n    // for(LogMessage logMessage : requestMapping.keySet()){\n    //     log.info(\"Request \" + logMessage.getRawLog() + \" belongs to \" + requestMapping.get(logMessage).getRequestURL() + \" at \" + requestMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    \n    reportErrors(requestMapping,errorMapping);\n    \n    runAndWait(\"Report Setup\");\n}\n\npublic void reportErrors(LinkedHashMap<LogMessage, WebProxyRequest> requestMapping, LinkedHashMap<LogMessage, WebProxyRequest> errorMapping) {\n    Integer excelSize = (requestMapping.size() + errorMapping.size()) * 2;\n    \n    log.info(\"Requests \" + requestMapping.size() + \" Error \" + errorMapping.size());\n    log.info(\"Excel size \" + excelSize);\n    \n    if(excelSize < 1){\n        excelSize = 10;\n    }\n    \n    Export export = new Export(excelSize,5);\n    \n    Integer lineCounter = 1;\n            \n    // Header row\n    export.add(new ExportValue(\"Request (\" + requestMapping.size() + \")\",0,0));\n    export.add(new ExportValue(\"Time\",0,1));\n    export.add(new ExportValue(\"User\",0,2));\n    export.add(new ExportValue(\"Duration\",0,3));\n    export.add(new ExportValue(\"Log Errors (\" + errorMapping.size() + \")\",0,4));\n    \n    // Requests\n    for(LogMessage logMessage : requestMapping.keySet()){\n        export.add(new ExportValue(logMessage.getPage(),lineCounter,0));\n        org.joda.time.format.DateTimeFormatter dtfOut = org.joda.time.format.DateTimeFormat.forPattern(\"HH:mm:ss MM/dd/yyyy\");\n        export.add(new ExportValue(dtfOut.print(logMessage.getTime()),lineCounter,1));\n        export.add(new ExportValue(logMessage.getUser(),lineCounter,2));\n        export.add(new ExportValue(logMessage.getDuration(),lineCounter,3));\n        \n        Boolean addedLine = false;\n        for(LogMessage errorLog : errorMapping.keySet()){\n            if(requestMapping.get(logMessage) == errorMapping.get(errorLog)){\n                export.add(new ExportValue(errorLog.getRawLog(),lineCounter,4));\n                lineCounter++;\n                addedLine = true;\n            }\n        }\n        \n        if(!addedLine){\n            lineCounter++;    \n        }\n    }\n    \n    nodeRunParams.setOneTimeVariable(export);\n    runAndWait(\"Popup Excel Log\", nodeRunParams);\n}\n\npublic List<LogMessage> decodeLog(String logRequest) {\n    String lines[] = logRequest.split(\"\\\\r?\\\\n\");\n\n    org.joda.time.DateTime time = new org.joda.time.DateTime();\n    \n    List<LogMessage> logMessages = new ArrayList<>();\n    \n    for(int i = 0;i< lines.length;i++){\n        String line = lines[i];\n        \n        LogMessage logMessage = new LogMessage();\n        logMessage.setRawLog(line);\n        \n        if(line.contains(\"[monitor]\")) { // This is a page log message\n            HashMap<String, String> result = decodeLogLine(line);\n\n            logMessage.setUser(result.get(\"USER\"));\n            logMessage.setPage(result.get(\"PAGE\"));\n            logMessage.setDuration(result.get(\"DURATION\"));\n            logMessage.setIsEnter(result.get(\"ENTER\"));\n            logMessage.parseTime(result.get(\"TIME\"));\n            logMessage.setIsPageMessage(true);\n        } else { // This is anything else, could be an exception\n            logMessage.setIsPageMessage(false);\n        }\n        \n        logMessages.add(logMessage);\n    }\n    \n    return logMessages;\n}\n\npublic HashMap<String,String> decodeLogLine(String logLine) {\n    String sections[] = logLine.split(\",\");\n    \n    HashMap<String, String> parsedLine = new HashMap<>();\n    \n    //log.info(\"Length = \" + sections.length);\n    if(sections.length == 16 || sections.length == 26){ // All logs have 16 parts\n        String time = sections[0] + \",\" + sections[1].substring(0,3);\n        String enterLeave =  sections[1].substring(20,25);\n        String user = sections[7];\n        String page = sections[9];\n        String duration = sections[11];\n        \n        parsedLine.put(\"TIME\",time);\n        parsedLine.put(\"ENTER\",enterLeave);\n        parsedLine.put(\"PAGE\",page);\n        parsedLine.put(\"USER\",user);\n        parsedLine.put(\"DURATION\",duration);\n    }\n    \n    return parsedLine;\n}\n\nprivate class LogMessage {\n    private String rawLog = \"\";\n    private Boolean isPageMessage = false;\n    private Boolean isEnter = false;\n    private String page = \"\";\n    private String user = \"\";\n    private String duration = \"\";\n    private org.joda.time.DateTime time; \n    \n    public LogMessage() {\n    }\n    \n    public org.joda.time.DateTime getTime() {\n        return time;\n    }\n    \n    public void parseTime(String timeStr) {\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        \n        String timeZoneStr = inputNode.getInputByName(\"[[logTimeZone]]\").getVariableValue();\n        org.joda.time.DateTimeZone zone = null;\n        if(timeZoneStr != null){\n            zone = org.joda.time.DateTimeZone.forID(timeZoneStr);\n        }\n        \n        if(timeStr != null){\n            Integer year = Integer.parseInt(timeStr.substring(0,4));\n            Integer month = Integer.parseInt(timeStr.substring(5,7));\n            Integer day = Integer.parseInt(timeStr.substring(8,10));\n            Integer hour = Integer.parseInt(timeStr.substring(11,13));\n            Integer minute = Integer.parseInt(timeStr.substring(14,16));\n            Integer second = Integer.parseInt(timeStr.substring(17,19));\n            Integer millisecond = Integer.parseInt(timeStr.substring(20,23));\n        \n            if(zone != null){\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond,zone); \n            } else {\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond); \n            }\n        }\n    }\n    \n    public String getDuration() {\n        return duration;\n    }\n    \n    public void setDuration(String duration) {\n        this.duration = duration;\n    }\n    \n    public Boolean isEnter() {\n        return isEnter;\n    }\n    \n    public void setIsEnter(String isEnter){\n        this.isEnter = \"Enter\".equals(isEnter);\n    }\n    \n    public String getPage() {\n        return page;\n    }\n    \n    public void setPage(String page){\n        this.page = page;\n    }\n    \n    public String getUser() {\n        return user;\n    }\n    \n    public void setUser(String user){\n        this.user = user;\n    }\n    \n    public String getRawLog() {\n        return rawLog;\n    }\n    \n    public void setRawLog(String rawLog){\n        this.rawLog = rawLog;\n    }\n    \n    public Boolean isPageMessage() {\n        return isPageMessage;\n    }\n    \n    public void setIsPageMessage(Boolean isPageMessage){\n        this.isPageMessage = isPageMessage;\n    }\n}','java.lang.String'),(17590,2749,'X','2918.0','java.lang.Double'),(17591,2749,'Id','2749','java.lang.Integer'),(17592,2749,'Y','-526.0','java.lang.Double'),(17593,2749,'ContainedText','Read Popup Log','java.lang.String'),(17594,2749,'NextNodeToRun','','java.lang.String'),(17595,2750,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(17596,2750,'FileOutputName','HSBC Websphere Blackfeather 9080-Popup Test Log-[DATE]','java.lang.String'),(17597,2750,'X','3083.0','java.lang.Double'),(17598,2750,'Id','2750','java.lang.Integer'),(17599,2750,'Y','-526.0','java.lang.Double'),(17600,2750,'ContainedText','Popup Excel Log','java.lang.String'),(17601,2750,'NextNodeToRun','Email Popup Excel Log','java.lang.String'),(17602,2751,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Popup Excel Log\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Worksheet Popups Log - \" + envName)\n        .content(\"this doesn\'t seem to show..\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Popup\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(17603,2751,'X','3241.0','java.lang.Double'),(17604,2751,'Id','2751','java.lang.Integer'),(17605,2751,'Y','-526.0','java.lang.Double'),(17606,2751,'ContainedText','Email Popup Excel Log','java.lang.String'),(17607,2751,'NextNodeToRun','','java.lang.String'),(17608,2752,'Logic','public void function() {\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Admin Log\");\n   \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Admin Log\", nodeRunParams);\n}','java.lang.String'),(17609,2752,'X','2444.0','java.lang.Double'),(17610,2752,'Id','2752','java.lang.Integer'),(17611,2752,'Y','-111.0','java.lang.Double'),(17612,2752,'ContainedText','Admin Log Logic','java.lang.String'),(17613,2752,'NextNodeToRun','','java.lang.String'),(17614,2753,'Test','track>trackerNode::Tracker1\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\n\n// Run the Log report\nframe>select::default\nwait>specificTime::1000\n\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::[[logReportId]]\nclick>id::[[logReportId]]\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\nwait>finishAllRequests::60000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17615,2753,'X','2625.0','java.lang.Double'),(17616,2753,'Id','2753','java.lang.Integer'),(17617,2753,'Y','-111.0','java.lang.Double'),(17618,2753,'ContainedText','Admin Log','java.lang.String'),(17619,2753,'NextNodeToRun','Read Admin Log','java.lang.String'),(17620,2754,'Logic','public void function() {\n   RequestTrackerNode trackerNode = (RequestTrackerNode)getNode(\"Tracker1\");\n   InputNode inputNode = (InputNode)getNode(\"Login Input\");\n   \n    ExportNode exportNode = (ExportNode)getNode(\"Admin Excel Log\");\n    InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Admin Test Log-[DATE]\");\n   \n    // Find the current output folder location\n    CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n    exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n   \n   String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n   \n   List<WebProxyRequest> logList = trackerNode.getResultList();\n   \n   LinkedHashMap<LogMessage, WebProxyRequest> requestMapping = new LinkedHashMap<>();\n   LinkedHashMap<LogMessage, WebProxyRequest> errorMapping = new LinkedHashMap<>();\n   \n   log.info(\"Worksheet Requests = \" + logList.size());\n   log.info(\"Internal url is \" + internalURL);\n   for(WebProxyRequest webProxyRequest : logList){\n       if(webProxyRequest.getResponseContent().contains(\"LogFile:\")){\n            List<LogMessage> messageList = decodeLog(webProxyRequest.getResponseContent());\n            \n            WebProxyRequest matchedRequest = null;\n            WebProxyRequest matchedEnterRequest = null;\n            Integer timeDifference = Integer.MAX_VALUE;\n            Integer timeDifferenceEnterRequest = Integer.MAX_VALUE;\n            //log.info(\"Log messages = \" + messageList.size());\n            for(LogMessage message : messageList){\n                //log.info(message.getRawLog());\n                //log.info(\"Is page \" + message.isPageMessage() + \" isEnter \" + message.isEnter());\n                if(message.isPageMessage() && !message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    //log.info(\"We have a leave\");\n                    \n                    List<WebProxyRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifference = Integer.MAX_VALUE;\n                    \n                    //log.info(\"**** \" + messagePageURL);\n                    for(WebProxyRequest webProxyRequest2 : messagePage) {\n                        //log.info(\"Request thing is \" + webProxyRequest2.getRequestURL());\n                        if(message.getTime() != null && webProxyRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),webProxyRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            //log.info(\"Old \" + timeDifference + \" diff \" + secondsDifference);\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifference)){\n                                timeDifference = secondsDifference;\n                                matchedRequest = webProxyRequest2;\n                            }\n                        }\n                    }\n                    if(matchedRequest != null && Math.abs(timeDifference) < 30){\n                        //log.info(\"Added \" + message.getRawLog() + \" to \" + matchedRequest.getRequestURL());\n                        requestMapping.put(message, matchedRequest);\n                    }\n                } else if(message.isPageMessage() && message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    List<WebProxyRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifferenceEnterRequest = Integer.MAX_VALUE;\n                    \n                    //log.info(\"We have an enter here\");\n                    \n                    for(WebProxyRequest webProxyRequest2 : messagePage) {\n                        if(message.getTime() != null && webProxyRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),webProxyRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifferenceEnterRequest)){\n                                timeDifferenceEnterRequest = secondsDifference;\n                                matchedEnterRequest = webProxyRequest2;\n                            }\n                        }\n                    }\n                    //if(matchedEnterRequest != null && Math.abs(timeDifference) < 30){\n                        //requestMapping.put(message, matchedEnterRequest);\n                    //}\n                } else { // These are other random log bits\n                //log.info(\"Found error \" + matchedEnterRequest + \" --- \" + timeDifferenceEnterRequest + \" ---- \" + message.getRawLog());\n                    if (matchedEnterRequest != null && Math.abs(timeDifferenceEnterRequest) < 30) { // We match it up to the last page request, it probably belongs to that?  As far as we know.\n                        //log.info(\"Added error\");\n                        errorMapping.put(message, matchedEnterRequest);\n                    }\n                }\n            }\n        }\n    }\n    \n    // log.info(requestMapping.size() + \" mapped requests\");\n    // log.info(errorMapping.size() + \" errors mapped to requests\");\n    \n    // log.info(\"ERRORS\");\n    // for(LogMessage logMessage : errorMapping.keySet()){\n    //     log.info(\"Error \" + logMessage.getRawLog() + \" belongs to \" + errorMapping.get(logMessage).getRequestURL() + \" at \" + errorMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    // log.info(\"\");\n    // log.info(\"REQUESTS\");\n    // for(LogMessage logMessage : requestMapping.keySet()){\n    //     log.info(\"Request \" + logMessage.getRawLog() + \" belongs to \" + requestMapping.get(logMessage).getRequestURL() + \" at \" + requestMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    \n    reportErrors(requestMapping,errorMapping);\n    \n    RequestTrackerNode requestNode = (RequestTrackerNode)getNode(\"Tracker1\");\n    requestNode.clearAllRequests();\n    \n    runAndWait(\"Popup Setup\");\n}\n\npublic void reportErrors(LinkedHashMap<LogMessage, WebProxyRequest> requestMapping, LinkedHashMap<LogMessage, WebProxyRequest> errorMapping) {\n    Integer excelSize = (requestMapping.size() + errorMapping.size()) * 2;\n    \n    log.info(\"Requests \" + requestMapping.size() + \" Error \" + errorMapping.size());\n    log.info(\"Excel size \" + excelSize);\n    \n    if(excelSize < 1){\n        excelSize = 10;\n    }\n    \n    Export export = new Export(excelSize,5);\n    \n    Integer lineCounter = 1;\n            \n    // Header row\n    export.add(new ExportValue(\"Request (\" + requestMapping.size() + \")\",0,0));\n    export.add(new ExportValue(\"Time\",0,1));\n    export.add(new ExportValue(\"User\",0,2));\n    export.add(new ExportValue(\"Duration\",0,3));\n    export.add(new ExportValue(\"Log Errors (\" + errorMapping.size() + \")\",0,4));\n    \n    // Requests\n    for(LogMessage logMessage : requestMapping.keySet()){\n        export.add(new ExportValue(logMessage.getPage(),lineCounter,0));\n        org.joda.time.format.DateTimeFormatter dtfOut = org.joda.time.format.DateTimeFormat.forPattern(\"HH:mm:ss MM/dd/yyyy\");\n        export.add(new ExportValue(dtfOut.print(logMessage.getTime()),lineCounter,1));\n        export.add(new ExportValue(logMessage.getUser(),lineCounter,2));\n        export.add(new ExportValue(logMessage.getDuration(),lineCounter,3));\n        \n        Boolean addedLine = false;\n        for(LogMessage errorLog : errorMapping.keySet()){\n            if(requestMapping.get(logMessage) == errorMapping.get(errorLog)){\n                export.add(new ExportValue(errorLog.getRawLog(),lineCounter,4));\n                lineCounter++;\n                addedLine = true;\n            }\n        }\n        \n        if(!addedLine){\n            lineCounter++;    \n        }\n    }\n    \n    nodeRunParams.setOneTimeVariable(export);\n    runAndWait(\"Admin Excel Log\", nodeRunParams);\n}\n\npublic List<LogMessage> decodeLog(String logRequest) {\n    String lines[] = logRequest.split(\"\\\\r?\\\\n\");\n\n    org.joda.time.DateTime time = new org.joda.time.DateTime();\n    \n    List<LogMessage> logMessages = new ArrayList<>();\n    \n    for(int i = 0;i< lines.length;i++){\n        String line = lines[i];\n        \n        LogMessage logMessage = new LogMessage();\n        logMessage.setRawLog(line);\n        \n        if(line.contains(\"[monitor]\")) { // This is a page log message\n            HashMap<String, String> result = decodeLogLine(line);\n\n            logMessage.setUser(result.get(\"USER\"));\n            logMessage.setPage(result.get(\"PAGE\"));\n            logMessage.setDuration(result.get(\"DURATION\"));\n            logMessage.setIsEnter(result.get(\"ENTER\"));\n            logMessage.parseTime(result.get(\"TIME\"));\n            logMessage.setIsPageMessage(true);\n        } else { // This is anything else, could be an exception\n            logMessage.setIsPageMessage(false);\n        }\n        \n        logMessages.add(logMessage);\n    }\n    \n    return logMessages;\n}\n\npublic HashMap<String,String> decodeLogLine(String logLine) {\n    String sections[] = logLine.split(\",\");\n    \n    HashMap<String, String> parsedLine = new HashMap<>();\n    \n    //log.info(\"Length = \" + sections.length);\n    if(sections.length == 16 || sections.length == 26){ // All logs have 16 parts\n        String time = sections[0] + \",\" + sections[1].substring(0,3);\n        String enterLeave =  sections[1].substring(20,25);\n        String user = sections[7];\n        String page = sections[9];\n        String duration = sections[11];\n        \n        parsedLine.put(\"TIME\",time);\n        parsedLine.put(\"ENTER\",enterLeave);\n        parsedLine.put(\"PAGE\",page);\n        parsedLine.put(\"USER\",user);\n        parsedLine.put(\"DURATION\",duration);\n    }\n    \n    return parsedLine;\n}\n\nprivate class LogMessage {\n    private String rawLog = \"\";\n    private Boolean isPageMessage = false;\n    private Boolean isEnter = false;\n    private String page = \"\";\n    private String user = \"\";\n    private String duration = \"\";\n    private org.joda.time.DateTime time; \n    \n    public LogMessage() {\n    }\n    \n    public org.joda.time.DateTime getTime() {\n        return time;\n    }\n    \n    public void parseTime(String timeStr) {\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        \n        String timeZoneStr = inputNode.getInputByName(\"[[logTimeZone]]\").getVariableValue();\n        org.joda.time.DateTimeZone zone = null;\n        if(timeZoneStr != null){\n            zone = org.joda.time.DateTimeZone.forID(timeZoneStr);\n        }\n        \n        if(timeStr != null){\n            Integer year = Integer.parseInt(timeStr.substring(0,4));\n            Integer month = Integer.parseInt(timeStr.substring(5,7));\n            Integer day = Integer.parseInt(timeStr.substring(8,10));\n            Integer hour = Integer.parseInt(timeStr.substring(11,13));\n            Integer minute = Integer.parseInt(timeStr.substring(14,16));\n            Integer second = Integer.parseInt(timeStr.substring(17,19));\n            Integer millisecond = Integer.parseInt(timeStr.substring(20,23));\n        \n            if(zone != null){\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond,zone); \n            } else {\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond); \n            }\n        }\n    }\n    \n    public String getDuration() {\n        return duration;\n    }\n    \n    public void setDuration(String duration) {\n        this.duration = duration;\n    }\n    \n    public Boolean isEnter() {\n        return isEnter;\n    }\n    \n    public void setIsEnter(String isEnter){\n        this.isEnter = \"Enter\".equals(isEnter);\n    }\n    \n    public String getPage() {\n        return page;\n    }\n    \n    public void setPage(String page){\n        this.page = page;\n    }\n    \n    public String getUser() {\n        return user;\n    }\n    \n    public void setUser(String user){\n        this.user = user;\n    }\n    \n    public String getRawLog() {\n        return rawLog;\n    }\n    \n    public void setRawLog(String rawLog){\n        this.rawLog = rawLog;\n    }\n    \n    public Boolean isPageMessage() {\n        return isPageMessage;\n    }\n    \n    public void setIsPageMessage(Boolean isPageMessage){\n        this.isPageMessage = isPageMessage;\n    }\n}','java.lang.String'),(17621,2754,'X','2775.0','java.lang.Double'),(17622,2754,'Id','2754','java.lang.Integer'),(17623,2754,'Y','-111.0','java.lang.Double'),(17624,2754,'ContainedText','Read Admin Log','java.lang.String'),(17625,2754,'NextNodeToRun','','java.lang.String'),(17626,2755,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(17627,2755,'FileOutputName','HSBC Websphere Blackfeather 9080-Admin Test Log-[DATE]','java.lang.String'),(17628,2755,'X','2953.0','java.lang.Double'),(17629,2755,'Id','2755','java.lang.Integer'),(17630,2755,'Y','-111.0','java.lang.Double'),(17631,2755,'ContainedText','Admin Excel Log','java.lang.String'),(17632,2755,'NextNodeToRun','Email Admin Excel Log','java.lang.String'),(17633,2756,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Admin Excel Log\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Admin Menu Log - \" + envName)\n        .content(\"No content\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Admin\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(17634,2756,'X','3128.0','java.lang.Double'),(17635,2756,'Id','2756','java.lang.Integer'),(17636,2756,'Y','-111.0','java.lang.Double'),(17637,2756,'ContainedText','Email Admin Excel Log','java.lang.String'),(17638,2756,'NextNodeToRun','','java.lang.String'),(17639,2757,'X','965.0','java.lang.Double'),(17640,2757,'Id','2757','java.lang.Integer'),(17641,2757,'Y','56.0','java.lang.Double'),(17642,2757,'ContainedText','Environment Configuration','java.lang.String'),(17643,2757,'NextNodeToRun','','java.lang.String'),(17644,2758,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    CustomObjectNode envsToRun = (CustomObjectNode)getNode(\"Envs to run\");\n    SwitchNode envSelect = (SwitchNode)getNode(\"Environment Select\");\n    \n    List<String> enabledSwitches = new ArrayList<>();\n    for(Switch aSwitch: envSelect.getSwitches()){\n        if(aSwitch.isEnabled()){\n            enabledSwitches.add(aSwitch.getTarget());\n        }    \n    }\n    \n    DataTableNode envConf = (DataTableNode)getNode(\"Environment Configuration\");\n    List<DataTableRow> dataTableRowList = envConf.getDataTableRows();\n    log.info(\"After line 15?\");\n    List<HashMap<String, String>> environments = (List<HashMap<String, String>>) envsToRun.getCustomObject(\"envs\").getPayload();\n    log.info(\"got here?\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList) {\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        HashMap<String, String> envInfo = new HashMap<>();\n        if(dataTableRowData.get(\"EnvName\") != null){\n        log.info(\"********** \" + dataTableRowData.get(\"EnvName\").getDataValue() + \" ********\");\n            if(enabledSwitches.contains(dataTableRowData.get(\"EnvName\").getDataValue())){\n                for(String key : dataTableRowData.keySet()){\n                    log.info(key + \" -> \" + dataTableRowData.get(key).getDataValue());    \n                    envInfo.put(key,dataTableRowData.get(key).getDataValue());\n                }\n                \n                environments.add(envInfo);    \n            } else {\n                log.info(\"Skipped\");\n            }\n        }\n    }\n}','java.lang.String'),(17645,2758,'X','788.0','java.lang.Double'),(17646,2758,'Id','2758','java.lang.Integer'),(17647,2758,'Y','93.0','java.lang.Double'),(17648,2758,'ContainedText','Process Env Info','java.lang.String'),(17649,2758,'NextNodeToRun','','java.lang.String'),(17650,2759,'X','1018.0','java.lang.Double'),(17651,2759,'Id','2759','java.lang.Integer'),(17652,2759,'Y','-45.0','java.lang.Double'),(17653,2759,'ContainedText','Emails','java.lang.String'),(17654,2759,'NextNodeToRun','','java.lang.String'),(17655,2760,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-[DATE]','java.lang.String'),(17656,2760,'FileOutputName','','java.lang.String'),(17657,2760,'X','993.0','java.lang.Double'),(17658,2760,'Id','2760','java.lang.Integer'),(17659,2760,'Y','-106.0','java.lang.Double'),(17660,2760,'ContainedText','Output Directory','java.lang.String'),(17661,2760,'NextNodeToRun','','java.lang.String'),(17662,2761,'X','1131.0','java.lang.Double'),(17663,2761,'Id','2761','java.lang.Integer'),(17664,2761,'Y','287.0','java.lang.Double'),(17665,2761,'ContainedText','File Location','java.lang.String'),(17666,2761,'NextNodeToRun','','java.lang.String'),(17667,2762,'X','159.0','java.lang.Double'),(17668,2762,'Id','2762','java.lang.Integer'),(17669,2762,'Y','434.0','java.lang.Double'),(17670,2762,'ContainedText','New InputNode','java.lang.String'),(17671,2762,'NextNodeToRun','','java.lang.String'),(17672,2763,'X','203.0','java.lang.Double'),(17673,2763,'Id','2763','java.lang.Integer'),(17674,2763,'Y','679.0','java.lang.Double'),(17675,2763,'ContainedText','Con','java.lang.String'),(17676,2763,'NextNodeToRun','','java.lang.String'),(17677,2764,'X','388.0','java.lang.Double'),(17678,2764,'Id','2764','java.lang.Integer'),(17679,2764,'Y','678.0','java.lang.Double'),(17680,2764,'ContainedText','New TriggerNode','java.lang.String'),(17681,2764,'NextNodeToRun','','java.lang.String'),(17737,2774,'Logic','private String finalStr = \"\";\nprivate DataBaseNode dbNode;\n\npublic void function() {\n    // Get the nodes we need\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    InputNode envNameInputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = envNameInputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode testsToRun = (DataTableNode)getNode(\"Tests to run\");\n    List<DataTableRow> testsToRunList = testsToRun.getDataTableRows();\n    \n    Boolean runTest = false;\n    for(DataTableRow test : testsToRunList){\n        HashMap<String, DataTableValue> testData = test.getDataTableValues();\n        \n        if(envName.equals(testData.get(\"EnvName\").getDataValue())){\n            if(\"Y\".equals(testData.get(\"Admin Pages\").getDataValue())){\n                runTest = true;\n                break;\n            } \n        }\n    }\n    \n    if(runTest){\n        TestNode testNode = (TestNode)getNode(\"Login Test\");\n        \n        // Init DB and get the node\n        runAndWait(\"Oracle\");\n        dbNode = (DataBaseNode)getNode(\"Oracle\");\n        \n        // This gets the main root admin menu\n        String adminMenuId = findAdminMenuId(\"Admin\");\n    \n        // This gets the import menu, we need to avoid this as while these are within the admin menu tree they are hard coded to not display, so we shouldn\'t be looking for them\n        String importMenuId = findAdminMenuId(\"ImportMenuMainPage\");\n        \n        // This gets the annual import menu, we need to do the same as the above import menu for this as well\n        String annualImportMenuId = findAdminMenuId(\"AnnualImport\");\n        String archiveMaintMenuId = findAdminMenuId(\"Archive Maint\");\n        \n        // Get all the menu references from the database\n        finalStr = \"\"; // Set to blank in case we have something left over from a previous test\n        createMenuReference(adminMenuId,\"\"); // The menu id here is the top level menu we want to test all the children of\n        //createMenuReference(archiveMaintMenuId,\"\"); // Fast test menu\n    \n        finalStr = finalStr.substring(0,finalStr.length() - 1); // Remove the trailing comma\n        \n        String[] menuReferenceSplit = finalStr.split(\",\");\n        \n        log.info(annualImportMenuId);\n        \n        // Generate the script to run selenium looping through all the menu references we have created\n        String generatedCode = \"\";\n        for(String menuReference : menuReferenceSplit){\n            if(!menuReference.contains(\"<\"+importMenuId) && !menuReference.contains(\"<\"+annualImportMenuId)){ // If the menu reference makes use of the import menu we don\'t want, skip it\n               generatedCode += testAdminPage(menuReference); \n            } else {\n                log.info(\"Skipped \" + menuReference);\n            }\n        }\n        \n        //log.info(generatedCode);\n        \n        // Apply the inputs and run the test\n        inputNode.setInputsByName(\"[[admincode]]\",generatedCode);\n        nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n        \n        // Tidy up our database connection\n        dbNode.getDbConnection().close();\n        \n        // Run the selenium test\n        runAndWait(\"Login Test\", nodeRunParams);\n        // Run the logic to output excel file\n        nodeRunParams.setOneTimeVariable(finalStr);\n        log.info(\"About to hand over to export\");\n        runAndWait(\"V6 Create Export\", nodeRunParams);    \n    } else {\n        runAndWait(\"Popup Setup\");\n    }\n}\n\npublic String createMenuReference(String menuSeqId, String pathSoFar) {\n    String thisPath = \"\";\n    \n    // We add this menu onto the path we are already creating, but not the first time when the path is already blank\n    if(pathSoFar.equals(\"\")){\n        thisPath = menuSeqId;\n    } else {\n        thisPath = pathSoFar + \"<\" + menuSeqId;\n    }\n    \n    // Query to find the children menu items of the current menu\n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_seq_id from fr_menus where parent_menu_seq_id = \" + menuSeqId));\n\n    Boolean bottomMenu = true;\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        String menuReference = \"\";\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuReference = selectResultRow.getLong(\"menu_seq_id\").toString();\n        } else {\n            menuReference = selectResultRow.getBigDecimal(\"MENU_SEQ_ID\").toString();\n        }\n        \n        createMenuReference(menuReference,thisPath);\n        bottomMenu = false;\n    }\n    \n    // If we have reached the bottom of the menu chain it is time to record the path we used to get here\n    if(bottomMenu) {\n        // We don\'t want to include menus which have no html path set as these are not value menus\n        selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select html_path from fr_menus where menu_seq_id = \" + menuSeqId));\n        \n        Boolean hasPath = false;\n        for (SelectResultRow selectResultRow : selectResult.getResults()) {\n            hasPath = true;\n        }\n        \n        // If it has an html path we add it to the rest of the final string\n        if(hasPath) {\n           finalStr += pathSoFar + \"<\" + menuSeqId + \",\"; \n        } else {\n            log.info(\"Skipping \" + menuSeqId + \" as no path\");\n        }\n    }\n    \n    return thisPath;\n}\n\npublic String findAdminMenuId(String menuName){\n    String menuId = \"\";\n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_seq_id from fr_menus where menu_name = \'\" + menuName + \"\'\"));\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuId = selectResultRow.getLong(\"menu_seq_id\").toString();\n        } else {\n            menuId = selectResultRow.getBigDecimal(\"MENU_SEQ_ID\").toString();\n        }\n    }\n    \n    return menuId;\n}\n\npublic String testAdminPage(String menuReference) {\n    String[] splitMenu = menuReference.split(\"<\");\n    String returnString = \"\";\n    \n    returnString += \"frame>id::axmorMenuContent\" + \"\\r\\n\"; // Select the axmor menu frame\n    \n    for(int i = 0;i < splitMenu.length - 1;i++) {\n        returnString += \"wait>presence::xPath:://*[@id=\\\"\" + splitMenu[i] +\"\\\"]/ins\" + \"\\r\\n\";\n        returnString += \"click>xPath:://*[@id=\\\"\" + splitMenu[i] + \"\\\"]/ins\" + \"\\r\\n\";\n        returnString += \"wait>specificTime::500\" + \"\\r\\n\";\n    }\n\n    returnString += \"wait>presence::xPath:://*[@id=\\\"\" + splitMenu[splitMenu.length - 1] +\"\\\"]/a\" + \"\\r\\n\";\n    returnString += \"click>xPath:://*[@id=\\\"\" + splitMenu[splitMenu.length - 1] +\"\\\"]/a\" + \"\\r\\n\";\n    returnString += \"wait>specificTime::800\" + \"\\r\\n\";\n    returnString += \"frame>select::default\" + \"\\r\\n\"; // Return to the main window frame to clean up at the end\n    \n    returnString += \"frame>frameLoaded::content\" + \"\\r\\n\"; // Wait for the frame to be loaded\n    returnString += \"frame>id::axmorMenuContent\" + \"\\r\\n\"; // Select the axmor menu frame\n    \n    for(int i = splitMenu.length - 2;i > -1;i--) {\n        returnString += \"wait>presence::xPath:://*[@id=\\\"\" + splitMenu[i] +\"\\\"]/ins\" + \"\\r\\n\";\n        returnString += \"click>xPath:://*[@id=\\\"\" + splitMenu[i] + \"\\\"]/ins\" + \"\\r\\n\";\n        returnString += \"wait>specificTime::500\" + \"\\r\\n\";\n    }\n    \n    returnString += \"frame>select::default\" + \"\\r\\n\"; // Return to the main window frame to clean up at the end\n    \n    return returnString;\n}','java.lang.String'),(17738,2774,'X','1632.0','java.lang.Double'),(17739,2774,'Id','2774','java.lang.Integer'),(17740,2774,'Y','-25.0','java.lang.Double'),(17741,2774,'ContainedText','V6 Selenium','java.lang.String'),(17742,2774,'NextNodeToRun','','java.lang.String'),(17743,2775,'X','2311.0','java.lang.Double'),(17744,2775,'Id','2775','java.lang.Integer'),(17745,2775,'Y','383.0','java.lang.Double'),(17746,2775,'ContainedText','Login Input','java.lang.String'),(17747,2775,'NextNodeToRun','','java.lang.String'),(17748,2776,'X','2310.0','java.lang.Double'),(17749,2776,'Id','2776','java.lang.Integer'),(17750,2776,'Y','292.0','java.lang.Double'),(17751,2776,'ContainedText','Tracker1','java.lang.String'),(17752,2776,'NextNodeToRun','','java.lang.String'),(17753,2777,'ConnectionString','jdbc:oracle:thin:@10.255.210.3:1521:FOCAL','java.lang.String'),(17754,2777,'Username','hsbc_qa_large','java.lang.String'),(17755,2777,'Password','hsbc_qa_large','java.lang.String'),(17756,2777,'X','2309.0','java.lang.Double'),(17757,2777,'Id','2777','java.lang.Integer'),(17758,2777,'Y','246.0','java.lang.Double'),(17759,2777,'ContainedText','Oracle','java.lang.String'),(17760,2777,'NextNodeToRun','','java.lang.String'),(17761,2778,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    log.info(\"Excel file is starting...\");\n    \n    // This is passed in from the Logic node previously\n    String finalStr = (String)nodeRunParams.getOneTimeVariable();\n    \n    if(finalStr != null) {\n        log.info(finalStr);\n    }\n    \n    RequestTrackerNode tracker = (RequestTrackerNode)getNode(\"Tracker1\");\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Saved Tests\");\n    \n    // Connects to the database and gets the node\n    runAndWait(\"Oracle\");\n    DataBaseNode dbNode = (DataBaseNode)getNode(\"Oracle\");\n    \n    // We split the string up using the commas\n    String[] menuReferenceSplit = finalStr.split(\",\");\n    Integer rowCounter = 1;\n    \n    // Little bit complicated hash map structure...\n    HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>> exportRequestData = new HashMap<>();\n    \n    // Try and load the old data if there is any\n    if(saveNode.getCustomObject(\"exportData\") != null && saveNode.getCustomObject(\"exportData\").getPayload() != null) {\n        exportRequestData = (HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>>)saveNode.getCustomObject(\"exportData\").getPayload();\n    }\n    \n    HashMap<HashMap<String, String>,LinkedHashMap<String, Object>> thisTestData = new HashMap<>();\n    \n    for(String menuReference : menuReferenceSplit) {\n        try {\n            String[] individualMenuSplit = menuReference.split(\"<\");\n            \n            SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_description, html_path from fr_menus where menu_seq_id = \" + individualMenuSplit[individualMenuSplit.length - 1]));\n        \n            String htmlPath = \"\";\n            String menuDescription = \"\";\n            for (SelectResultRow selectResultRow : selectResult.getResults()) {\n                if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n                    htmlPath = selectResultRow.getString(\"html_path\");\n                    menuDescription = selectResultRow.getString(\"menu_description\");\n                } else {\n                    htmlPath = selectResultRow.getString(\"HTML_PATH\");\n                    menuDescription = selectResultRow.getString(\"MENU_DESCRIPTION\");\n                }\n            }\n            \n            log.info(htmlPath + \" and \" + menuDescription);\n            \n            // Little bit risky but we are finding the second section of the htmlPath to get the page name\n            InputNode inputNode = (InputNode)getNode(\"Login Input\");\n            String url = inputNode.getInputByName(\"[[url]]\").getVariableValue();\n            String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n            if(htmlPath != null){ // If for some reason we cannot find this path we skip it, this can happen if the menu item has null in the database for html path\n                htmlPath = internalURL + htmlPath.split(\"\'\")[1];\n                \n                List<RecordedRequest> requestList = tracker.getRequestsByURL(htmlPath);\n        \n                // Average out the request times\n                Integer count = 0;\n                Long totalTime = 0l;\n                for(RecordedRequest recordedRequest : requestList) {\n                    totalTime += recordedRequest.getDuration();\n                    count++;\n                }\n                \n                Double averageTime = 0d;\n                if(count != 0){\n                    averageTime = totalTime.doubleValue() / count;  \n                }\n                \n                LinkedHashMap<String, Object> rowDataHash = new LinkedHashMap<>();\n                rowDataHash.put(\"averageTime\", Math.round(averageTime));\n                rowDataHash.put(\"count\",count);\n                \n                HashMap<String, String> requestDataHash = new HashMap<>();\n                requestDataHash.put(\"menuDescription\",menuDescription);\n                System.out.println(\"HTML PATH IS \" + htmlPath);\n                requestDataHash.put(\"htmlPath\",htmlPath);\n                \n                // Arrange the data correctly\n                thisTestData.put(requestDataHash, rowDataHash);\n            \n                rowCounter++;\n            } \n        } catch (Exception ex) {\n            ex.printStackTrace();\n        }\n    }\n\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n\n    // Add the data for this test 1\n    exportRequestData.put(envName, thisTestData);\n    \n    saveNode.addCustomObject(exportRequestData ,\"exportData\");\n\n    // Clean up the database connection we used\n    dbNode.getDbConnection().close();\n    \n    log.info(\"Excel data is completed\");\n    \n    // Repeat the test\n    runAndWait(\"V6 Repeater\");\n}','java.lang.String'),(17762,2778,'X','1755.0','java.lang.Double'),(17763,2778,'Id','2778','java.lang.Integer'),(17764,2778,'Y','-25.0','java.lang.Double'),(17765,2778,'ContainedText','V6 Create Export','java.lang.String'),(17766,2778,'NextNodeToRun','','java.lang.String'),(17767,2779,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(17768,2779,'FileOutputName','HSBC Websphere Blackfeather 9080Admin Test-[DATE]','java.lang.String'),(17769,2779,'X','2430.0','java.lang.Double'),(17770,2779,'Id','2779','java.lang.Integer'),(17771,2779,'Y','14.0','java.lang.Double'),(17772,2779,'ContainedText','Export','java.lang.String'),(17773,2779,'NextNodeToRun','Email Export Result','java.lang.String'),(17774,2780,'X','2311.0','java.lang.Double'),(17775,2780,'Id','2780','java.lang.Integer'),(17776,2780,'Y','152.0','java.lang.Double'),(17777,2780,'ContainedText','Saved Tests','java.lang.String'),(17778,2780,'NextNodeToRun','','java.lang.String'),(17779,2781,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Saved Tests\");\n    CustomObject savedData = saveNode.getCustomObject(\"exportData\");\n    \n    // This keep track of what requests are part of what rows, so they can be added to with subsequent tests\n    HashMap<String, Integer> requestRows = new HashMap<>();\n    \n    if(savedData != null){\n        HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>> exportRequestData = (HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>>) savedData.getPayload(); \n        \n        if(exportRequestData != null) {\n            // Have to set max size of excel output manually..\n            Export export = new Export(200,100);\n            \n            // Header row\n            export.add(new ExportValue(\"Menu\",1,0));\n            export.add(new ExportValue(\"URL\",1,1));\n            export.add(new ExportValue(\"Revision\",0,1));\n            \n            Integer testCounter = 0;\n            // Loops through the test numbers\n            for(String testName : exportRequestData.keySet()) {\n                Integer rowCounter = 2;\n                // Loops through reach request and writes the data\n                for(HashMap<String,String> requestData : exportRequestData.get(testName).keySet()) {\n                    LinkedHashMap<String, Object> rowDataHash = exportRequestData.get(testName).get(requestData);\n                    \n                    Integer columnsPerTest = 3;\n                    \n                    // Look up the row number for the current request, if it isn\'t there, we add it\n                    Integer rowNumber = requestRows.get(requestData.get(\"menuDescription\"));\n                    if(rowNumber == null) {\n                        requestRows.put(requestData.get(\"menuDescription\"), rowCounter);\n                        rowNumber = rowCounter;\n                        rowCounter++;\n                        \n                        export.add(new ExportValue(requestData.get(\"menuDescription\"), rowNumber, 0));\n                        export.add(new ExportValue(requestData.get(\"htmlPath\"), rowNumber, 1));\n                    } \n                    \n                    export.add(new ExportValue(\"Request Count\",1,2+(testCounter*columnsPerTest)));\n                    export.add(new ExportValue(\"Avg Duration (ms)\",1,3+(testCounter*columnsPerTest)));\n                    //export.add(new ExportValue(\"Change from previous test (ms)\",1,4+(testCounter*columnsPerTest)));\n                    \n                    // Adds revision number to header of test\n                    export.add(new ExportValue(testName,0,2+(testCounter*columnsPerTest)));\n                    \n                    export.add(new ExportValue(rowDataHash.get(\"averageTime\"), rowNumber, 3+(testCounter*columnsPerTest)));\n                    export.add(new ExportValue(rowDataHash.get(\"count\"), rowNumber, 2+(testCounter*columnsPerTest)));\n                    //export.add(new ExportFormula(\"OFFSET(INDIRECT(ADDRESS(ROW(),COLUMN())),0,-4)-OFFSET(INDIRECT(ADDRESS(ROW(),COLUMN())),0,-1)\", rowNumber, 4+(testCounter*columnsPerTest)));\n                }\n                testCounter++;\n            }\n           \n           \n            for (Integer row = 0; row < export.getRowCount(); row++) {\n                for (Integer col = 0; col < export.getColCount(); col++) {\n                    ExportCell exportCell = export.getValue(row, col);\n                    if (exportCell instanceof ExportValue) {\n                        ExportValue exportValue = (ExportValue) exportCell;\n                        log.info(row + \"/\" + col + \" - \" + exportValue.getDataValue());\n                    }\n                }\n            }\n           \n            InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n            ExportNode exportNode = (ExportNode)getNode(\"Export\");\n            exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Admin Test-[DATE]\");\n            export.sort(0,true,2);\n            nodeRunParams.setOneTimeVariable(export);\n\n            // Find the current output folder location\n            CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n            exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n            \n            runAndWait(\"Export\", nodeRunParams);\n            log.info(\"Excel written\");\n        } else {\n            log.info(\"No data to export!\");\n        }\n    } else {\n        log.info(\"No data to export!\");\n    }\n}\n\nprivate String getLetter(int i) {\n    return i > 0 && i < 27 ? String.valueOf((char)(i + 64)) : null;\n}','java.lang.String'),(17780,2781,'X','2313.0','java.lang.Double'),(17781,2781,'Id','2781','java.lang.Integer'),(17782,2781,'Y','14.0','java.lang.Double'),(17783,2781,'ContainedText','Write Excel','java.lang.String'),(17784,2781,'NextNodeToRun','','java.lang.String'),(17785,2782,'Test','track>trackerNode::Tracker1\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>select::default\nclick>xPath:://*[@id=\"mainmenu102\"]\nframe>select::default\nframe>id::axmorMenuContent\nwait>specificTime::1000\nwait>presence::xPath:://*[@id=\"expandallTree\"]\nclick>xPath:://*[@id=\"expandallTree\"]\n\nwait>frameLoaded::axmorMenuContent\nwait>specificTime::1000\n\nwait>presence::xPath:://*[@id=\"treeViewDiv\"]\nloop>start::adminMenus>list::tag::a>xPath:://*[@id=\"treeViewDiv\"]\n    click>loop::adminMenus\n    wait>specificTime::500\n    frame>select::default\n    wait>presence::id::content\n    wait>frameLoaded::content\n    frame>select::default\n    wait>presence::id::axmorMenuContent\n    frame>id::axmorMenuContent\nloop>end::adminMenus\n\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17786,2782,'X','2312.0','java.lang.Double'),(17787,2782,'Id','2782','java.lang.Integer'),(17788,2782,'Y','107.0','java.lang.Double'),(17789,2782,'ContainedText','Login Test','java.lang.String'),(17790,2782,'NextNodeToRun','','java.lang.String'),(17791,2783,'Logic','public void function() {\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Repeat count\");\n   \n    log.info(\"Starting to repeat..\");\n    \n    InputNode inputNode = (InputNode) getNode(\"Login Input\");\n    String cacheRepeat = inputNode.getInputByName(\"[[cacheRepeat]]\").getVariableValue();\n    String testRepeat = inputNode.getInputByName(\"[[testRepeat]]\").getVariableValue();\n    \n    Integer timesToClearCache = Integer.parseInt(cacheRepeat); // Keep in mind that before this point we have already run the selenium test once\n    Integer timesToRepeat = Integer.parseInt(testRepeat);\n    \n    // The first time we come to the repeater we start to keep track of the counter setting it to one\n    if(!(saveNode.getCustomObject(\"repeatCount\") != null && saveNode.getCustomObject(\"repeatCount\").getPayload() != null)) {\n        log.info(\"Starting counter at one!\");\n        saveNode.addCustomObject(1,\"repeatCount\");\n    }\n    \n    // Once the counter has been set we do the required action of repeat again, clear the tracker or write the excel file once finished\n    if(saveNode.getCustomObject(\"repeatCount\") != null && saveNode.getCustomObject(\"repeatCount\").getPayload() != null) {\n        Integer count = (Integer)saveNode.getCustomObject(\"repeatCount\").getPayload();\n        log.info(\"Counter is \" + count);\n        if (count < timesToClearCache) {\n            log.info(\"Repeating!!\");\n            run(\"V6 Selenium\");\n        }\n        \n        // This is the real test where timings will be collected\n        if(count >= timesToClearCache && count < timesToClearCache + timesToRepeat){\n            log.info(\"Running real test \" + (count - timesToClearCache));\n            run(\"V6 Selenium\");\n        }\n        \n        count++;\n        saveNode.addCustomObject(count,\"repeatCount\");\n        \n        if(count > timesToClearCache + timesToRepeat){ // At this point we are done with the tests for this environment\n            log.info(\"Repeater heading to write excel now\");\n            run(\"Write Excel\");\n            run(\"Admin Log Logic\");\n        }\n    } \n}','java.lang.String'),(17792,2783,'X','1904.0','java.lang.Double'),(17793,2783,'Id','2783','java.lang.Integer'),(17794,2783,'Y','-25.0','java.lang.Double'),(17795,2783,'ContainedText','V6 Repeater','java.lang.String'),(17796,2783,'NextNodeToRun','','java.lang.String'),(17797,2784,'X','2310.0','java.lang.Double'),(17798,2784,'Id','2784','java.lang.Integer'),(17799,2784,'Y','198.0','java.lang.Double'),(17800,2784,'ContainedText','Repeat count','java.lang.String'),(17801,2784,'NextNodeToRun','','java.lang.String'),(17802,2785,'Logic','public void function() {\n    CustomObjectNode repeatCount = (CustomObjectNode)getNode(\"Repeat count\");\n    repeatCount.deleteCustomObject(\"repeatCount\");\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Saved Tests\");\n    saveNode.deleteCustomObject(\"exportData\");\n    RequestTrackerNode requestNode = (RequestTrackerNode)getNode(\"Tracker1\");\n    requestNode.clearAllRequests();\n    log.info(\"Count, Export Data and Request Tracker reset\");\n}','java.lang.String'),(17803,2785,'X','1782.0','java.lang.Double'),(17804,2785,'Id','2785','java.lang.Integer'),(17805,2785,'Y','148.0','java.lang.Double'),(17806,2785,'ContainedText','Reset','java.lang.String'),(17807,2785,'NextNodeToRun','','java.lang.String'),(17808,2786,'X','2310.0','java.lang.Double'),(17809,2786,'Id','2786','java.lang.Integer'),(17810,2786,'Y','338.0','java.lang.Double'),(17811,2786,'ContainedText','Environment Name','java.lang.String'),(17812,2786,'NextNodeToRun','','java.lang.String'),(17813,2787,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    log.info(\"Excel file is starting...\");\n    \n    // This is passed in from the Logic node previously\n    String finalStr = (String)nodeRunParams.getOneTimeVariable();\n    \n    if(finalStr != null) {\n        log.info(finalStr);\n    }\n    \n    RequestTrackerNode tracker = (RequestTrackerNode)getNode(\"Tracker1\");\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Saved Tests\");\n    \n    // Connects to the database and gets the node\n    runAndWait(\"Oracle\");\n    DataBaseNode dbNode = (DataBaseNode)getNode(\"Oracle\");\n    \n    // We split the string up using the commas\n    String[] menuReferenceSplit = finalStr.split(\",\");\n    Integer rowCounter = 1;\n    \n    // Little bit complicated hash map structure...\n    HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>> exportRequestData = new HashMap<>();\n    \n    // Try and load the old data if there is any\n    if(saveNode.getCustomObject(\"exportData\") != null && saveNode.getCustomObject(\"exportData\").getPayload() != null) {\n        exportRequestData = (HashMap<String,HashMap<HashMap<String,String>, LinkedHashMap<String, Object>>>)saveNode.getCustomObject(\"exportData\").getPayload();\n    }\n    \n    HashMap<HashMap<String, String>,LinkedHashMap<String, Object>> thisTestData = new HashMap<>();\n    \n    for(String menuReference : menuReferenceSplit) {\n        try {\n            String[] individualMenuSplit = menuReference.split(\"<\");\n            \n            SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_name, menu_description, html_path from fr_menus where menu_seq_id = \" + individualMenuSplit[individualMenuSplit.length - 1]));\n        \n            String htmlPath = \"\";\n            String menuDescription = \"\";\n            for (SelectResultRow selectResultRow : selectResult.getResults()) {\n                if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n                    htmlPath = selectResultRow.getString(\"menu_name\");\n                    menuDescription = selectResultRow.getString(\"menu_description\");\n                } else {\n                    htmlPath = selectResultRow.getString(\"MENU_NAME\");\n                    menuDescription = selectResultRow.getString(\"MENU_DESCRIPTION\");\n                }\n            }\n            \n            log.info(htmlPath + \" and \" + menuDescription);\n            \n            // Little bit risky but we are finding the second section of the htmlPath to get the page name\n            InputNode inputNode = (InputNode)getNode(\"Login Input\");\n            String url = inputNode.getInputByName(\"[[url]]\").getVariableValue();\n            String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n            if(htmlPath != null){ // If for some reason we cannot find this path we skip it, this can happen if the menu item has null in the database for html path\n                \n                if (\"Allocations\".equals(htmlPath)) {\n                    htmlPath = \"AllocationSingle\";    \n                } else if (\"Market Data\".equals(htmlPath)) {\n                    htmlPath = \"adminMarketData\";       \n                } else if (\"SystemValues\".equals(htmlPath)) {\n                    htmlPath = \"CompFrequencies\";       \n                } else if (\"ImportLog\".equals(htmlPath)) {\n                    htmlPath = \"ImportsLog\";       \n                } else if (\"Dates\".equals(htmlPath)) {\n                    htmlPath = \"RoleDates\";       \n                } else if (\"PurgeMaintenance\".equals(htmlPath)) {\n                    htmlPath = \"PurgeMaint\";       \n                } else if (\"Deferral\".equals(htmlPath)) {\n                    htmlPath = \"deferralActDisp\";       \n                } else if (\"StatementsArchiveMaintenance\".equals(htmlPath)) {\n                    htmlPath = \"ArchiveMaint\";\n                } else if (\"AnnualArchiveMaintenance\".equals(htmlPath)) {\n                    htmlPath = \"AdvanceArchiveMaint\";    \n                } else if (\"CompFrequencies\".equals(htmlPath)) {\n                    htmlPath = \"CompFrequenciesView\";       \n                } else if (\"ReportsController\".equals(htmlPath)) {\n                    htmlPath = \"ReportController\";       \n                } else if (\"LookupValues\".equals(htmlPath)) {\n                    htmlPath = \"ShowLookupTypes\";       \n                } else if (\"HierarchyUsers\".equals(htmlPath)) {\n                    htmlPath = \"Users\";       \n                } else if (\"AwardTypes\".equals(htmlPath)) {\n                    htmlPath = \"BonusTypes\";       \n                } else if (\"ChargeProfile\".equals(htmlPath)) {\n                    htmlPath = \"AdminChargeProfile\";       \n                } else if (\"IncentivePlans\".equals(htmlPath)) {\n                    htmlPath = \"IncentivePlansView\";       \n                } else if (\"AwardTypesVestingRules\".equals(htmlPath)) {\n                    htmlPath = \"VestingPlanBonusTypes\";       \n                } else if (\"HierarchyDepartments\".equals(htmlPath)) {\n                    htmlPath = \"HierarchyBuilder\";       \n                }\n                \n                htmlPath = internalURL + htmlPath;\n\n                List<RecordedRequest> requestList = tracker.getRequestsByURL(htmlPath);\n        \n                // Average out the request times\n                Integer count = 0;\n                Long totalTime = 0l;\n                for(RecordedRequest recordedRequest : requestList) {\n                    totalTime += recordedRequest.getDuration();\n                    count++;\n                }\n                \n                Double averageTime = 0d;\n                if(count != 0){\n                    averageTime = totalTime.doubleValue() / count;  \n                }\n                log.info(\"Average time for \" + htmlPath + \" is \" + averageTime);\n                \n                LinkedHashMap<String, Object> rowDataHash = new LinkedHashMap<>();\n                rowDataHash.put(\"averageTime\", Math.round(averageTime));\n                rowDataHash.put(\"count\",count);\n                \n                HashMap<String, String> requestDataHash = new HashMap<>();\n                requestDataHash.put(\"menuDescription\",menuDescription);\n                requestDataHash.put(\"htmlPath\",htmlPath);\n                \n                // Arrange the data correctly\n                thisTestData.put(requestDataHash, rowDataHash);\n            \n                rowCounter++;\n            } \n        } catch (Exception ex) {\n            log.error(\"Error in HSBC create report\",ex);\n        }\n    }\n\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n\n    // Add the data for this test 1\n    exportRequestData.put(envName, thisTestData);\n    \n    saveNode.addCustomObject(exportRequestData ,\"exportData\");\n\n    // Clean up the database connection we used\n    dbNode.getDbConnection().close();\n    \n    log.info(\"Excel data is completed\");\n    \n    // Repeat the test\n    runAndWait(\"HSBC Repeater\");\n}','java.lang.String'),(17814,2787,'X','1767.0','java.lang.Double'),(17815,2787,'Id','2787','java.lang.Integer'),(17816,2787,'Y','302.0','java.lang.Double'),(17817,2787,'ContainedText','HSBC Create Export','java.lang.String'),(17818,2787,'NextNodeToRun','','java.lang.String'),(17819,2788,'Test','track>trackerNode::Tracker1\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>select::default\nclick>id::mainmenu4\nwait>frameLoaded::content\n\n[[admincode]]\n\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nwait>finishAllRequests::60000\nexit>','java.lang.String'),(17820,2788,'X','2312.0','java.lang.Double'),(17821,2788,'Id','2788','java.lang.Integer'),(17822,2788,'Y','60.0','java.lang.Double'),(17823,2788,'ContainedText','HSBC Logic','java.lang.String'),(17824,2788,'NextNodeToRun','','java.lang.String'),(17825,2789,'Logic','private String finalStr = \"\";\nprivate DataBaseNode dbNode;\n\npublic void function() {\n    // Get the nodes we need\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    InputNode envNameInputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = envNameInputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode testsToRun = (DataTableNode)getNode(\"Tests to run\");\n    List<DataTableRow> testsToRunList = testsToRun.getDataTableRows();\n    \n    Boolean runTest = false;\n    for(DataTableRow test : testsToRunList){\n        HashMap<String, DataTableValue> testData = test.getDataTableValues();\n        \n        if(envName.equals(testData.get(\"EnvName\").getDataValue())){\n            if(\"Y\".equals(testData.get(\"Admin Pages\").getDataValue())){\n                runTest = true;\n                break;\n            } \n        }\n    }\n    \n    if(runTest){\n        TestNode testNode = (TestNode)getNode(\"HSBC Logic\");\n        \n        // Init DB and get the node\n        runAndWait(\"Oracle\");\n        dbNode = (DataBaseNode)getNode(\"Oracle\");\n        \n        // This gets the main root admin menu\n        adminMenuId = findAdminMenuId(\"Admin\");\n    \n        // This gets the import menu, we need to avoid this as while these are within the admin menu tree they are hard coded to not display, so we shouldn\'t be looking for them\n        //String importMenuId = findAdminMenuId(\"ImportMenuMainPage\");\n        \n        // This gets the annual import menu, we need to do the same as the above import menu for this as well\n        String annualImportMenuId = findAdminMenuId(\"AnnualImport\");\n        \n        String archiveMaintMenuId = findAdminMenuId(\"Archive Maint\");\n        \n        // Get all the menu references from the database\n        finalStr = \"\"; // Set to blank in case we have something left over from a previous test\n        createMenuReference(adminMenuId,\"\"); // The menu id here is the top level menu we want to test all the children of\n        //createMenuReference(archiveMaintMenuId,\"\"); // Fast test menu\n    \n        finalStr = finalStr.substring(0,finalStr.length() - 1); // Remove the trailing comma\n        \n        String[] menuReferenceSplit = finalStr.split(\",\");\n        \n        log.info(annualImportMenuId);\n        log.info(\"FINAL \" + finalStr);\n        \n        // Generate the script to run selenium looping through all the menu references we have created\n        String generatedCode = \"\";\n        for(String menuReference : menuReferenceSplit){\n            log.info(\"Checking \" + menuReference);\n            if(!menuReference.contains(\"<\"+annualImportMenuId)){ // If the menu reference makes use of the import menu we don\'t want, skip it\n               generatedCode += testAdminPage(menuReference); \n            } else {\n                log.info(\"Skipped \" + menuReference);\n            }\n        }\n        \n        log.info(\"Generated code is \" + generatedCode);\n        \n        // Apply the inputs and run the test\n        inputNode.setInputsByName(\"[[admincode]]\",generatedCode);\n        nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n        \n        // Tidy up our database connection\n        dbNode.getDbConnection().close();\n        \n        // Run the selenium test\n        runAndWait(\"HSBC Logic\", nodeRunParams);\n        // Run the logic to output excel file\n        nodeRunParams.setOneTimeVariable(finalStr);\n        log.info(\"About to hand over to export\");\n        runAndWait(\"HSBC Create Export\", nodeRunParams);\n    } else {\n        run(\"Popup Setup\");\n    }\n}\n\npublic String createMenuReference(String menuSeqId, String pathSoFar) {\n    String thisPath = \"\";\n    \n    // We add this menu onto the path we are already creating, but not the first time when the path is already blank\n    if(pathSoFar.equals(\"\")){\n        thisPath = menuSeqId;\n    } else {\n        thisPath = pathSoFar + \"<\" + menuSeqId;\n    }\n    \n    // Query to find the children menu items of the current menu\n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_seq_id from fr_menus where parent_menu_seq_id = \" + menuSeqId));\n\n    Boolean bottomMenu = true;\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        String menuReference = \"\";\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuReference = selectResultRow.getLong(\"menu_seq_id\").toString();\n        } else {\n            menuReference = selectResultRow.getBigDecimal(\"MENU_SEQ_ID\").toString();\n        }\n        \n        createMenuReference(menuReference,thisPath);\n        bottomMenu = false;\n    }\n    \n    // If we have reached the bottom of the menu chain it is time to record the path we used to get here\n    if(bottomMenu) {\n        // We don\'t want to include menus which have no html path set as these are not value menus\n        selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select html_path from fr_menus where menu_seq_id = \" + menuSeqId));\n        \n        Boolean hasPath = false;\n        for (SelectResultRow selectResultRow : selectResult.getResults()) {\n            hasPath = true;\n        }\n        \n        // If it has an html path we add it to the rest of the final string\n        if(hasPath) {\n           finalStr += pathSoFar + \"<\" + menuSeqId + \",\"; \n        } else {\n            log.info(\"Skipping \" + menuSeqId + \" as no path\");\n        }\n    }\n    \n    return thisPath;\n}\n\npublic String findAdminMenuId(String menuName){\n    String menuId = \"\";\n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_seq_id from fr_menus where menu_name = \'\" + menuName + \"\'\"));\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuId = selectResultRow.getLong(\"menu_seq_id\").toString();\n        } else {\n            menuId = selectResultRow.getBigDecimal(\"MENU_SEQ_ID\").toString();\n        }\n    }\n    \n    return menuId;\n}\n\npublic String findAdminMenuName(String menuId){\n    String menuName = \"\";\n    \n    SelectResult selectResult = DataBank.runSelectQuery(dbNode.getDbConnection(), new SelectQuery(\"select menu_name from fr_menus where menu_seq_id = \" + menuId + \"\"));\n    for (SelectResultRow selectResultRow : selectResult.getResults()) {\n        if(dbNode.getConnectionString().contains(\"mysql\")){ // This is different between mysql and oracle\n            menuName = selectResultRow.getString(\"menu_name\").toString();\n        } else {\n            menuName = selectResultRow.getString(\"MENU_NAME\").toString();\n        }\n    }\n    \n    return menuName;\n}\n\nprivate String adminMenuId = \"\";\nprivate String currentSecondLevelMenu = \"\";\npublic String testAdminPage(String menuReference) {\n    String[] splitMenu = menuReference.split(\"<\");\n    String returnString = \"\";\n    \n    Boolean secondLevelMenu = false;\n    if(splitMenu.length == 2){\n       secondLevelMenu = true; \n    }\n    \n    for(int i = 0;i < splitMenu.length - 1;i++) {\n        String menuName = findAdminMenuName(splitMenu[i]);\n        log.info(\"Looking at \" + menuReference + \" - \" + splitMenu[i] + \" - \" + menuName);\n        if(!splitMenu[i].equals(adminMenuId)){ // The admin menu will always be open so we don\'t ever need to add this\n            String menuNameSecond = findAdminMenuName(splitMenu[i]);\n            String menuNameThird = findAdminMenuName(splitMenu[i + 1]);\n            if(!splitMenu[i].equals(currentSecondLevelMenu)){ // This means we need to change the second level menu item onto the next thing\n                returnString += \"wait>presence::xPath:://*[@id=\\\"\" + menuNameSecond +\"\\\"]\" + \"\\r\\n\";\n                returnString += \"click>xPath:://*[@id=\\\"\" + menuNameSecond +\"\\\"]\" + \"\\r\\n\";\n                returnString += \"wait>specificTime::1500\" + \"\\r\\n\";\n                returnString += \"frame>frameLoaded::content\" + \"\\r\\n\"; // Wait for the frame to be loaded\n                currentSecondLevelMenu = splitMenu[i];\n            }\n            \n            returnString += \"wait>presence::xPath:://*[@id=\\\"\" + \"empSummaryBanner\" + \"\\\"]\" + \"\\r\\n\";\n            returnString += \"frame>frameLoaded::empSummaryBanner\" + \"\\r\\n\";\n            returnString += \"frame>id::empSummaryBanner\" + \"\\r\\n\";\n            returnString += \"wait>presence::xPath:://*[@id=\\\"\" + menuNameThird +\"\\\"]\" + \"\\r\\n\";\n            returnString += \"click>xPath:://*[@id=\\\"\" + menuNameThird +\"\\\"]\" + \"\\r\\n\";\n            returnString += \"wait>specificTime::1500\" + \"\\r\\n\";\n            returnString += \"frame>select::default\" + \"\\r\\n\";\n            returnString += \"frame>frameLoaded::content\" + \"\\r\\n\"; // Wait for the frame to be loaded\n        }\n        \n        // This is for if the menu has no children\n        if(secondLevelMenu){\n            String menuNameSecond = findAdminMenuName(splitMenu[i + 1]);\n            returnString += \"wait>presence::xPath:://*[@id=\\\"\" + menuNameSecond +\"\\\"]\" + \"\\r\\n\";\n            returnString += \"click>xPath:://*[@id=\\\"\" + menuNameSecond +\"\\\"]\" + \"\\r\\n\";\n            returnString += \"wait>specificTime::1500\" + \"\\r\\n\";\n            returnString += \"frame>frameLoaded::content\" + \"\\r\\n\"; // Wait for the frame to be loaded\n            currentSecondLevelMenu = splitMenu[i];\n        }\n    }\n    \n    return returnString;\n}','java.lang.String'),(17826,2789,'X','1636.0','java.lang.Double'),(17827,2789,'Id','2789','java.lang.Integer'),(17828,2789,'Y','301.0','java.lang.Double'),(17829,2789,'ContainedText','HSBC Selenium','java.lang.String'),(17830,2789,'NextNodeToRun','','java.lang.String'),(17831,2790,'Logic','public void function() {\n    CustomObjectNode saveNode = (CustomObjectNode)getNode(\"Repeat count\");\n   \n    log.info(\"Starting to repeat..\");\n   \n    InputNode inputNode = (InputNode) getNode(\"Login Input\");\n    String cacheRepeat = inputNode.getInputByName(\"[[cacheRepeat]]\").getVariableValue();\n    String testRepeat = inputNode.getInputByName(\"[[testRepeat]]\").getVariableValue();\n    \n    Integer timesToClearCache = Integer.parseInt(cacheRepeat); // Keep in mind that before this point we have already run the selenium test once\n    Integer timesToRepeat = Integer.parseInt(testRepeat);\n    \n    // The first time we come to the repeater we start to keep track of the counter setting it to one\n    if(!(saveNode.getCustomObject(\"repeatCount\") != null && saveNode.getCustomObject(\"repeatCount\").getPayload() != null)) {\n        log.info(\"Starting counter at one!\");\n        saveNode.addCustomObject(1,\"repeatCount\");\n    }\n    \n    // Once the counter has been set we do the required action of repeat again, clear the tracker or write the excel file once finished\n    if(saveNode.getCustomObject(\"repeatCount\") != null && saveNode.getCustomObject(\"repeatCount\").getPayload() != null) {\n        Integer count = (Integer)saveNode.getCustomObject(\"repeatCount\").getPayload();\n        log.info(\"Counter is \" + count);\n        if (count < timesToClearCache) {\n            log.info(\"Repeating!!\");\n            run(\"HSBC Selenium\");\n        } \n        \n        // This is the real test where timings will be collected\n        if(count >= timesToClearCache && count < timesToClearCache + timesToRepeat){\n            log.info(\"Running real test \" + (count - timesToClearCache));\n            run(\"HSBC Selenium\");\n        }\n        \n        count++;\n        saveNode.addCustomObject(count,\"repeatCount\");\n        \n        if(count > timesToClearCache + timesToRepeat){ // At this point we are done with the tests for this environment\n            log.info(\"Repeater heading to write excel now\");\n            run(\"Write Excel\");\n            run(\"Admin Log Logic\");\n        }\n    } \n}','java.lang.String'),(17832,2790,'X','1935.0','java.lang.Double'),(17833,2790,'Id','2790','java.lang.Integer'),(17834,2790,'Y','302.0','java.lang.Double'),(17835,2790,'ContainedText','HSBC Repeater','java.lang.String'),(17836,2790,'NextNodeToRun','','java.lang.String'),(17837,2791,'Logic','public void function() {\n    log.info(\"Running the test\");\n    \n    SwitchNode switchNode = (SwitchNode)getNode(\"Environment Select\");\n    List<Switch> aSwitches = switchNode.getSwitches();\n    \n    String envNames = \"\\r\\n\";\n    \n    for(Switch aSwitch : aSwitches){\n        if(aSwitch.isEnabled()){\n           envNames += \"\\r\\n \" + aSwitch.getTarget(); \n        }\n    }\n        \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Starting test\")\n        .content(\"Starting SDE test for: \" + envNames)\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Start\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n        \n    run(\"Setup Envs\");\n    run(\"Schedule\");\n}','java.lang.String'),(17838,2791,'X','407.0','java.lang.Double'),(17839,2791,'Id','2791','java.lang.Integer'),(17840,2791,'Y','92.0','java.lang.Double'),(17841,2791,'ContainedText','Start Here','java.lang.String'),(17842,2791,'NextNodeToRun','','java.lang.String'),(17843,2792,'X','987.0','java.lang.Double'),(17844,2792,'Id','2792','java.lang.Integer'),(17845,2792,'Y','-25.0','java.lang.Double'),(17846,2792,'ContainedText','Environment Select','java.lang.String'),(17847,2792,'NextNodeToRun','','java.lang.String'),(17848,2793,'X','1129.0','java.lang.Double'),(17849,2793,'Id','2793','java.lang.Integer'),(17850,2793,'Y','170.0','java.lang.Double'),(17851,2793,'ContainedText','Envs to run','java.lang.String'),(17852,2793,'NextNodeToRun','','java.lang.String'),(17853,2794,'MilliSecsWait','2000','java.lang.Integer'),(17854,2794,'FrequencyDurationCount','','java.lang.String'),(17855,2794,'FrequencyDuration','','java.lang.String'),(17856,2794,'Frequency','Once','java.lang.String'),(17857,2794,'Repetition','','java.lang.String'),(17858,2794,'StartDateYear','0','java.lang.Integer'),(17859,2794,'StartDateMonth','0','java.lang.Integer'),(17860,2794,'StartDateDay','0','java.lang.Integer'),(17861,2794,'StartTime','','java.lang.String'),(17862,2794,'EndDateYear','0','java.lang.Integer'),(17863,2794,'EndDateMonth','0','java.lang.Integer'),(17864,2794,'EndDateDay','0','java.lang.Integer'),(17865,2794,'EndTime','','java.lang.String'),(17866,2794,'RepetitionCount','','java.lang.String'),(17867,2794,'StartChoice','Instantly','java.lang.String'),(17868,2794,'X','662.0','java.lang.Double'),(17869,2794,'Id','2794','java.lang.Integer'),(17870,2794,'Y','341.0','java.lang.Double'),(17871,2794,'ContainedText','Schedule','java.lang.String'),(17872,2794,'NextNodeToRun','Test Controller','java.lang.String'),(17873,2795,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    DataBaseNode databaseNode = (DataBaseNode)getNode(\"Oracle\");\n    InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    InputNode loginInput = (InputNode)getNode(\"Login Input\");\n    \n    CustomObjectNode envCounterNode = (CustomObjectNode)getNode(\"Env Counter\");\n    CustomObjectNode envsToRun = (CustomObjectNode)getNode(\"Envs to run\");\n    List<HashMap<String, String>> environments = (List<HashMap<String, String>>) envsToRun.getCustomObject(\"envs\").getPayload();\n    Integer envCounter = (Integer) envCounterNode.getCustomObject(\"envCounter\").getPayload();\n    \n    // Each time the script loops around this if statement moves onto the next environment to test and starts again until we have tested all environments\n    if(envCounter < environments.size()){\n        HashMap<String, String> envInfo = environments.get(envCounter);\n        \n        databaseNode.setUsername(envInfo.get(\"DBUsername\"));\n        databaseNode.setPassword(envInfo.get(\"DBPassword\"));\n        databaseNode.setConnectionString(envInfo.get(\"DBConnection\"));\n        environmentName.getInputByName(\"EnvName\").setVariableValue(envInfo.get(\"EnvName\"));\n        loginInput.getInputByName(\"[[url]]\").setVariableValue(envInfo.get(\"URL\"));\n        loginInput.getInputByName(\"[[internalurl]]\").setVariableValue(envInfo.get(\"InternalURL\"));\n        loginInput.getInputByName(\"[[cacheRepeat]]\").setVariableValue(envInfo.get(\"CacheRepeat\"));\n        loginInput.getInputByName(\"[[testRepeat]]\").setVariableValue(envInfo.get(\"TestRepeat\"));\n        loginInput.getInputByName(\"((username))\").setVariableValue(envInfo.get(\"AppUsername\"));\n        loginInput.getInputByName(\"((password))\").setVariableValue(envInfo.get(\"AppPassword\"));\n        loginInput.getInputByName(\"[[testEmployee]]\").setVariableValue(envInfo.get(\"TestEmployee\"));\n        loginInput.getInputByName(\"[[logTimeZone]]\").setVariableValue(envInfo.get(\"LogTimeZone\"));\n        loginInput.getInputByName(\"[[logReportId]]\").setVariableValue(envInfo.get(\"LogReportId\"));\n        \n        log.info(\"Running \" + envInfo.get(\"EnvName\"));\n        \n        runAndWait(\"Reset\");\n        if(\"V6\".equals(envInfo.get(\"CodeLine\"))) {\n            runAndWait(\"V6 Selenium\");\n        } else if(\"HSBC\".equals(envInfo.get(\"CodeLine\"))){\n            runAndWait(\"HSBC Selenium\");\n        }\n    } else {\n        CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n        log.info(\"Trying to zip \" + fileLocation.getCustomObject(\"outputFolder\").getPayload());\n        \n        SDEUtils.zipDirectory((String)fileLocation.getCustomObject(\"outputFolder\").getPayload(),(String)fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/../TestResults.zip\");\n        \n        DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n        List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n        \n        EmailMessage emailMessage = new EmailMessage()\n            .from(\"SDE@spl.com\")\n            .username(\"alex@spl.com\")\n            .password(\"4o%2!oqZ#On!tepv111!\")\n            .subject(\"SDE3 - All Results\")\n            .attach(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/../TestResults.zip\")\n            .content(\"Nothing goes here\")\n            .protocol(\"imaps\")\n            .host(\"mail.spl.com\")\n            .port(\"587\");\n        \n        for(DataTableRow dataTableRow : dataTableRowList){\n            HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n            \n            if(\"Y\".equals(dataTableRowData.get(\"Zipped\").getDataValue())){\n                emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n            }\n        }\n    \n        emailMessage.send();\n        \n        log.info(\"All test completed!\"); \n    }\n    \n    envCounter++;\n    envCounterNode.addCustomObject(envCounter,\"envCounter\");\n}','java.lang.String'),(17874,2795,'X','1361.0','java.lang.Double'),(17875,2795,'Id','2795','java.lang.Integer'),(17876,2795,'Y','339.0','java.lang.Double'),(17877,2795,'ContainedText','Test Controller','java.lang.String'),(17878,2795,'NextNodeToRun','','java.lang.String'),(17879,2796,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    // Clear our any old data first\n    CustomObjectNode envsToRun = (CustomObjectNode)getNode(\"Envs to run\");\n    CustomObjectNode envCounter = (CustomObjectNode)getNode(\"Env Counter\");\n    CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n    envsToRun.deleteCustomObject(\"envs\");\n    envCounter.deleteCustomObject(\"envCounter\");\n    fileLocation.deleteCustomObject(\"outputFolder\");\n   \n    // Create a new fresh list ready to be used\n    List<HashMap<String, String>> environments = new ArrayList();\n    envsToRun.addCustomObject(environments,\"envs\");\n    envCounter.addCustomObject(0,\"envCounter\");\n    \n    // Output folder\n    ExportNode defaultExportNode = (ExportNode)getNode(\"Output Directory\");\n    defaultExportNode.buildConstructedFileName();\n    String fileLocationStr = new String(defaultExportNode.getConstructedDirectory());\n    log.info(\"Output directory = \" + fileLocationStr);\n    fileLocation.addCustomObject(fileLocationStr,\"outputFolder\");\n    run(\"Process Env Info\");\n}','java.lang.String'),(17880,2796,'X','620.0','java.lang.Double'),(17881,2796,'Id','2796','java.lang.Integer'),(17882,2796,'Y','93.0','java.lang.Double'),(17883,2796,'ContainedText','Setup Envs','java.lang.String'),(17884,2796,'NextNodeToRun','','java.lang.String'),(17885,2797,'X','1131.0','java.lang.Double'),(17886,2797,'Id','2797','java.lang.Integer'),(17887,2797,'Y','229.0','java.lang.Double'),(17888,2797,'ContainedText','Env Counter','java.lang.String'),(17889,2797,'NextNodeToRun','','java.lang.String'),(17890,2798,'Logic','public void function() {\n    InputNode envNameInputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = envNameInputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode testsToRun = (DataTableNode)getNode(\"Tests to run\");\n    List<DataTableRow> testsToRunList = testsToRun.getDataTableRows();\n    \n    Boolean runTest = false;\n    for(DataTableRow test : testsToRunList){\n        HashMap<String, DataTableValue> testData = test.getDataTableValues();\n        \n        if(envName.equals(testData.get(\"EnvName\").getDataValue())){\n            if(\"Y\".equals(testData.get(\"Worksheet Popups\").getDataValue())){\n                runTest = true;\n                break;\n            } \n        }\n    }\n    \n    if(runTest){\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        TestNode testNode = (TestNode)getNode(\"Worksheet\");\n        \n        nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n        \n        runAndWait(\"Worksheet\", nodeRunParams);\n    } else {\n        runAndWait(\"Perf Setup\");\n    }\n}','java.lang.String'),(17891,2798,'X','1584.0','java.lang.Double'),(17892,2798,'Id','2798','java.lang.Integer'),(17893,2798,'Y','-309.0','java.lang.Double'),(17894,2798,'ContainedText','Popup Setup','java.lang.String'),(17895,2798,'NextNodeToRun','','java.lang.String'),(17896,2799,'Test','// Logging in\ntrack>trackerNode::Tracker1\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Search for employee id we are testing against and then go to worksheet via search results\nframe>select::default\nwait>presence::id::searchInput\ninput>id::searchInput>value::[[testEmployee]]>characterDelay::100\nwait>presence::id::GoImage\nclick>id::GoImage\nwait>specificTime::1000\nwait>presence::xPath:://*[@id=\"searchResultsDiv\"]\nloop>start::searchResult>list::tag::a>xPath:://*[@id=\"searchResultsDiv\"]\n    if>start::clickResult>loop::searchResult>attribute::id>contains::searchPopup\n        click>loop::searchResult\n    if>end::clickResult\n    if>start::clickResult>loop::searchResult>attribute::href>contains::ProcessWorksheetFunctions\n        click>loop::searchResult\n    if>end::clickResult\nloop>end::searchResult\nwait>specificTime::1000\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\n\n// Looping through worksheet rows and columns\nloop>start::row>list::tag::td>xPath:://*[@id=\"row0\"]\n    // These are for inputs which open popups\n    loop>start::cell>list::tag::input>loop::row\n        call>function::testPopup\n    loop>end::cell\n\n    // This is for a tags which open popups\n    loop>start::cell>list::tag::a>loop::row\n        call>function::testPopup\n    loop>end::cell\nloop>end::row\n\nfunction>start::testPopup\n    if>start::ifReference>loop::cell>attribute::onclick>contains::_actionCallbackINPUT\n        click>loop::cell\n        // Waiting for the popup to open\n        wait>specificTime::2000\n        \n        // Loop through all popups and if they are open close them\n        frame>select::default\n        loop>start::popup>list::tag::div>xPath:://*[@id=\"indexLaptop\"]>direct::true\n            if>start::classCheck>loop::popup>class::true>contains::ui-dialog\n                if>start::visible>loop::popup>attribute::style>contains::block\n                    // Close the popup here\n                    loop>start::spanPress>list::tag::span>loop::popup\n                        if>start::buttonCheck>loop::spanPress>class::true>contains::ui-icon-closethick\n                            click>loop::spanPress\n                        if>end::buttonCheck\n                    loop>end::spanPress\n                if>end::visible\n            if>end::classCheck\n        loop>end::popup\n        wait>frameLoaded::frame::content\n        frame>id::content\n    if>end::ifReference\nfunction>end::testPopup\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nwait>finishAllRequests::60000\nexit>','java.lang.String'),(17897,2799,'X','1711.0','java.lang.Double'),(17898,2799,'Id','2799','java.lang.Integer'),(17899,2799,'Y','-309.0','java.lang.Double'),(17900,2799,'ContainedText','Worksheet','java.lang.String'),(17901,2799,'NextNodeToRun','Popup Log Logic','java.lang.String'),(17902,2800,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Export\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Admin Menu Times - \" + envName)\n        .content(\"No content\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Admin\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(17903,2800,'X','2518.0','java.lang.Double'),(17904,2800,'Id','2800','java.lang.Integer'),(17905,2800,'Y','14.0','java.lang.Double'),(17906,2800,'ContainedText','Email Export Result','java.lang.String'),(17907,2800,'NextNodeToRun','','java.lang.String'),(17908,2801,'Test','track>trackerNode::TrackLog\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\nloop>start::reports>list::tag::a>xPath:://*[@id=\"pageLeftLargeMenu\"]\n    click>loop::reports\n    wait>specificTime::500\n    wait>presence::id::reportPageIframe\n    wait>frameLoaded::frame::reportPageIframe\n    frame>id::reportPageIframe\n    wait>presence::id::runReportButton\n    \n    if>start::multiEmployee>id::multiEmployeeId>elementExists::true\n        input>id::multiEmployeeId>value::[[testEmployee]]\n    if>end::multiEmployee\n    \n    // This is for HSBC Management Summary report\n    if>start::selectRegion>id::region>elementExists::true\n        select>id::region>select::Europe\n    if>end::selectRegion\n    \n    click>id::runReportButton\n    wait>specificTime::500\n    wait>finishAllRequests::60000\n    frame>select::default\n    wait>presence::id::content\n    wait>frameLoaded::frame::content\n    frame>id::content\n    wait>presence::id::pageLeftLargeMenu\nloop>end::reports\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17909,2801,'X','1696.0','java.lang.Double'),(17910,2801,'Id','2801','java.lang.Integer'),(17911,2801,'Y','-605.0','java.lang.Double'),(17912,2801,'ContainedText','Run Reports','java.lang.String'),(17913,2801,'NextNodeToRun','Report Log Logic','java.lang.String'),(17914,2802,'Logic','public void function() {\n   RequestTrackerNode trackerNode = (RequestTrackerNode)getNode(\"TrackLog\");\n   InputNode inputNode = (InputNode)getNode(\"Login Input\");\n   \n    InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n   \n    // Raw Excel output\n    ExportNode exportNode = (ExportNode)getNode(\"Report Excel Log\");\n    exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Report Test Log-[DATE]\");\n    exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n    \n    // Trimmed Excel output   \n    ExportNode exportNodeTrimmed = (ExportNode)getNode(\"Report Excel Log Trimmed\");\n    exportNodeTrimmed.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Report Test Log Trimmed-[DATE]\");\n    exportNodeTrimmed.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n   \n   String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n   \n   List<RecordedRequest> logList = trackerNode.getRequestsByURL(internalURL + \"ReportController\");\n   \n   LinkedHashMap<LogMessage, RecordedRequest> requestMapping = new LinkedHashMap<>();\n   LinkedHashMap<LogMessage, RecordedRequest> errorMapping = new LinkedHashMap<>();\n   \n   log.info(\"Report Controllers = \" + logList.size());\n   log.info(\"Internal url is \" + internalURL);\n   for(RecordedRequest recordedRequest : logList){\n       if(recordedRequest.getResponse().contains(\"LogFile:\")){\n            List<LogMessage> messageList = decodeLog(recordedRequest.getResponse());\n            \n            RecordedRequest matchedRequest = null;\n            RecordedRequest matchedEnterRequest = null;\n            Integer timeDifference = Integer.MAX_VALUE;\n            Integer timeDifferenceEnterRequest = Integer.MAX_VALUE;\n            //log.info(\"Log messages = \" + messageList.size());\n            for(LogMessage message : messageList){\n                //log.info(message.getRawLog());\n                //log.info(\"Is page \" + message.isPageMessage() + \" isEnter \" + message.isEnter());\n                if(message.isPageMessage() && !message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    //log.info(\"We have a leave\");\n                    \n                    List<RecordedRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifference = Integer.MAX_VALUE;\n                    \n                    //log.info(\"**** \" + messagePageURL);\n                    for(RecordedRequest recordedRequest2 : messagePage) {\n                        //log.info(\"Request thing is \" + webProxyRequest2.getRequestURL());\n                        if(message.getTime() != null && recordedRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),recordedRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            //log.info(\"Old \" + timeDifference + \" diff \" + secondsDifference);\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifference)){\n                                timeDifference = secondsDifference;\n                                matchedRequest = recordedRequest2;\n                            }\n                        }\n                    }\n                    if(matchedRequest != null && Math.abs(timeDifference) < 30){\n                        //log.info(\"Added \" + message.getRawLog() + \" to \" + matchedRequest.getRequestURL());\n                        requestMapping.put(message, matchedRequest);\n                    }\n                } else if(message.isPageMessage() && message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    List<RecordedRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifferenceEnterRequest = Integer.MAX_VALUE;\n                    \n                    //log.info(\"We have an enter here\");\n                    \n                    for(RecordedRequest recordedRequest2 : messagePage) {\n                        if(message.getTime() != null && recordedRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),recordedRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifferenceEnterRequest)){\n                                timeDifferenceEnterRequest = secondsDifference;\n                                matchedEnterRequest = recordedRequest2;\n                            }\n                        }\n                    }\n                    //if(matchedEnterRequest != null && Math.abs(timeDifference) < 30){\n                        //requestMapping.put(message, matchedEnterRequest);\n                    //}\n                } else { // These are other random log bits\n                //log.info(\"Found error \" + matchedEnterRequest + \" --- \" + timeDifferenceEnterRequest + \" ---- \" + message.getRawLog());\n                    if (matchedEnterRequest != null && Math.abs(timeDifferenceEnterRequest) < 30) { // We match it up to the last page request, it probably belongs to that?  As far as we know.\n                        //log.info(\"Added error\");\n                        errorMapping.put(message, matchedEnterRequest);\n                    }\n                }\n            }\n        }\n    }\n    \n    // log.info(requestMapping.size() + \" mapped requests\");\n    // log.info(errorMapping.size() + \" errors mapped to requests\");\n    \n    // log.info(\"ERRORS\");\n    // for(LogMessage logMessage : errorMapping.keySet()){\n    //     log.info(\"Error \" + logMessage.getRawLog() + \" belongs to \" + errorMapping.get(logMessage).getRequestURL() + \" at \" + errorMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    // log.info(\"\");\n    // log.info(\"REQUESTS\");\n    // for(LogMessage logMessage : requestMapping.keySet()){\n    //     log.info(\"Request \" + logMessage.getRawLog() + \" belongs to \" + requestMapping.get(logMessage).getRequestURL() + \" at \" + requestMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    \n    reportErrors(requestMapping,errorMapping);\n    \n    run(\"Test Controller\");\n}\n\npublic void reportErrors(LinkedHashMap<LogMessage, RecordedRequest> requestMapping, LinkedHashMap<LogMessage, RecordedRequest> errorMapping) {\n    Integer excelSize = (requestMapping.size() + errorMapping.size()) * 2;\n    \n    log.info(\"Requests \" + requestMapping.size() + \" Error \" + errorMapping.size());\n    log.info(\"Excel size \" + excelSize);\n    \n    if(excelSize < 1){\n        excelSize = 10;\n    }\n    \n    Export export = new Export(excelSize,5);\n    Export exportTrimmed = new Export(excelSize,5);\n    \n    setExportHeaders(export,requestMapping.size(),errorMapping.size());\n    setExportHeaders(exportTrimmed,requestMapping.size(),errorMapping.size());\n    \n    // Requests\n    Integer lineCounter = 1;\n    for(LogMessage logMessage : requestMapping.keySet()){\n        export.add(new ExportValue(logMessage.getPage(),lineCounter,0));\n        org.joda.time.format.DateTimeFormatter dtfOut = org.joda.time.format.DateTimeFormat.forPattern(\"HH:mm:ss MM/dd/yyyy\");\n        export.add(new ExportValue(dtfOut.print(logMessage.getTime()),lineCounter,1));\n        export.add(new ExportValue(logMessage.getUser(),lineCounter,2));\n        export.add(new ExportValue(logMessage.getDuration(),lineCounter,3));\n        \n        Boolean addedLine = false;\n        for(LogMessage errorLog : errorMapping.keySet()){\n            if(requestMapping.get(logMessage) == errorMapping.get(errorLog)){\n                export.add(new ExportValue(errorLog.getRawLog(),lineCounter,4));\n                lineCounter++;\n                addedLine = true;\n            }\n        }\n        \n        if(!addedLine){\n            lineCounter++;    \n        }\n    }\n    \n    // Trimmed version\n    Integer lineCounterTrimmed = 1; \n    for(int i=1;i<export.getRowCount();i++){\n        ExportValue exportValue = (ExportValue)export.getValue(i,4);\n        if(exportValue != null && exportValue.getDataValue() != null){\n            ExportValue exportValue0 = (ExportValue)export.getValue(i,0);\n            ExportValue exportValue1 = (ExportValue)export.getValue(i,1);\n            ExportValue exportValue2 = (ExportValue)export.getValue(i,2);\n            ExportValue exportValue3 = (ExportValue)export.getValue(i,3);\n            ExportValue exportValue4 = (ExportValue)export.getValue(i,4);\n            if(exportValue0 != null){\n                exportTrimmed.add(new ExportValue(exportValue0.getDataValue(),lineCounterTrimmed,0));    \n            }\n            if(exportValue1 != null){\n                exportTrimmed.add(new ExportValue(exportValue1.getDataValue(),lineCounterTrimmed,1));    \n            }\n            if(exportValue2 != null){\n                exportTrimmed.add(new ExportValue(exportValue2.getDataValue(),lineCounterTrimmed,2));    \n            }\n            if(exportValue3 != null){\n                exportTrimmed.add(new ExportValue(exportValue3.getDataValue(),lineCounterTrimmed,3));    \n            }\n            if(exportValue4 != null){\n                exportTrimmed.add(new ExportValue(exportValue4.getDataValue(),lineCounterTrimmed,4));    \n            }          \n\n            lineCounterTrimmed++;\n        }\n    }\n    \n    nodeRunParams.setOneTimeVariable(export);\n    runAndWait(\"Report Excel Log\", nodeRunParams);\n    nodeRunParams.setOneTimeVariable(exportTrimmed);\n    runAndWait(\"Report Excel Log Trimmed\", nodeRunParams);\n}\n\npublic void setExportHeaders(Export export, Integer requestcount, Integer errorCount){\n    // Header row\n    export.add(new ExportValue(\"Request (\" + requestcount + \")\",0,0));\n    export.add(new ExportValue(\"Time\",0,1));\n    export.add(new ExportValue(\"User\",0,2));\n    export.add(new ExportValue(\"Duration\",0,3));\n    export.add(new ExportValue(\"Log Errors (\" + errorCount + \")\",0,4));\n}\n\npublic List<LogMessage> decodeLog(String logRequest) {\n    String lines[] = logRequest.split(\"\\\\r?\\\\n\");\n\n    org.joda.time.DateTime time = new org.joda.time.DateTime();\n    \n    List<LogMessage> logMessages = new ArrayList<>();\n    \n    for(int i = 0;i< lines.length;i++){\n        String line = lines[i];\n        \n        LogMessage logMessage = new LogMessage();\n        logMessage.setRawLog(line);\n        \n        if(line.contains(\"[monitor]\")) { // This is a page log message\n            HashMap<String, String> result = decodeLogLine(line);\n\n            logMessage.setUser(result.get(\"USER\"));\n            logMessage.setPage(result.get(\"PAGE\"));\n            logMessage.setDuration(result.get(\"DURATION\"));\n            logMessage.setIsEnter(result.get(\"ENTER\"));\n            logMessage.parseTime(result.get(\"TIME\"));\n            logMessage.setIsPageMessage(true);\n        } else { // This is anything else, could be an exception\n            logMessage.setIsPageMessage(false);\n        }\n        \n        logMessages.add(logMessage);\n    }\n    \n    return logMessages;\n}\n\npublic HashMap<String,String> decodeLogLine(String logLine) {\n    String sections[] = logLine.split(\",\");\n    \n    HashMap<String, String> parsedLine = new HashMap<>();\n    \n    //log.info(\"Length = \" + sections.length);\n    if(sections.length == 16 || sections.length == 26){ // All logs have 16 parts\n        String time = sections[0] + \",\" + sections[1].substring(0,3);\n        String enterLeave =  sections[1].substring(20,25);\n        String user = sections[7];\n        String page = sections[9];\n        String duration = sections[11];\n        \n        parsedLine.put(\"TIME\",time);\n        parsedLine.put(\"ENTER\",enterLeave);\n        parsedLine.put(\"PAGE\",page);\n        parsedLine.put(\"USER\",user);\n        parsedLine.put(\"DURATION\",duration);\n    }\n    \n    return parsedLine;\n}\n\nprivate class LogMessage {\n    private String rawLog = \"\";\n    private Boolean isPageMessage = false;\n    private Boolean isEnter = false;\n    private String page = \"\";\n    private String user = \"\";\n    private String duration = \"\";\n    private org.joda.time.DateTime time; \n    \n    public LogMessage() {\n    }\n    \n    public org.joda.time.DateTime getTime() {\n        return time;\n    }\n    \n    public void parseTime(String timeStr) {\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        \n        String timeZoneStr = inputNode.getInputByName(\"[[logTimeZone]]\").getVariableValue();\n        org.joda.time.DateTimeZone zone = null;\n        if(timeZoneStr != null){\n            zone = org.joda.time.DateTimeZone.forID(timeZoneStr);\n        }\n        \n        if(timeStr != null){\n            Integer year = Integer.parseInt(timeStr.substring(0,4));\n            Integer month = Integer.parseInt(timeStr.substring(5,7));\n            Integer day = Integer.parseInt(timeStr.substring(8,10));\n            Integer hour = Integer.parseInt(timeStr.substring(11,13));\n            Integer minute = Integer.parseInt(timeStr.substring(14,16));\n            Integer second = Integer.parseInt(timeStr.substring(17,19));\n            Integer millisecond = Integer.parseInt(timeStr.substring(20,23));\n        \n            if(zone != null){\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond,zone); \n            } else {\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond); \n            }\n        }\n    }\n    \n    public String getDuration() {\n        return duration;\n    }\n    \n    public void setDuration(String duration) {\n        this.duration = duration;\n    }\n    \n    public Boolean isEnter() {\n        return isEnter;\n    }\n    \n    public void setIsEnter(String isEnter){\n        this.isEnter = \"Enter\".equals(isEnter);\n    }\n    \n    public String getPage() {\n        return page;\n    }\n    \n    public void setPage(String page){\n        this.page = page;\n    }\n    \n    public String getUser() {\n        return user;\n    }\n    \n    public void setUser(String user){\n        this.user = user;\n    }\n    \n    public String getRawLog() {\n        return rawLog;\n    }\n    \n    public void setRawLog(String rawLog){\n        this.rawLog = rawLog;\n    }\n    \n    public Boolean isPageMessage() {\n        return isPageMessage;\n    }\n    \n    public void setIsPageMessage(Boolean isPageMessage){\n        this.isPageMessage = isPageMessage;\n    }\n}','java.lang.String'),(17915,2802,'X','2111.0','java.lang.Double'),(17916,2802,'Id','2802','java.lang.Integer'),(17917,2802,'Y','-605.0','java.lang.Double'),(17918,2802,'ContainedText','Read log','java.lang.String'),(17919,2802,'NextNodeToRun','','java.lang.String'),(17920,2803,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(17921,2803,'FileOutputName','HSBC Websphere Blackfeather 9080-Report Test-[DATE]','java.lang.String'),(17922,2803,'X','2270.0','java.lang.Double'),(17923,2803,'Id','2803','java.lang.Integer'),(17924,2803,'Y','-605.0','java.lang.Double'),(17925,2803,'ContainedText','Report Excel Log','java.lang.String'),(17926,2803,'NextNodeToRun','Email Report Excel Results','java.lang.String'),(17927,2804,'Logic','public void function() {\n    InputNode envNameInputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = envNameInputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode testsToRun = (DataTableNode)getNode(\"Tests to run\");\n    List<DataTableRow> testsToRunList = testsToRun.getDataTableRows();\n    \n    Boolean runTest = false;\n    for(DataTableRow test : testsToRunList){\n        HashMap<String, DataTableValue> testData = test.getDataTableValues();\n        \n        if(envName.equals(testData.get(\"EnvName\").getDataValue())){\n            if(\"Y\".equals(testData.get(\"Reports\").getDataValue())){\n                runTest = true;\n                break;\n            } \n        }\n    }\n    \n    if(runTest){\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        TestNode testNode = (TestNode)getNode(\"Run Reports\");\n        \n        RequestTrackerNode requestNode = (RequestTrackerNode)getNode(\"TrackLog\");\n        requestNode.clearAllRequests();\n       \n        nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n        \n        runAndWait(\"Run Reports\", nodeRunParams);\n    } else {\n        runAndWait(\"Test Controller\");\n    }\n}','java.lang.String'),(17928,2804,'X','1568.0','java.lang.Double'),(17929,2804,'Id','2804','java.lang.Integer'),(17930,2804,'Y','-605.0','java.lang.Double'),(17931,2804,'ContainedText','Report Setup','java.lang.String'),(17932,2804,'NextNodeToRun','','java.lang.String'),(17933,2805,'X','2277.0','java.lang.Double'),(17934,2805,'Id','2805','java.lang.Integer'),(17935,2805,'Y','-671.0','java.lang.Double'),(17936,2805,'ContainedText','TrackLog','java.lang.String'),(17937,2805,'NextNodeToRun','','java.lang.String'),(17938,2806,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Report Excel Log\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Report Logs - \" + envName)\n        .content(\"No content\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Report\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(17939,2806,'X','2420.0','java.lang.Double'),(17940,2806,'Id','2806','java.lang.Integer'),(17941,2806,'Y','-605.0','java.lang.Double'),(17942,2806,'ContainedText','Email Report Excel Results','java.lang.String'),(17943,2806,'NextNodeToRun','','java.lang.String'),(17944,2807,'Test','track>trackerNode::TrackLog\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\n\n// Run the Log report\nframe>select::default\nwait>specificTime::1000\n\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::[[logReportId]]\nclick>id::[[logReportId]]\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\nwait>finishAllRequests::60000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17945,2807,'X','1975.0','java.lang.Double'),(17946,2807,'Id','2807','java.lang.Integer'),(17947,2807,'Y','-605.0','java.lang.Double'),(17948,2807,'ContainedText','Report Log','java.lang.String'),(17949,2807,'NextNodeToRun','Read log','java.lang.String'),(17950,2808,'Logic','public void function() {\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Report Log\");\n   \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Report Log\", nodeRunParams);\n}','java.lang.String'),(17951,2808,'X','1817.0','java.lang.Double'),(17952,2808,'Id','2808','java.lang.Integer'),(17953,2808,'Y','-605.0','java.lang.Double'),(17954,2808,'ContainedText','Report Log Logic','java.lang.String'),(17955,2808,'NextNodeToRun','','java.lang.String'),(17956,2809,'Logic','public void function() {\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Popup Log\");\n   \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Popup Log\", nodeRunParams);\n}','java.lang.String'),(17957,2809,'X','1831.0','java.lang.Double'),(17958,2809,'Id','2809','java.lang.Integer'),(17959,2809,'Y','-308.0','java.lang.Double'),(17960,2809,'ContainedText','Popup Log Logic','java.lang.String'),(17961,2809,'NextNodeToRun','','java.lang.String'),(17962,2810,'Test','track>trackerNode::Tracker1\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\n\n// Run the Log report\nframe>select::default\nwait>specificTime::1000\n\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::[[logReportId]]\nclick>id::[[logReportId]]\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\nwait>finishAllRequests::60000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17963,2810,'X','1992.0','java.lang.Double'),(17964,2810,'Id','2810','java.lang.Integer'),(17965,2810,'Y','-307.0','java.lang.Double'),(17966,2810,'ContainedText','Popup Log','java.lang.String'),(17967,2810,'NextNodeToRun','Read Popup Log','java.lang.String'),(17968,2811,'Logic','public void function() {\n   RequestTrackerNode trackerNode = (RequestTrackerNode)getNode(\"Tracker1\");\n   InputNode inputNode = (InputNode)getNode(\"Login Input\");\n   \n   CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n   InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    \n   // Raw Excel output\n   ExportNode exportNode = (ExportNode)getNode(\"Popup Excel Log\");\n   exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Worksheet Test Log-[DATE]\");\n   exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n    \n   // Trimmed Excel output   \n   ExportNode exportNodeTrimmed = (ExportNode)getNode(\"Popup Excel Log Trimmed\");\n   exportNodeTrimmed.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Worksheet Test Log Trimmed-[DATE]\");\n   exportNodeTrimmed.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n   \n   String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n   \n   List<RecordedRequest> logList = trackerNode.getResultList();\n   \n   LinkedHashMap<LogMessage, RecordedRequest> requestMapping = new LinkedHashMap<>();\n   LinkedHashMap<LogMessage, RecordedRequest> errorMapping = new LinkedHashMap<>();\n   \n   log.info(\"Worksheet Requests = \" + logList.size());\n   log.info(\"Internal url is \" + internalURL);\n   for(RecordedRequest recordedRequest : logList){\n       if(recordedRequest.getResponse().contains(\"LogFile:\")){\n            //log.info(\"Found a log file\");\n            List<LogMessage> messageList = decodeLog(recordedRequest.getResponse());\n            \n            RecordedRequest matchedRequest = null;\n            RecordedRequest matchedEnterRequest = null;\n            Integer timeDifference = Integer.MAX_VALUE;\n            Integer timeDifferenceEnterRequest = Integer.MAX_VALUE;\n            //log.info(\"Log messages = \" + messageList.size());\n            for(LogMessage message : messageList){\n                //log.info(message.getRawLog());\n                //log.info(\"Is page \" + message.isPageMessage() + \" isEnter \" + message.isEnter());\n                if(message.isPageMessage() && !message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    //log.info(\"We have a leave\");\n                    \n                    List<RecordedRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifference = Integer.MAX_VALUE;\n                    \n                    //log.info(\"**** \" + messagePageURL);\n                    for(RecordedRequest recordedRequest2 : messagePage) {\n                        //log.info(\"Request thing is \" + webProxyRequest2.getRequestURL());\n                        if(message.getTime() != null && recordedRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),recordedRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            //log.info(\"Old \" + timeDifference + \" diff \" + secondsDifference);\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifference)){\n                                timeDifference = secondsDifference;\n                                matchedRequest = recordedRequest2;\n                            }\n                        }\n                    }\n                    if(matchedRequest != null && Math.abs(timeDifference) < 30){\n                        //log.info(\"Added \" + message.getRawLog() + \" to \" + matchedRequest.getRequestURL());\n                        requestMapping.put(message, matchedRequest);\n                    }\n                } else if(message.isPageMessage() && message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    List<RecordedRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifferenceEnterRequest = Integer.MAX_VALUE;\n                    \n                    //log.info(\"We have an enter here\");\n                    \n                    for(RecordedRequest recordedRequest2 : messagePage) {\n                        if(message.getTime() != null && recordedRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),recordedRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifferenceEnterRequest)){\n                                timeDifferenceEnterRequest = secondsDifference;\n                                matchedEnterRequest = recordedRequest2;\n                            }\n                        }\n                    }\n                    //if(matchedEnterRequest != null && Math.abs(timeDifference) < 30){\n                        //requestMapping.put(message, matchedEnterRequest);\n                    //}\n                } else { // These are other random log bits\n                //log.info(\"Found error \" + matchedEnterRequest + \" --- \" + timeDifferenceEnterRequest + \" ---- \" + message.getRawLog());\n                    if (matchedEnterRequest != null && Math.abs(timeDifferenceEnterRequest) < 30) { // We match it up to the last page request, it probably belongs to that?  As far as we know.\n                        //log.info(\"Added error\");\n                        errorMapping.put(message, matchedEnterRequest);\n                    }\n                }\n            }\n        }\n    }\n    \n    // log.info(requestMapping.size() + \" mapped requests\");\n    // log.info(errorMapping.size() + \" errors mapped to requests\");\n    \n    // log.info(\"ERRORS\");\n    // for(LogMessage logMessage : errorMapping.keySet()){\n    //     log.info(\"Error \" + logMessage.getRawLog() + \" belongs to \" + errorMapping.get(logMessage).getRequestURL() + \" at \" + errorMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    // log.info(\"\");\n    // log.info(\"REQUESTS\");\n    // for(LogMessage logMessage : requestMapping.keySet()){\n    //     log.info(\"Request \" + logMessage.getRawLog() + \" belongs to \" + requestMapping.get(logMessage).getRequestURL() + \" at \" + requestMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    \n    reportErrors(requestMapping,errorMapping);\n    \n    runAndWait(\"Perf Setup\");\n}\n\npublic void reportErrors(LinkedHashMap<LogMessage, RecordedRequest> requestMapping, LinkedHashMap<LogMessage, RecordedRequest> errorMapping) {\n    Integer excelSize = (requestMapping.size() + errorMapping.size()) * 2;\n    \n    log.info(\"Requests \" + requestMapping.size() + \" Error \" + errorMapping.size());\n    log.info(\"Excel size \" + excelSize);\n    \n    if(excelSize < 1){\n        excelSize = 10;\n    }\n    \n    Export export = new Export(excelSize * 2,5);\n    Export exportTrimmed = new Export(excelSize * 2,5);\n    \n    setExportHeaders(export,requestMapping.size(),errorMapping.size());\n    setExportHeaders(exportTrimmed,requestMapping.size(),errorMapping.size());\n    \n    // Requests\n    Integer lineCounter = 1;\n    for(LogMessage logMessage : requestMapping.keySet()){\n        export.add(new ExportValue(logMessage.getPage(),lineCounter,0));\n        org.joda.time.format.DateTimeFormatter dtfOut = org.joda.time.format.DateTimeFormat.forPattern(\"HH:mm:ss MM/dd/yyyy\");\n        export.add(new ExportValue(dtfOut.print(logMessage.getTime()),lineCounter,1));\n        export.add(new ExportValue(logMessage.getUser(),lineCounter,2));\n        export.add(new ExportValue(logMessage.getDuration(),lineCounter,3));\n        \n        Boolean addedLine = false;\n        for(LogMessage errorLog : errorMapping.keySet()){\n            if(requestMapping.get(logMessage) == errorMapping.get(errorLog)){\n                export.add(new ExportValue(errorLog.getRawLog(),lineCounter,4));\n                lineCounter++;\n                addedLine = true;\n            }\n        }\n        \n        if(!addedLine){\n            lineCounter++;    \n        }\n    }\n    \n    // Trimmed version\n    Integer lineCounterTrimmed = 1; \n    for(int i=1;i<export.getRowCount();i++){\n        ExportValue exportValue = (ExportValue)export.getValue(i,4);\n        if(exportValue != null && exportValue.getDataValue() != null){\n            ExportValue exportValue0 = (ExportValue)export.getValue(i,0);\n            ExportValue exportValue1 = (ExportValue)export.getValue(i,1);\n            ExportValue exportValue2 = (ExportValue)export.getValue(i,2);\n            ExportValue exportValue3 = (ExportValue)export.getValue(i,3);\n            ExportValue exportValue4 = (ExportValue)export.getValue(i,4);\n            if(exportValue0 != null){\n                exportTrimmed.add(new ExportValue(exportValue0.getDataValue(),lineCounterTrimmed,0));    \n            }\n            if(exportValue1 != null){\n                exportTrimmed.add(new ExportValue(exportValue1.getDataValue(),lineCounterTrimmed,1));    \n            }\n            if(exportValue2 != null){\n                exportTrimmed.add(new ExportValue(exportValue2.getDataValue(),lineCounterTrimmed,2));    \n            }\n            if(exportValue3 != null){\n                exportTrimmed.add(new ExportValue(exportValue3.getDataValue(),lineCounterTrimmed,3));    \n            }\n            if(exportValue4 != null){\n                exportTrimmed.add(new ExportValue(exportValue4.getDataValue(),lineCounterTrimmed,4));    \n            }          \n\n            lineCounterTrimmed++;\n        }\n    }\n    \n    nodeRunParams.setOneTimeVariable(export);\n    runAndWait(\"Popup Excel Log\", nodeRunParams);\n    nodeRunParams.setOneTimeVariable(exportTrimmed);\n    runAndWait(\"Popup Excel Log Trimmed\", nodeRunParams);\n}\n\npublic void setExportHeaders(Export export, Integer requestcount, Integer errorCount){\n    // Header row\n    export.add(new ExportValue(\"Request (\" + requestcount + \")\",0,0));\n    export.add(new ExportValue(\"Time\",0,1));\n    export.add(new ExportValue(\"User\",0,2));\n    export.add(new ExportValue(\"Duration\",0,3));\n    export.add(new ExportValue(\"Log Errors (\" + errorCount + \")\",0,4));\n}\n\npublic List<LogMessage> decodeLog(String logRequest) {\n    String lines[] = logRequest.split(\"\\\\r?\\\\n\");\n\n    org.joda.time.DateTime time = new org.joda.time.DateTime();\n    \n    List<LogMessage> logMessages = new ArrayList<>();\n    \n    for(int i = 0;i< lines.length;i++){\n        String line = lines[i];\n        \n        LogMessage logMessage = new LogMessage();\n        logMessage.setRawLog(line);\n        \n        if(line.contains(\"[monitor]\")) { // This is a page log message\n            HashMap<String, String> result = decodeLogLine(line);\n\n            logMessage.setUser(result.get(\"USER\"));\n            logMessage.setPage(result.get(\"PAGE\"));\n            logMessage.setDuration(result.get(\"DURATION\"));\n            logMessage.setIsEnter(result.get(\"ENTER\"));\n            logMessage.parseTime(result.get(\"TIME\"));\n            logMessage.setIsPageMessage(true);\n        } else { // This is anything else, could be an exception\n            logMessage.setIsPageMessage(false);\n        }\n        \n        logMessages.add(logMessage);\n    }\n    \n    return logMessages;\n}\n\npublic HashMap<String,String> decodeLogLine(String logLine) {\n    String sections[] = logLine.split(\",\");\n    \n    HashMap<String, String> parsedLine = new HashMap<>();\n    \n    //log.info(\"Length = \" + sections.length);\n    if(sections.length == 16 || sections.length == 26){ // All logs have 16 parts\n        String time = sections[0] + \",\" + sections[1].substring(0,3);\n        String enterLeave =  sections[1].substring(20,25);\n        String user = sections[7];\n        String page = sections[9];\n        String duration = sections[11];\n        \n        parsedLine.put(\"TIME\",time);\n        parsedLine.put(\"ENTER\",enterLeave);\n        parsedLine.put(\"PAGE\",page);\n        parsedLine.put(\"USER\",user);\n        parsedLine.put(\"DURATION\",duration);\n    }\n    \n    return parsedLine;\n}\n\nprivate class LogMessage {\n    private String rawLog = \"\";\n    private Boolean isPageMessage = false;\n    private Boolean isEnter = false;\n    private String page = \"\";\n    private String user = \"\";\n    private String duration = \"\";\n    private org.joda.time.DateTime time; \n    \n    public LogMessage() {\n    }\n    \n    public org.joda.time.DateTime getTime() {\n        return time;\n    }\n    \n    public void parseTime(String timeStr) {\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        \n        String timeZoneStr = inputNode.getInputByName(\"[[logTimeZone]]\").getVariableValue();\n        org.joda.time.DateTimeZone zone = null;\n        if(timeZoneStr != null){\n            zone = org.joda.time.DateTimeZone.forID(timeZoneStr);\n        }\n        \n        if(timeStr != null){\n            Integer year = Integer.parseInt(timeStr.substring(0,4));\n            Integer month = Integer.parseInt(timeStr.substring(5,7));\n            Integer day = Integer.parseInt(timeStr.substring(8,10));\n            Integer hour = Integer.parseInt(timeStr.substring(11,13));\n            Integer minute = Integer.parseInt(timeStr.substring(14,16));\n            Integer second = Integer.parseInt(timeStr.substring(17,19));\n            Integer millisecond = Integer.parseInt(timeStr.substring(20,23));\n        \n            if(zone != null){\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond,zone); \n            } else {\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond); \n            }\n        }\n    }\n    \n    public String getDuration() {\n        return duration;\n    }\n    \n    public void setDuration(String duration) {\n        this.duration = duration;\n    }\n    \n    public Boolean isEnter() {\n        return isEnter;\n    }\n    \n    public void setIsEnter(String isEnter){\n        this.isEnter = \"Enter\".equals(isEnter);\n    }\n    \n    public String getPage() {\n        return page;\n    }\n    \n    public void setPage(String page){\n        this.page = page;\n    }\n    \n    public String getUser() {\n        return user;\n    }\n    \n    public void setUser(String user){\n        this.user = user;\n    }\n    \n    public String getRawLog() {\n        return rawLog;\n    }\n    \n    public void setRawLog(String rawLog){\n        this.rawLog = rawLog;\n    }\n    \n    public Boolean isPageMessage() {\n        return isPageMessage;\n    }\n    \n    public void setIsPageMessage(Boolean isPageMessage){\n        this.isPageMessage = isPageMessage;\n    }\n}','java.lang.String'),(17969,2811,'X','2122.0','java.lang.Double'),(17970,2811,'Id','2811','java.lang.Integer'),(17971,2811,'Y','-307.0','java.lang.Double'),(17972,2811,'ContainedText','Read Popup Log','java.lang.String'),(17973,2811,'NextNodeToRun','','java.lang.String'),(17974,2812,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-31 13-25-27//V6 Demo QA (Oracle)','java.lang.String'),(17975,2812,'FileOutputName','V6 Demo QA (Oracle)-Popup Test Log-[DATE]','java.lang.String'),(17976,2812,'X','2286.0','java.lang.Double'),(17977,2812,'Id','2812','java.lang.Integer'),(17978,2812,'Y','-305.0','java.lang.Double'),(17979,2812,'ContainedText','Popup Excel Log','java.lang.String'),(17980,2812,'NextNodeToRun','Email Popup Excel Log','java.lang.String'),(17981,2813,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Popup Excel Log\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Worksheet Popups Log - \" + envName)\n        .content(\"this doesn\'t seem to show..\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Popup\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(17982,2813,'X','2447.0','java.lang.Double'),(17983,2813,'Id','2813','java.lang.Integer'),(17984,2813,'Y','-305.0','java.lang.Double'),(17985,2813,'ContainedText','Email Popup Excel Log','java.lang.String'),(17986,2813,'NextNodeToRun','','java.lang.String'),(17987,2814,'Logic','public void function() {\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Admin Log\");\n   \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Admin Log\", nodeRunParams);\n}','java.lang.String'),(17988,2814,'X','2317.0','java.lang.Double'),(17989,2814,'Id','2814','java.lang.Integer'),(17990,2814,'Y','-69.0','java.lang.Double'),(17991,2814,'ContainedText','Admin Log Logic','java.lang.String'),(17992,2814,'NextNodeToRun','','java.lang.String'),(17993,2815,'Test','track>trackerNode::Tracker1\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\n\n// Run the Log report\nframe>select::default\nwait>specificTime::1000\n\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::[[logReportId]]\nclick>id::[[logReportId]]\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\nwait>finishAllRequests::60000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(17994,2815,'X','2498.0','java.lang.Double'),(17995,2815,'Id','2815','java.lang.Integer'),(17996,2815,'Y','-69.0','java.lang.Double'),(17997,2815,'ContainedText','Admin Log','java.lang.String'),(17998,2815,'NextNodeToRun','Read Admin Log','java.lang.String'),(17999,2816,'Logic','public void function() {\n   RequestTrackerNode trackerNode = (RequestTrackerNode)getNode(\"Tracker1\");\n   InputNode inputNode = (InputNode)getNode(\"Login Input\");\n   \n    InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n   \n    // Raw Excel output\n    ExportNode exportNode = (ExportNode)getNode(\"Admin Excel Log\");\n    exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Admin Test Log-[DATE]\");\n    exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n    \n    // Trimmed Excel output   \n    ExportNode exportNodeTrimmed = (ExportNode)getNode(\"Admin Excel Log Trimmed\");\n    exportNodeTrimmed.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Admin Test Log Trimmed-[DATE]\");\n    exportNodeTrimmed.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n   \n   String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n   \n   List<RecordedRequest> logList = trackerNode.getResultList();\n   \n   LinkedHashMap<LogMessage, RecordedRequest> requestMapping = new LinkedHashMap<>();\n   LinkedHashMap<LogMessage, RecordedRequest> errorMapping = new LinkedHashMap<>();\n   \n   log.info(\"Worksheet Requests = \" + logList.size());\n   log.info(\"Internal url is \" + internalURL);\n   for(RecordedRequest recordedRequest : logList){\n       if(recordedRequest.getResponse().contains(\"LogFile:\")){\n            List<LogMessage> messageList = decodeLog(recordedRequest.getResponse());\n            \n            RecordedRequest matchedRequest = null;\n            RecordedRequest matchedEnterRequest = null;\n            Integer timeDifference = Integer.MAX_VALUE;\n            Integer timeDifferenceEnterRequest = Integer.MAX_VALUE;\n            //log.info(\"Log messages = \" + messageList.size());\n            for(LogMessage message : messageList){\n                //log.info(message.getRawLog());\n                //log.info(\"Is page \" + message.isPageMessage() + \" isEnter \" + message.isEnter());\n                if(message.isPageMessage() && !message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    //log.info(\"We have a leave\");\n                    \n                    List<RecordedRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifference = Integer.MAX_VALUE;\n                    \n                    //log.info(\"**** \" + messagePageURL);\n                    for(RecordedRequest recordedRequest2 : messagePage) {\n                        //log.info(\"Request thing is \" + webProxyRequest2.getRequestURL());\n                        if(message.getTime() != null && recordedRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),recordedRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            //log.info(\"Old \" + timeDifference + \" diff \" + secondsDifference);\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifference)){\n                                timeDifference = secondsDifference;\n                                matchedRequest = recordedRequest2;\n                            }\n                        }\n                    }\n                    if(matchedRequest != null && Math.abs(timeDifference) < 30){\n                        //log.info(\"Added \" + message.getRawLog() + \" to \" + matchedRequest.getRequestURL());\n                        requestMapping.put(message, matchedRequest);\n                    }\n                } else if(message.isPageMessage() && message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    List<RecordedRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifferenceEnterRequest = Integer.MAX_VALUE;\n                    \n                    //log.info(\"We have an enter here\");\n                    \n                    for(RecordedRequest recordedRequest2 : messagePage) {\n                        if(message.getTime() != null && recordedRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),recordedRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifferenceEnterRequest)){\n                                timeDifferenceEnterRequest = secondsDifference;\n                                matchedEnterRequest = recordedRequest2;\n                            }\n                        }\n                    }\n                    //if(matchedEnterRequest != null && Math.abs(timeDifference) < 30){\n                        //requestMapping.put(message, matchedEnterRequest);\n                    //}\n                } else { // These are other random log bits\n                //log.info(\"Found error \" + matchedEnterRequest + \" --- \" + timeDifferenceEnterRequest + \" ---- \" + message.getRawLog());\n                    if (matchedEnterRequest != null && Math.abs(timeDifferenceEnterRequest) < 30) { // We match it up to the last page request, it probably belongs to that?  As far as we know.\n                        //log.info(\"Added error\");\n                        errorMapping.put(message, matchedEnterRequest);\n                    }\n                }\n            }\n        }\n    }\n    \n    // log.info(requestMapping.size() + \" mapped requests\");\n    // log.info(errorMapping.size() + \" errors mapped to requests\");\n    \n    // log.info(\"ERRORS\");\n    // for(LogMessage logMessage : errorMapping.keySet()){\n    //     log.info(\"Error \" + logMessage.getRawLog() + \" belongs to \" + errorMapping.get(logMessage).getRequestURL() + \" at \" + errorMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    // log.info(\"\");\n    // log.info(\"REQUESTS\");\n    // for(LogMessage logMessage : requestMapping.keySet()){\n    //     log.info(\"Request \" + logMessage.getRawLog() + \" belongs to \" + requestMapping.get(logMessage).getRequestURL() + \" at \" + requestMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    \n    reportErrors(requestMapping,errorMapping);\n    \n    RequestTrackerNode requestNode = (RequestTrackerNode)getNode(\"Tracker1\");\n    requestNode.clearAllRequests();\n    \n    runAndWait(\"Popup Setup\");\n}\n\npublic void reportErrors(LinkedHashMap<LogMessage, RecordedRequest> requestMapping, LinkedHashMap<LogMessage, RecordedRequest> errorMapping) {\n    Integer excelSize = (requestMapping.size() + errorMapping.size()) * 2;\n    \n    log.info(\"Requests \" + requestMapping.size() + \" Error \" + errorMapping.size());\n    log.info(\"Excel size \" + excelSize);\n    \n    if(excelSize < 1){\n        excelSize = 10;\n    }\n    \n    Export export = new Export(excelSize,5);\n    Export exportTrimmed = new Export(excelSize,5);\n    \n    setExportHeaders(export,requestMapping.size(),errorMapping.size());\n    setExportHeaders(exportTrimmed,requestMapping.size(),errorMapping.size());\n    \n    // Requests\n    Integer lineCounter = 1;\n    for(LogMessage logMessage : requestMapping.keySet()){\n        export.add(new ExportValue(logMessage.getPage(),lineCounter,0));\n        org.joda.time.format.DateTimeFormatter dtfOut = org.joda.time.format.DateTimeFormat.forPattern(\"HH:mm:ss MM/dd/yyyy\");\n        export.add(new ExportValue(dtfOut.print(logMessage.getTime()),lineCounter,1));\n        export.add(new ExportValue(logMessage.getUser(),lineCounter,2));\n        export.add(new ExportValue(logMessage.getDuration(),lineCounter,3));\n        \n        Boolean addedLine = false;\n        for(LogMessage errorLog : errorMapping.keySet()){\n            if(requestMapping.get(logMessage) == errorMapping.get(errorLog)){\n                export.add(new ExportValue(errorLog.getRawLog(),lineCounter,4));\n                lineCounter++;\n                addedLine = true;\n            }\n        }\n        \n        if(!addedLine){\n            lineCounter++;    \n        }\n    }\n    \n    // Trimmed version\n    Integer lineCounterTrimmed = 1; \n    for(int i=1;i<export.getRowCount();i++){\n        ExportValue exportValue = (ExportValue)export.getValue(i,4);\n        if(exportValue != null && exportValue.getDataValue() != null){\n            ExportValue exportValue0 = (ExportValue)export.getValue(i,0);\n            ExportValue exportValue1 = (ExportValue)export.getValue(i,1);\n            ExportValue exportValue2 = (ExportValue)export.getValue(i,2);\n            ExportValue exportValue3 = (ExportValue)export.getValue(i,3);\n            ExportValue exportValue4 = (ExportValue)export.getValue(i,4);\n            if(exportValue0 != null){\n                exportTrimmed.add(new ExportValue(exportValue0.getDataValue(),lineCounterTrimmed,0));    \n            }\n            if(exportValue1 != null){\n                exportTrimmed.add(new ExportValue(exportValue1.getDataValue(),lineCounterTrimmed,1));    \n            }\n            if(exportValue2 != null){\n                exportTrimmed.add(new ExportValue(exportValue2.getDataValue(),lineCounterTrimmed,2));    \n            }\n            if(exportValue3 != null){\n                exportTrimmed.add(new ExportValue(exportValue3.getDataValue(),lineCounterTrimmed,3));    \n            }\n            if(exportValue4 != null){\n                exportTrimmed.add(new ExportValue(exportValue4.getDataValue(),lineCounterTrimmed,4));    \n            }          \n\n            lineCounterTrimmed++;\n        }\n    }\n    \n    nodeRunParams.setOneTimeVariable(export);\n    runAndWait(\"Admin Excel Log\", nodeRunParams);\n    nodeRunParams.setOneTimeVariable(exportTrimmed);\n    runAndWait(\"Admin Excel Log Trimmed\", nodeRunParams);\n}\n\npublic void setExportHeaders(Export export, Integer requestcount, Integer errorCount){\n    // Header row\n    export.add(new ExportValue(\"Request (\" + requestcount + \")\",0,0));\n    export.add(new ExportValue(\"Time\",0,1));\n    export.add(new ExportValue(\"User\",0,2));\n    export.add(new ExportValue(\"Duration\",0,3));\n    export.add(new ExportValue(\"Log Errors (\" + errorCount + \")\",0,4));\n}\n\npublic List<LogMessage> decodeLog(String logRequest) {\n    String lines[] = logRequest.split(\"\\\\r?\\\\n\");\n\n    org.joda.time.DateTime time = new org.joda.time.DateTime();\n    \n    List<LogMessage> logMessages = new ArrayList<>();\n    \n    for(int i = 0;i< lines.length;i++){\n        String line = lines[i];\n        \n        LogMessage logMessage = new LogMessage();\n        logMessage.setRawLog(line);\n        \n        if(line.contains(\"[monitor]\")) { // This is a page log message\n            HashMap<String, String> result = decodeLogLine(line);\n\n            logMessage.setUser(result.get(\"USER\"));\n            logMessage.setPage(result.get(\"PAGE\"));\n            logMessage.setDuration(result.get(\"DURATION\"));\n            logMessage.setIsEnter(result.get(\"ENTER\"));\n            logMessage.parseTime(result.get(\"TIME\"));\n            logMessage.setIsPageMessage(true);\n        } else { // This is anything else, could be an exception\n            logMessage.setIsPageMessage(false);\n        }\n        \n        logMessages.add(logMessage);\n    }\n    \n    return logMessages;\n}\n\npublic HashMap<String,String> decodeLogLine(String logLine) {\n    String sections[] = logLine.split(\",\");\n    \n    HashMap<String, String> parsedLine = new HashMap<>();\n    \n    //log.info(\"Length = \" + sections.length);\n    if(sections.length == 16 || sections.length == 26){ // All logs have 16 parts\n        String time = sections[0] + \",\" + sections[1].substring(0,3);\n        String enterLeave =  sections[1].substring(20,25);\n        String user = sections[7];\n        String page = sections[9];\n        String duration = sections[11];\n        \n        parsedLine.put(\"TIME\",time);\n        parsedLine.put(\"ENTER\",enterLeave);\n        parsedLine.put(\"PAGE\",page);\n        parsedLine.put(\"USER\",user);\n        parsedLine.put(\"DURATION\",duration);\n    }\n    \n    return parsedLine;\n}\n\nprivate class LogMessage {\n    private String rawLog = \"\";\n    private Boolean isPageMessage = false;\n    private Boolean isEnter = false;\n    private String page = \"\";\n    private String user = \"\";\n    private String duration = \"\";\n    private org.joda.time.DateTime time; \n    \n    public LogMessage() {\n    }\n    \n    public org.joda.time.DateTime getTime() {\n        return time;\n    }\n    \n    public void parseTime(String timeStr) {\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        \n        String timeZoneStr = inputNode.getInputByName(\"[[logTimeZone]]\").getVariableValue();\n        org.joda.time.DateTimeZone zone = null;\n        if(timeZoneStr != null){\n            zone = org.joda.time.DateTimeZone.forID(timeZoneStr);\n        }\n        \n        if(timeStr != null){\n            Integer year = Integer.parseInt(timeStr.substring(0,4));\n            Integer month = Integer.parseInt(timeStr.substring(5,7));\n            Integer day = Integer.parseInt(timeStr.substring(8,10));\n            Integer hour = Integer.parseInt(timeStr.substring(11,13));\n            Integer minute = Integer.parseInt(timeStr.substring(14,16));\n            Integer second = Integer.parseInt(timeStr.substring(17,19));\n            Integer millisecond = Integer.parseInt(timeStr.substring(20,23));\n        \n            if(zone != null){\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond,zone); \n            } else {\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond); \n            }\n        }\n    }\n    \n    public String getDuration() {\n        return duration;\n    }\n    \n    public void setDuration(String duration) {\n        this.duration = duration;\n    }\n    \n    public Boolean isEnter() {\n        return isEnter;\n    }\n    \n    public void setIsEnter(String isEnter){\n        this.isEnter = \"Enter\".equals(isEnter);\n    }\n    \n    public String getPage() {\n        return page;\n    }\n    \n    public void setPage(String page){\n        this.page = page;\n    }\n    \n    public String getUser() {\n        return user;\n    }\n    \n    public void setUser(String user){\n        this.user = user;\n    }\n    \n    public String getRawLog() {\n        return rawLog;\n    }\n    \n    public void setRawLog(String rawLog){\n        this.rawLog = rawLog;\n    }\n    \n    public Boolean isPageMessage() {\n        return isPageMessage;\n    }\n    \n    public void setIsPageMessage(Boolean isPageMessage){\n        this.isPageMessage = isPageMessage;\n    }\n}','java.lang.String'),(18000,2816,'X','2648.0','java.lang.Double'),(18001,2816,'Id','2816','java.lang.Integer'),(18002,2816,'Y','-69.0','java.lang.Double'),(18003,2816,'ContainedText','Read Admin Log','java.lang.String'),(18004,2816,'NextNodeToRun','','java.lang.String'),(18005,2817,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(18006,2817,'FileOutputName','HSBC Websphere Blackfeather 9080-Admin Test Log-[DATE]','java.lang.String'),(18007,2817,'X','2826.0','java.lang.Double'),(18008,2817,'Id','2817','java.lang.Integer'),(18009,2817,'Y','-69.0','java.lang.Double'),(18010,2817,'ContainedText','Admin Excel Log','java.lang.String'),(18011,2817,'NextNodeToRun','Email Admin Excel Log','java.lang.String'),(18012,2818,'Logic','public void function() {\n    ExportNode exportNode = (ExportNode)getNode(\"Admin Excel Log\");\n    InputNode inputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = inputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode emails = (DataTableNode)getNode(\"Emails\");\n    List<DataTableRow> dataTableRowList = emails.getDataTableRows();\n    \n    EmailMessage emailMessage = new EmailMessage()\n        .from(\"SDE@spl.com\")\n        .username(\"alex@spl.com\")\n        .password(\"4o%2!oqZ#On!tepv111!\")\n        .subject(\"SDE3 - Admin Menu Log - \" + envName)\n        .content(\"No content\")\n        .attach(exportNode.getConstructedFileName())\n        .protocol(\"imaps\")\n        .host(\"mail.spl.com\")\n        .port(\"587\");\n    \n    for(DataTableRow dataTableRow : dataTableRowList){\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        \n        if(\"Y\".equals(dataTableRowData.get(\"Admin\").getDataValue())){\n            emailMessage.to(dataTableRowData.get(\"Address\").getDataValue());\n        }\n    }\n    \n    emailMessage.send();\n}','java.lang.String'),(18013,2818,'X','3001.0','java.lang.Double'),(18014,2818,'Id','2818','java.lang.Integer'),(18015,2818,'Y','-69.0','java.lang.Double'),(18016,2818,'ContainedText','Email Admin Excel Log','java.lang.String'),(18017,2818,'NextNodeToRun','','java.lang.String'),(18018,2819,'X','964.0','java.lang.Double'),(18019,2819,'Id','2819','java.lang.Integer'),(18020,2819,'Y','27.0','java.lang.Double'),(18021,2819,'ContainedText','Environment Configuration','java.lang.String'),(18022,2819,'NextNodeToRun','','java.lang.String'),(18023,2820,'Logic','@SuppressWarnings(\"unchecked\")\npublic void function() {\n    CustomObjectNode envsToRun = (CustomObjectNode)getNode(\"Envs to run\");\n    SwitchNode envSelect = (SwitchNode)getNode(\"Environment Select\");\n    \n    List<String> enabledSwitches = new ArrayList<>();\n    for(Switch aSwitch: envSelect.getSwitches()){\n        if(aSwitch.isEnabled()){\n            enabledSwitches.add(aSwitch.getTarget());\n        }    \n    }\n    \n    DataTableNode envConf = (DataTableNode)getNode(\"Environment Configuration\");\n    List<DataTableRow> dataTableRowList = envConf.getDataTableRows();\n    List<HashMap<String, String>> environments = (List<HashMap<String, String>>) envsToRun.getCustomObject(\"envs\").getPayload();\n    \n    for(DataTableRow dataTableRow : dataTableRowList) {\n        HashMap<String, DataTableValue> dataTableRowData = dataTableRow.getDataTableValues();\n        HashMap<String, String> envInfo = new HashMap<>();\n        if(dataTableRowData.get(\"EnvName\") != null){\n        log.info(\"********** \" + dataTableRowData.get(\"EnvName\").getDataValue() + \" ********\");\n            if(enabledSwitches.contains(dataTableRowData.get(\"EnvName\").getDataValue())){\n                for(String key : dataTableRowData.keySet()){\n                    log.info(key + \" -> \" + dataTableRowData.get(key).getDataValue());    \n                    envInfo.put(key,dataTableRowData.get(key).getDataValue());\n                }\n                \n                environments.add(envInfo);    \n            } else {\n                log.info(\"Skipped\");\n            }\n        }\n    }\n}','java.lang.String'),(18024,2820,'X','788.0','java.lang.Double'),(18025,2820,'Id','2820','java.lang.Integer'),(18026,2820,'Y','93.0','java.lang.Double'),(18027,2820,'ContainedText','Process Env Info','java.lang.String'),(18028,2820,'NextNodeToRun','','java.lang.String'),(18029,2821,'X','1018.0','java.lang.Double'),(18030,2821,'Id','2821','java.lang.Integer'),(18031,2821,'Y','-82.0','java.lang.Double'),(18032,2821,'ContainedText','Emails','java.lang.String'),(18033,2821,'NextNodeToRun','','java.lang.String'),(18034,2822,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-[DATE]','java.lang.String'),(18035,2822,'FileOutputName','','java.lang.String'),(18036,2822,'X','996.0','java.lang.Double'),(18037,2822,'Id','2822','java.lang.Integer'),(18038,2822,'Y','-135.0','java.lang.Double'),(18039,2822,'ContainedText','Output Directory','java.lang.String'),(18040,2822,'NextNodeToRun','','java.lang.String'),(18041,2823,'X','1131.0','java.lang.Double'),(18042,2823,'Id','2823','java.lang.Integer'),(18043,2823,'Y','287.0','java.lang.Double'),(18044,2823,'ContainedText','File Location','java.lang.String'),(18045,2823,'NextNodeToRun','','java.lang.String'),(18046,2824,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-31 13-25-27//V6 Demo QA (Oracle)','java.lang.String'),(18047,2824,'FileOutputName','V6 Demo QA (Oracle)-Popup Test Log Trimmed-[DATE]','java.lang.String'),(18048,2824,'X','2287.0','java.lang.Double'),(18049,2824,'Id','2824','java.lang.Integer'),(18050,2824,'Y','-253.0','java.lang.Double'),(18051,2824,'ContainedText','Popup Excel Log Trimmed','java.lang.String'),(18052,2824,'NextNodeToRun','','java.lang.String'),(18053,2825,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59//HSBC Websphere Blackfeather 9080','java.lang.String'),(18054,2825,'FileOutputName','HSBC Websphere Blackfeather 9080-Report Test-[DATE]','java.lang.String'),(18055,2825,'X','2270.0','java.lang.Double'),(18056,2825,'Id','2825','java.lang.Integer'),(18057,2825,'Y','-557.0','java.lang.Double'),(18058,2825,'ContainedText','Report Excel Log Trimmed','java.lang.String'),(18059,2825,'NextNodeToRun','','java.lang.String'),(18060,2826,'FileOutputDirectory','','java.lang.String'),(18061,2826,'FileOutputName','','java.lang.String'),(18062,2826,'X','2827.0','java.lang.Double'),(18063,2826,'Id','2826','java.lang.Integer'),(18064,2826,'Y','-12.0','java.lang.Double'),(18065,2826,'ContainedText','Admin Excel Log Trimmed','java.lang.String'),(18066,2826,'NextNodeToRun','','java.lang.String'),(18067,2827,'Logic','public void function() {\n    InputNode envNameInputNode = (InputNode)getNode(\"Environment Name\");\n    String envName = envNameInputNode.getInputByName(\"EnvName\").getVariableValue();\n    \n    DataTableNode testsToRun = (DataTableNode)getNode(\"Tests to run\");\n    List<DataTableRow> testsToRunList = testsToRun.getDataTableRows();\n    \n    Boolean runTest = false;\n    for(DataTableRow test : testsToRunList){\n        HashMap<String, DataTableValue> testData = test.getDataTableValues();\n        \n        if(envName.equals(testData.get(\"EnvName\").getDataValue())){\n            if(\"Y\".equals(testData.get(\"Perf Worksheet Popups\").getDataValue())){\n                runTest = true;\n                break;\n            } \n        }\n    }\n    \n    if(runTest){\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        TestNode testNode = (TestNode)getNode(\"Run Perf\");\n        \n        nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n        \n        runAndWait(\"Run Perf\", nodeRunParams);\n    } else {\n        runAndWait(\"Report Setup\");\n    }\n}','java.lang.String'),(18068,2827,'X','1576.0','java.lang.Double'),(18069,2827,'Id','2827','java.lang.Integer'),(18070,2827,'Y','-463.0','java.lang.Double'),(18071,2827,'ContainedText','Perf Setup','java.lang.String'),(18072,2827,'NextNodeToRun','','java.lang.String'),(18073,2828,'Test','// Logging in\ntrack>trackerNode::Tracker1\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Go to the performance module\nframe>select::default\nwait>specificTime::1000\nwait>presence::id::mainmenu1506\nclick>id::mainmenu1506\nwait>specificTime::500\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Search for employee id we are testing against and then go to worksheet via search results\nframe>select::default\nwait>presence::id::searchInput\ninput>id::searchInput>value::[[testEmployee]]>characterDelay::100\nwait>presence::id::GoImage\nclick>id::GoImage\nwait>specificTime::1000\nwait>presence::xPath:://*[@id=\"searchResultsDiv\"]\nloop>start::searchResult>list::tag::a>xPath:://*[@id=\"searchResultsDiv\"]\n    if>start::clickResult>loop::searchResult>attribute::id>contains::searchPopup\n        click>loop::searchResult\n    if>end::clickResult\n    if>start::clickResult>loop::searchResult>attribute::href>contains::ProcessWorksheetFunctions\n        click>loop::searchResult\n    if>end::clickResult\nloop>end::searchResult\nwait>specificTime::1000\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\n\n// Looping through worksheet rows and columns\nloop>start::row>list::tag::td>xPath:://*[@id=\"row0\"]\n    // These are for inputs which open popups\n    loop>start::cell>list::tag::input>loop::row\n        call>function::testPopup\n    loop>end::cell\n\n    // This is for a tags which open popups\n    loop>start::cell>list::tag::a>loop::row\n        call>function::testPopup\n    loop>end::cell\nloop>end::row\n\nfunction>start::testPopup\n    if>start::ifReference>loop::cell>attribute::onclick>contains::_actionCallbackINPUT\n        click>loop::cell\n        // Waiting for the popup to open\n        wait>specificTime::2000\n        \n        // Loop through all popups and if they are open close them\n        frame>select::default\n        loop>start::popup>list::tag::div>xPath:://*[@id=\"indexLaptop\"]>direct::true\n            if>start::classCheck>loop::popup>class::true>contains::ui-dialog\n                if>start::visible>loop::popup>attribute::style>contains::block\n                    // Close the popup here\n                    loop>start::spanPress>list::tag::span>loop::popup\n                        if>start::buttonCheck>loop::spanPress>class::true>contains::ui-icon-closethick\n                            click>loop::spanPress\n                        if>end::buttonCheck\n                    loop>end::spanPress\n                if>end::visible\n            if>end::classCheck\n        loop>end::popup\n        wait>frameLoaded::frame::content\n        frame>id::content\n    if>end::ifReference\nfunction>end::testPopup\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1000\nwait>finishAllRequests::60000\nexit>','java.lang.String'),(18074,2828,'X','1708.0','java.lang.Double'),(18075,2828,'Id','2828','java.lang.Integer'),(18076,2828,'Y','-462.0','java.lang.Double'),(18077,2828,'ContainedText','Run Perf','java.lang.String'),(18078,2828,'NextNodeToRun','Perf Log Logic','java.lang.String'),(18079,2829,'Logic','public void function() {\n    InputNode inputNode = (InputNode)getNode(\"Login Input\");\n    TestNode testNode = (TestNode)getNode(\"Perf Log\");\n   \n    nodeRunParams.setOneTimeVariable(testNode.applyInputs(inputNode));\n    \n    run(\"Perf Log\", nodeRunParams);\n}','java.lang.String'),(18080,2829,'X','1827.0','java.lang.Double'),(18081,2829,'Id','2829','java.lang.Integer'),(18082,2829,'Y','-462.0','java.lang.Double'),(18083,2829,'ContainedText','Perf Log Logic','java.lang.String'),(18084,2829,'NextNodeToRun','','java.lang.String'),(18085,2830,'Test','track>trackerNode::Tracker1\n\n// Logging in\nurl>url::[[url]]\nwait>clickable::id::login\ninput>id::j_username>value::((username))>characterDelay::100\ninput>id::j_password>value::((password))>characterDelay::100\nclick>id::login\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Run each report in turn\nframe>select::default\nwait>specificTime::1000\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::pageLeftLargeMenu\n\n// Run the Log report\nframe>select::default\nwait>specificTime::1000\n\n// This is for the demo report menu\nif>start::selectReportMenu>id::mainmenu106>elementExists::true\n    click>id::mainmenu106\nif>end::selectReportMenu\n// This is for HSBC report menu\nif>start::selectReportMenu>id::mainmenu2>elementExists::true\n    click>id::mainmenu2\nif>end::selectReportMenu\n\nwait>specificTime::500\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::[[logReportId]]\nclick>id::[[logReportId]]\nwait>specificTime::500\nwait>presence::id::reportPageIframe\nwait>frameLoaded::frame::reportPageIframe\nframe>id::reportPageIframe\nwait>presence::id::runReportButton\n// We manually add an option to the select so we can chooose 100,000 lines to get back from the spl.log report\njavascript>script::[[!$(\'#numberOfLines\').append($(\"<option></option>\").attr(\"value\",100000).text(\"100000 Lines\"));!]]\nwait>specificTime::500\nselect>id::numberOfLines>select::100000 Lines\nclick>id::runReportButton\nwait>specificTime::1000\nwait>finishAllRequests::60000\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nwait>finishAllRequests::60000\nexit>\nend>','java.lang.String'),(18086,2830,'X','1986.0','java.lang.Double'),(18087,2830,'Id','2830','java.lang.Integer'),(18088,2830,'Y','-461.0','java.lang.Double'),(18089,2830,'ContainedText','Perf Log','java.lang.String'),(18090,2830,'NextNodeToRun','Read Perf Log','java.lang.String'),(18091,2831,'Logic','public void function() {\n   RequestTrackerNode trackerNode = (RequestTrackerNode)getNode(\"Tracker1\");\n   InputNode inputNode = (InputNode)getNode(\"Login Input\");\n   \n   CustomObjectNode fileLocation = (CustomObjectNode)getNode(\"File Location\");\n   InputNode environmentName = (InputNode)getNode(\"Environment Name\");\n    \n   // Raw Excel output\n   ExportNode exportNode = (ExportNode)getNode(\"Perf Excel Log\");\n   exportNode.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Performance Test Log-[DATE]\");\n   exportNode.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n    \n   // Trimmed Excel output   \n   ExportNode exportNodeTrimmed = (ExportNode)getNode(\"Perf Excel Log Trimmed\");\n   exportNodeTrimmed.setFileOutputName(environmentName.getInputByName(\"EnvName\").getVariableValue() + \"-Performance Test Log Trimmed-[DATE]\");\n   exportNodeTrimmed.setFileOutputDirectory(fileLocation.getCustomObject(\"outputFolder\").getPayload() + \"/\" + environmentName.getInputByName(\"EnvName\").getVariableValue());\n   \n   String internalURL = inputNode.getInputByName(\"[[internalurl]]\").getVariableValue();\n   \n   List<RecordedRequest> logList = trackerNode.getResultList();\n   \n   LinkedHashMap<LogMessage, RecordedRequest> requestMapping = new LinkedHashMap<>();\n   LinkedHashMap<LogMessage, RecordedRequest> errorMapping = new LinkedHashMap<>();\n   \n   log.info(\"Worksheet Requests = \" + logList.size());\n   log.info(\"Internal url is \" + internalURL);\n   for(RecordedRequest recordedRequest : logList){\n       if(recordedRequest.getResponse().contains(\"LogFile:\")){\n            //log.info(\"Found a log file\");\n            List<LogMessage> messageList = decodeLog(recordedRequest.getResponse());\n            \n            RecordedRequest matchedRequest = null;\n            RecordedRequest matchedEnterRequest = null;\n            Integer timeDifference = Integer.MAX_VALUE;\n            Integer timeDifferenceEnterRequest = Integer.MAX_VALUE;\n            //log.info(\"Log messages = \" + messageList.size());\n            for(LogMessage message : messageList){\n                //log.info(message.getRawLog());\n                //log.info(\"Is page \" + message.isPageMessage() + \" isEnter \" + message.isEnter());\n                if(message.isPageMessage() && !message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    //log.info(\"We have a leave\");\n                    \n                    List<RecordedRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifference = Integer.MAX_VALUE;\n                    \n                    //log.info(\"**** \" + messagePageURL);\n                    for(RecordedRequest recordedRequest2 : messagePage) {\n                        //log.info(\"Request thing is \" + webProxyRequest2.getRequestURL());\n                        if(message.getTime() != null && recordedRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),recordedRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            //log.info(\"Old \" + timeDifference + \" diff \" + secondsDifference);\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifference)){\n                                timeDifference = secondsDifference;\n                                matchedRequest = recordedRequest2;\n                            }\n                        }\n                    }\n                    if(matchedRequest != null && Math.abs(timeDifference) < 30){\n                        //log.info(\"Added \" + message.getRawLog() + \" to \" + matchedRequest.getRequestURL());\n                        requestMapping.put(message, matchedRequest);\n                    }\n                } else if(message.isPageMessage() && message.isEnter()){\n                    String messagePageURL = message.getPage();\n                    if(message.getPage() != null && message.getPage().contains(\"ReportController\")){\n                        messagePageURL = \"ReportController\" ;\n                    }\n                    \n                    List<RecordedRequest> messagePage = trackerNode.getRequestsByURL(internalURL + messagePageURL);\n                    timeDifferenceEnterRequest = Integer.MAX_VALUE;\n                    \n                    //log.info(\"We have an enter here\");\n                    \n                    for(RecordedRequest recordedRequest2 : messagePage) {\n                        if(message.getTime() != null && recordedRequest2.getResponseDateTimeFromHeaders() != null){\n                            Integer secondsDifference = org.joda.time.Seconds.secondsBetween(message.getTime(),recordedRequest2.getResponseDateTimeFromHeaders()).getSeconds();\n                            if(Math.abs(secondsDifference) < Math.abs(timeDifferenceEnterRequest)){\n                                timeDifferenceEnterRequest = secondsDifference;\n                                matchedEnterRequest = recordedRequest2;\n                            }\n                        }\n                    }\n                    //if(matchedEnterRequest != null && Math.abs(timeDifference) < 30){\n                        //requestMapping.put(message, matchedEnterRequest);\n                    //}\n                } else { // These are other random log bits\n                //log.info(\"Found error \" + matchedEnterRequest + \" --- \" + timeDifferenceEnterRequest + \" ---- \" + message.getRawLog());\n                    if (matchedEnterRequest != null && Math.abs(timeDifferenceEnterRequest) < 30) { // We match it up to the last page request, it probably belongs to that?  As far as we know.\n                        //log.info(\"Added error\");\n                        errorMapping.put(message, matchedEnterRequest);\n                    }\n                }\n            }\n        }\n    }\n    \n    // log.info(requestMapping.size() + \" mapped requests\");\n    // log.info(errorMapping.size() + \" errors mapped to requests\");\n    \n    // log.info(\"ERRORS\");\n    // for(LogMessage logMessage : errorMapping.keySet()){\n    //     log.info(\"Error \" + logMessage.getRawLog() + \" belongs to \" + errorMapping.get(logMessage).getRequestURL() + \" at \" + errorMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    // log.info(\"\");\n    // log.info(\"REQUESTS\");\n    // for(LogMessage logMessage : requestMapping.keySet()){\n    //     log.info(\"Request \" + logMessage.getRawLog() + \" belongs to \" + requestMapping.get(logMessage).getRequestURL() + \" at \" + requestMapping.get(logMessage).getResponseDateTimeFromHeaders());\n    // }\n    \n    reportErrors(requestMapping,errorMapping);\n    \n    runAndWait(\"Report Setup\");\n}\n\npublic void reportErrors(LinkedHashMap<LogMessage, RecordedRequest> requestMapping, LinkedHashMap<LogMessage, RecordedRequest> errorMapping) {\n    Integer excelSize = (requestMapping.size() + errorMapping.size()) * 2;\n    \n    log.info(\"Requests \" + requestMapping.size() + \" Error \" + errorMapping.size());\n    log.info(\"Excel size \" + excelSize);\n    \n    if(excelSize < 1){\n        excelSize = 10;\n    }\n    \n    Export export = new Export(excelSize * 3,5);\n    Export exportTrimmed = new Export(excelSize * 3,5);\n    \n    setExportHeaders(export,requestMapping.size(),errorMapping.size());\n    setExportHeaders(exportTrimmed,requestMapping.size(),errorMapping.size());\n    \n    // Requests\n    Integer lineCounter = 1;\n    for(LogMessage logMessage : requestMapping.keySet()){\n        export.add(new ExportValue(logMessage.getPage(),lineCounter,0));\n        org.joda.time.format.DateTimeFormatter dtfOut = org.joda.time.format.DateTimeFormat.forPattern(\"HH:mm:ss MM/dd/yyyy\");\n        export.add(new ExportValue(dtfOut.print(logMessage.getTime()),lineCounter,1));\n        export.add(new ExportValue(logMessage.getUser(),lineCounter,2));\n        export.add(new ExportValue(logMessage.getDuration(),lineCounter,3));\n        \n        Boolean addedLine = false;\n        for(LogMessage errorLog : errorMapping.keySet()){\n            if(requestMapping.get(logMessage) == errorMapping.get(errorLog)){\n                export.add(new ExportValue(errorLog.getRawLog(),lineCounter,4));\n                lineCounter++;\n                addedLine = true;\n            }\n        }\n        \n        if(!addedLine){\n            lineCounter++;    \n        }\n    }\n    \n    // Trimmed version\n    Integer lineCounterTrimmed = 1; \n    for(int i=1;i<export.getRowCount();i++){\n        ExportValue exportValue = (ExportValue)export.getValue(i,4);\n        if(exportValue != null && exportValue.getDataValue() != null){\n            ExportValue exportValue0 = (ExportValue)export.getValue(i,0);\n            ExportValue exportValue1 = (ExportValue)export.getValue(i,1);\n            ExportValue exportValue2 = (ExportValue)export.getValue(i,2);\n            ExportValue exportValue3 = (ExportValue)export.getValue(i,3);\n            ExportValue exportValue4 = (ExportValue)export.getValue(i,4);\n            if(exportValue0 != null){\n                exportTrimmed.add(new ExportValue(exportValue0.getDataValue(),lineCounterTrimmed,0));    \n            }\n            if(exportValue1 != null){\n                exportTrimmed.add(new ExportValue(exportValue1.getDataValue(),lineCounterTrimmed,1));    \n            }\n            if(exportValue2 != null){\n                exportTrimmed.add(new ExportValue(exportValue2.getDataValue(),lineCounterTrimmed,2));    \n            }\n            if(exportValue3 != null){\n                exportTrimmed.add(new ExportValue(exportValue3.getDataValue(),lineCounterTrimmed,3));    \n            }\n            if(exportValue4 != null){\n                exportTrimmed.add(new ExportValue(exportValue4.getDataValue(),lineCounterTrimmed,4));    \n            }          \n\n            lineCounterTrimmed++;\n        }\n    }\n    \n    nodeRunParams.setOneTimeVariable(export);\n    runAndWait(\"Perf Excel Log\", nodeRunParams);\n    nodeRunParams.setOneTimeVariable(exportTrimmed);\n    runAndWait(\"Perf Excel Log Trimmed\", nodeRunParams);\n}\n\npublic void setExportHeaders(Export export, Integer requestcount, Integer errorCount){\n    // Header row\n    export.add(new ExportValue(\"Request (\" + requestcount + \")\",0,0));\n    export.add(new ExportValue(\"Time\",0,1));\n    export.add(new ExportValue(\"User\",0,2));\n    export.add(new ExportValue(\"Duration\",0,3));\n    export.add(new ExportValue(\"Log Errors (\" + errorCount + \")\",0,4));\n}\n\npublic List<LogMessage> decodeLog(String logRequest) {\n    String lines[] = logRequest.split(\"\\\\r?\\\\n\");\n\n    org.joda.time.DateTime time = new org.joda.time.DateTime();\n    \n    List<LogMessage> logMessages = new ArrayList<>();\n    \n    for(int i = 0;i< lines.length;i++){\n        String line = lines[i];\n        \n        LogMessage logMessage = new LogMessage();\n        logMessage.setRawLog(line);\n        \n        if(line.contains(\"[monitor]\")) { // This is a page log message\n            HashMap<String, String> result = decodeLogLine(line);\n\n            logMessage.setUser(result.get(\"USER\"));\n            logMessage.setPage(result.get(\"PAGE\"));\n            logMessage.setDuration(result.get(\"DURATION\"));\n            logMessage.setIsEnter(result.get(\"ENTER\"));\n            logMessage.parseTime(result.get(\"TIME\"));\n            logMessage.setIsPageMessage(true);\n        } else { // This is anything else, could be an exception\n            logMessage.setIsPageMessage(false);\n        }\n        \n        logMessages.add(logMessage);\n    }\n    \n    return logMessages;\n}\n\npublic HashMap<String,String> decodeLogLine(String logLine) {\n    String sections[] = logLine.split(\",\");\n    \n    HashMap<String, String> parsedLine = new HashMap<>();\n    \n    //log.info(\"Length = \" + sections.length);\n    if(sections.length == 16 || sections.length == 26){ // All logs have 16 parts\n        String time = sections[0] + \",\" + sections[1].substring(0,3);\n        String enterLeave =  sections[1].substring(20,25);\n        String user = sections[7];\n        String page = sections[9];\n        String duration = sections[11];\n        \n        parsedLine.put(\"TIME\",time);\n        parsedLine.put(\"ENTER\",enterLeave);\n        parsedLine.put(\"PAGE\",page);\n        parsedLine.put(\"USER\",user);\n        parsedLine.put(\"DURATION\",duration);\n    }\n    \n    return parsedLine;\n}\n\nprivate class LogMessage {\n    private String rawLog = \"\";\n    private Boolean isPageMessage = false;\n    private Boolean isEnter = false;\n    private String page = \"\";\n    private String user = \"\";\n    private String duration = \"\";\n    private org.joda.time.DateTime time; \n    \n    public LogMessage() {\n    }\n    \n    public org.joda.time.DateTime getTime() {\n        return time;\n    }\n    \n    public void parseTime(String timeStr) {\n        InputNode inputNode = (InputNode)getNode(\"Login Input\");\n        \n        String timeZoneStr = inputNode.getInputByName(\"[[logTimeZone]]\").getVariableValue();\n        org.joda.time.DateTimeZone zone = null;\n        if(timeZoneStr != null){\n            zone = org.joda.time.DateTimeZone.forID(timeZoneStr);\n        }\n        \n        if(timeStr != null){\n            Integer year = Integer.parseInt(timeStr.substring(0,4));\n            Integer month = Integer.parseInt(timeStr.substring(5,7));\n            Integer day = Integer.parseInt(timeStr.substring(8,10));\n            Integer hour = Integer.parseInt(timeStr.substring(11,13));\n            Integer minute = Integer.parseInt(timeStr.substring(14,16));\n            Integer second = Integer.parseInt(timeStr.substring(17,19));\n            Integer millisecond = Integer.parseInt(timeStr.substring(20,23));\n        \n            if(zone != null){\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond,zone); \n            } else {\n                time = new org.joda.time.DateTime(year,month,day,hour,minute,second,millisecond); \n            }\n        }\n    }\n    \n    public String getDuration() {\n        return duration;\n    }\n    \n    public void setDuration(String duration) {\n        this.duration = duration;\n    }\n    \n    public Boolean isEnter() {\n        return isEnter;\n    }\n    \n    public void setIsEnter(String isEnter){\n        this.isEnter = \"Enter\".equals(isEnter);\n    }\n    \n    public String getPage() {\n        return page;\n    }\n    \n    public void setPage(String page){\n        this.page = page;\n    }\n    \n    public String getUser() {\n        return user;\n    }\n    \n    public void setUser(String user){\n        this.user = user;\n    }\n    \n    public String getRawLog() {\n        return rawLog;\n    }\n    \n    public void setRawLog(String rawLog){\n        this.rawLog = rawLog;\n    }\n    \n    public Boolean isPageMessage() {\n        return isPageMessage;\n    }\n    \n    public void setIsPageMessage(Boolean isPageMessage){\n        this.isPageMessage = isPageMessage;\n    }\n}','java.lang.String'),(18092,2831,'X','2116.0','java.lang.Double'),(18093,2831,'Id','2831','java.lang.Integer'),(18094,2831,'Y','-461.0','java.lang.Double'),(18095,2831,'ContainedText','Read Perf Log','java.lang.String'),(18096,2831,'NextNodeToRun','','java.lang.String'),(18097,2832,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59/HSBC Websphere Blackfeather 9080','java.lang.String'),(18098,2832,'FileOutputName','HSBC Websphere Blackfeather 9080-Report Test-[DATE]','java.lang.String'),(18099,2832,'X','2277.0','java.lang.Double'),(18100,2832,'Id','2832','java.lang.Integer'),(18101,2832,'Y','-461.0','java.lang.Double'),(18102,2832,'ContainedText','Perf Excel Log','java.lang.String'),(18103,2832,'NextNodeToRun','Email Perf Excel Results','java.lang.String'),(18104,2833,'FileOutputDirectory','C:/Users/alex/Downloads/SDE-2015-10-21 16-11-59/HSBC Websphere Blackfeather 9080','java.lang.String'),(18105,2833,'FileOutputName','HSBC Websphere Blackfeather 9080-Report Test-[DATE]','java.lang.String'),(18106,2833,'X','2276.0','java.lang.Double'),(18107,2833,'Id','2833','java.lang.Integer'),(18108,2833,'Y','-407.0','java.lang.Double'),(18109,2833,'ContainedText','Perf Excel Log Trimmed','java.lang.String'),(18110,2833,'NextNodeToRun','','java.lang.String'),(18111,2834,'Logic','public void function() {\n   log.info(\"Sample code\");\n}','java.lang.String'),(18112,2834,'X','2427.0','java.lang.Double'),(18113,2834,'Id','2834','java.lang.Integer'),(18114,2834,'Y','-461.0','java.lang.Double'),(18115,2834,'ContainedText','Email Perf Excel Results','java.lang.String'),(18116,2834,'NextNodeToRun','','java.lang.String'),(18117,2835,'X','1002.0','java.lang.Double'),(18118,2835,'Id','2835','java.lang.Integer'),(18119,2835,'Y','92.0','java.lang.Double'),(18120,2835,'ContainedText','Tests to run','java.lang.String'),(18121,2835,'NextNodeToRun','','java.lang.String'),(18122,2836,'X','-59.0','java.lang.Double'),(18123,2836,'Id','2836','java.lang.Integer'),(18124,2836,'Y','742.0','java.lang.Double'),(18125,2836,'ContainedText','Track','java.lang.String'),(18126,2836,'NextNodeToRun','','java.lang.String'),(18127,2837,'Test','track>trackerNode::Track\n\n// Logging in\nurl>url::http://jboss-alex:8080/spl/focal/Login\nwait>clickable::id::login\ninput>id::j_username>value::alex\ninput>id::j_password>value::a\nclick>id::login\nwait>specificTime::50\nwait>finishAllRequests::30000\nwait>presence::id::content\nwait>frameLoaded::frame::content\nframe>id::content\nwait>presence::id::hierarchySelectIframe\nframe>id::hierarchySelectIframe\nwait>presence::id::hierarchySelectTable\n\n// Logout once done\nframe>select::default\nclick>xPath:://*[@id=\"logOut\"]/a\nwait>specificTime::1500\nexit>\nend>','java.lang.String'),(18128,2837,'X','-132.0','java.lang.Double'),(18129,2837,'Id','2837','java.lang.Integer'),(18130,2837,'Y','695.0','java.lang.Double'),(18131,2837,'ContainedText','Request','java.lang.String'),(18132,2837,'NextNodeToRun','','java.lang.String');
/*!40000 ALTER TABLE `node_details` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `program`
--

DROP TABLE IF EXISTS `program`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `program` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(100) DEFAULT NULL,
  `start_node` int(11) DEFAULT NULL,
  `view_offset_height` double DEFAULT NULL,
  `view_offset_width` double DEFAULT NULL,
  `user_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`)
) ENGINE=InnoDB AUTO_INCREMENT=155 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `program`
--

LOCK TABLES `program` WRITE;
/*!40000 ALTER TABLE `program` DISABLE KEYS */;
INSERT INTO `program` VALUES (17,'Worksheet Popup Test',1213,-382,222,1),(107,'Random Tests',2837,-490,511,1),(141,'New program',2195,-187,47,1),(153,'Quick Script - 21th October ',2723,147,-572,1),(154,'Full Script - 3rd November',2791,148,-360,1);
/*!40000 ALTER TABLE `program` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `recorded_requests`
--

DROP TABLE IF EXISTS `recorded_requests`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `recorded_requests` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `http_proxy_id` int(11) DEFAULT NULL,
  `url` varchar(3000) DEFAULT NULL,
  `duration` int(11) DEFAULT NULL,
  `request_size` int(11) DEFAULT NULL,
  `response_size` int(11) DEFAULT NULL,
  `request_content` mediumtext,
  `response_content` mediumtext,
  PRIMARY KEY (`id`),
  KEY `http_proxy_id` (`http_proxy_id`),
  CONSTRAINT `recorded_requests_ibfk_1` FOREIGN KEY (`http_proxy_id`) REFERENCES `http_proxies` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=6615 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `recorded_requests`
--

LOCK TABLES `recorded_requests` WRITE;
/*!40000 ALTER TABLE `recorded_requests` DISABLE KEYS */;
/*!40000 ALTER TABLE `recorded_requests` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `schema_version`
--

DROP TABLE IF EXISTS `schema_version`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `schema_version` (
  `version_rank` int(11) NOT NULL,
  `installed_rank` int(11) NOT NULL,
  `version` varchar(50) NOT NULL,
  `description` varchar(200) NOT NULL,
  `type` varchar(20) NOT NULL,
  `script` varchar(1000) NOT NULL,
  `checksum` int(11) DEFAULT NULL,
  `installed_by` varchar(100) NOT NULL,
  `installed_on` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `execution_time` int(11) NOT NULL,
  `success` tinyint(1) NOT NULL,
  PRIMARY KEY (`version`),
  KEY `schema_version_vr_idx` (`version_rank`),
  KEY `schema_version_ir_idx` (`installed_rank`),
  KEY `schema_version_s_idx` (`success`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `schema_version`
--

LOCK TABLES `schema_version` WRITE;
/*!40000 ALTER TABLE `schema_version` DISABLE KEYS */;
INSERT INTO `schema_version` VALUES (2,2,'01.101','BaseDatabase','SQL','01_101__BaseDatabase.sql',489029075,'spiralinks','2015-07-07 18:07:40',120,1),(3,3,'01.102','Add FileStoreNode','SQL','01_102__Add FileStoreNode.sql',1043480203,'spiralinks','2015-10-08 22:25:33',180,1),(4,4,'01.103','Add DataTableNode','SQL','01_103__Add DataTableNode.sql',-395437438,'spiralinks','2015-10-12 16:27:30',287,1),(5,5,'01.104','Add DataTables Tables','SQL','01_104__Add DataTables Tables.sql',1747208848,'spiralinks','2015-10-13 17:10:21',65,1),(6,6,'01.105','Add web request tables','SQL','01_105__Add web request tables.sql',-1688490604,'spiralinks','2015-11-04 18:51:33',27,1),(1,1,'1','<< Flyway Baseline >>','BASELINE','<< Flyway Baseline >>',NULL,'spiralinks','2015-07-07 17:13:04',0,1);
/*!40000 ALTER TABLE `schema_version` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `serialized`
--

DROP TABLE IF EXISTS `serialized`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `serialized` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `node_id` int(11) DEFAULT NULL,
  `serial_object` mediumblob,
  `serial_reference` varchar(1000) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `node_id` (`node_id`),
  CONSTRAINT `serialized_ibfk_1` FOREIGN KEY (`node_id`) REFERENCES `node` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=1193 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `serialized`
--

LOCK TABLES `serialized` WRITE;
/*!40000 ALTER TABLE `serialized` DISABLE KEYS */;
INSERT INTO `serialized` VALUES (246,1211,'\0sr\0java.util.HashMap`\0F\0\nloadFactorI\0	thresholdxp?@\0\0\0\0\0w\0\0\0\0\0\0t\0EMPLOYEE DETAILSt\0No errort\0COMPENSATION DETAILSt\0No errort\0ORG LEVEL CHANGE DETAILSt\0No errort\0EMPLOYEE INTL ASSIGNEEt\0No errort\0EMPLOYEE COMMENTSt\0No errort\0VARIABLE PAYt\0No errort\0MARKET DATA DETAILSt\01002 Error seenx','popupResults'),(555,1564,'\0sr\0java.io.File-E\r\0L\0patht\0Ljava/lang/String;xpt\0\"C:\\Users\\alex\\SDE\\sdeFiles\\555.tmpw\0\\x',''),(1188,2793,'\0sr\0java.util.ArrayListxa\0I\0sizexp\0\0\0\0w\0\0\0\0x','envs'),(1189,2797,'\0sr\0java.lang.Integer8\0I\0valuexr\0java.lang.Number\0\0xp\0\0\0','envCounter'),(1190,2823,'\0t\00C:/Users/alex/Downloads/SDE-2015-11-04 21-38-20/','outputFolder'),(1191,2780,'\0sr\0java.util.HashMap`\0F\0\nloadFactorI\0	thresholdxp?@\0\0\0\0\0w\0\0\0\0\0\0t\0V6 Demo QA (Oracle)sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0psq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0t\0menuDescriptiont\0Termination Reasont\0htmlPatht\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsr\0java.util.LinkedHashMap4N\\l\0Z\0accessOrderxq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0t\0averageTimesr\0java.lang.Long;#\0J\0valuexr\0java.lang.Number\0\0xp\0\0\0\0\0\0\0t\0countsr\0java.lang.Integer8\0I\0valuexq\0~\0\r\0\0\0#x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rCurrency Listq\0~\0t\06http://10.255.210.10:8180/spl/focal/UpdateCurrencyListxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0[q\0~\0sq\0~\0\0\0\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0	Logos Etcq\0~\0t\08http://10.255.210.10:8180/spl/focal/UpdateServerSettingsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Emailq\0~\0t\0/http://10.255.210.10:8180/spl/focal/EmailConfigxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0App Dataq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0	Job Codesq\0~\0t\0,http://10.255.210.10:8180/spl/focal/JobCodesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Merit guidelinesq\0~\0t\03http://10.255.210.10:8180/spl/focal/MeritGuidelinesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\'q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0FX Ratesq\0~\0t\01http://10.255.210.10:8180/spl/focal/UpdateFxRatesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Roundingq\0~\0t\01http://10.255.210.10:8180/spl/focal/RoundingRulesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\nq\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Generate Formsq\0~\0t\05http://10.255.210.10:8180/spl/focal/GenerateFormsPerfxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rCopy Templateq\0~\0t\00http://10.255.210.10:8180/spl/focal/CopyTemplatexsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Add Managersq\0~\0t\04http://10.255.210.10:8180/spl/focal/HierarchyBuilderxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Lumpsum Settingsq\0~\0t\0.http://10.255.210.10:8180/spl/focal/LumpSumAmtxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Server Inboundq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Server Outboundq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\nLog Levelsq\0~\0t\02http://10.255.210.10:8180/spl/focal/LogLevelsAdminxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Salaryq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rHeader/Footerq\0~\0t\06http://10.255.210.10:8180/spl/focal/HeaderFooterConfigxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0AwardType Datesq\0~\0t\02http://10.255.210.10:8180/spl/focal/AwardTypeDatesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Market Dataq\0~\0t\03http://10.255.210.10:8180/spl/focal/AdminMarketDataxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0>q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Application Localeq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0IncentivePlan Bonus Typesq\0~\0t\0;http://10.255.210.10:8180/spl/focal/IncentivePlanBonusTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Statement Archiveq\0~\0t\00http://10.255.210.10:8180/spl/focal/ArchiveMaintxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Locale Dataq\0~\0t\02http://10.255.210.10:8180/spl/focal/LocaleDataListxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Remodel Hierarchyq\0~\0t\08http://10.255.210.10:8180/spl/focal/RestructureHierarchyxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Daily Importq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Sort Filter Configq\0~\0t\04http://10.255.210.10:8180/spl/focal/SortFilterConfigxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\rq\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0People Worksheetq\0~\0t\09http://10.255.210.10:8180/spl/focal/ConfigurableWorksheetxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0rq\0~\0sq\0~\0\0\0\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Business Functionsq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Stock Valuesq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Reports Controllerq\0~\0t\04http://10.255.210.10:8180/spl/focal/ReportControllerxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Server Configurationq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Company Codeq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Query Analyzerq\0~\0t\01http://10.255.210.10:8180/spl/focal/QueryAnalyzerxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Menus Annual Importsq\0~\0t\06http://10.255.210.10:8180/spl/focal/MenusAnnualImportsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Eligibility Rulesq\0~\0t\0=http://10.255.210.10:8180/spl/focal/EligibilityProfileDisplayxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0%q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Menus Online Importsq\0~\0t\00http://10.255.210.10:8180/spl/focal/MenusImportsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Vesting Scheduleq\0~\0t\03http://10.255.210.10:8180/spl/focal/VestingSchedulexsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Locale Categoryq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Vesting Distributionq\0~\0t\0:http://10.255.210.10:8180/spl/focal/VestingScheduleProcessxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Build Templatesq\0~\0t\08http://10.255.210.10:8180/spl/focal/PerformanceTemplatesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Ratingsq\0~\0t\0+http://10.255.210.10:8180/spl/focal/Ratingsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Purge Maintenanceq\0~\0t\0.http://10.255.210.10:8180/spl/focal/PurgeMaintxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Graphicsq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Report Task Parametersq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Deferral Flagsq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Filter Operatorq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\ZDisplay Dictionary Ratingsq\0~\0t\0;http://10.255.210.10:8180/spl/focal/RatingBasedEditElementsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Accept All Worksheetsq\0~\0t\08http://10.255.210.10:8180/spl/focal/ApproveAllworksheetsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Award Summary Typeq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rAnnual Exportq\0~\0t\00http://10.255.210.10:8180/spl/focal/AnnualExportxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Single Sign Onq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Perf Summaryq\0~\0t\0Chttp://10.255.210.10:8180/spl/focal/SummaryPerformanceConfigurationxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\01q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Performance Cycleq\0~\0t\0.http://10.255.210.10:8180/spl/focal/PerfCyclesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0}q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0	Key Datesq\0~\0t\0,http://10.255.210.10:8180/spl/focal/KeyDatesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\06q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Comp Guidelinesq\0~\0t\06http://10.255.210.10:8180/spl/focal/PerformanceRatingsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Menusq\0~\0t\0)http://10.255.210.10:8180/spl/focal/Menusxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rGlobal Gradesq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Display Dictionaryq\0~\0t\0<http://10.255.210.10:8180/spl/focal/DisplayDictionaryEntriesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Profileq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Accessq\0~\0t\0)http://10.255.210.10:8180/spl/focal/Rolesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Vestingq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Assignment Typeq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rMail Propertyq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Application Parametersq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Application Time Outq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Department Commentq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Unaccept All Worksheetsq\0~\0t\0:http://10.255.210.10:8180/spl/focal/unapproveAllworksheetsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Reset Summary Dataq\0~\0t\06http://10.255.210.10:8180/spl/focal/RebuildSummaryDataxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Define Custom Fieldsq\0~\0t\0=http://10.255.210.10:8180/spl/focal/DefineCustomFieldsDisplayxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0Bq\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Datesq\0~\0t\0-http://10.255.210.10:8180/spl/focal/RoleDatesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0oq\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Strike Priceq\0~\0t\0/http://10.255.210.10:8180/spl/focal/StrikePricexsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Approval Configurationq\0~\0t\09http://10.255.210.10:8180/spl/focal/ApprovalConfigurationxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Budgetq\0~\0t\04http://10.255.210.10:8180/spl/focal/AllocationSinglexsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Menus Exportq\0~\0t\04http://10.255.210.10:8180/spl/focal/MenusExportStartxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Employee Flagsq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0LookUpsq\0~\0t\0+http://10.255.210.10:8180/spl/focal/LookUpsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Ethnic Groupq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0System Messagesq\0~\0t\0:http://10.255.210.10:8180/spl/focal/SystemMessagesMainPagexsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rMenus Reportsq\0~\0t\00http://10.255.210.10:8180/spl/focal/MenusReportsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Display Dictionary Exportq\0~\0t\0;http://10.255.210.10:8180/spl/focal/DisplayDictionaryExportxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Batch Process Statusq\0~\0t\07http://10.255.210.10:8180/spl/focal/MultiBatchProcessorxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0nq\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Emails Auditq\0~\0t\05http://10.255.210.10:8180/spl/focal/AuditEmailDisplayxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Award Categoryq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Sectionsq\0~\0t\00http://10.255.210.10:8180/spl/focal/SectionsMenuxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0System Messageq\0~\0t\08http://10.255.210.10:8180/spl/focal/UpdateServerSettingsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Move EE or Deptq\0~\0t\04http://10.255.210.10:8180/spl/focal/HierarchyBuilderxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rSmart Remodelq\0~\0t\0=http://10.255.210.10:8180/spl/focal/SmartRestructureHierarchyxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Regionq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rEmployee Typeq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Bonusq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Comp Summaryq\0~\0t\08http://10.255.210.10:8180/spl/focal/SummaryConfigurationxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\07q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Locale Data Exportq\0~\0t\04http://10.255.210.10:8180/spl/focal/LocaleDataExportxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Rebuild Organizationq\0~\0t\04http://10.255.210.10:8180/spl/focal/RebuildHierarchyxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Commentsq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Manage Usersq\0~\0t\0)http://10.255.210.10:8180/spl/focal/Usersxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Server Communicationq\0~\0t\07http://10.255.210.10:8180/spl/focal/ServerCommunicationxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Menusq\0~\0t\06http://10.255.210.10:8180/spl/focal/MenusConfigurationxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0	Quartilesq\0~\0t\0-http://10.255.210.10:8180/spl/focal/Quartilesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\nSchedulingq\0~\0t\0.http://10.255.210.10:8180/spl/focal/Schedulingxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0(q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\nImport Logq\0~\0t\0.http://10.255.210.10:8180/spl/focal/ImportsLogxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Clear Down Databaseq\0~\0t\05http://10.255.210.10:8180/spl/focal/ClearDownDatabasexsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rSPL Technicalq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Deferralq\0~\0t\09http://10.255.210.10:8180/spl/focal/DeferralActionDisplayxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0,q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Daily Import Locationq\0~\0t\0/http://10.255.210.10:8180/spl/focal/LookupTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Award Typesq\0~\0t\0.http://10.255.210.10:8180/spl/focal/BonusTypesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\ZAnnual Archive Maintenanceq\0~\0t\07http://10.255.210.10:8180/spl/focal/AdvanceArchiveMaintxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Import Instructionsq\0~\0t\06http://10.255.210.10:8180/spl/focal/ImportInstructionsxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Worksheet Configq\0~\0t\09http://10.255.210.10:8180/spl/focal/ConfigurableWorksheetxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0rq\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0\rCountry Namesq\0~\0t\0-http://10.255.210.10:8180/spl/focal/Countriesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Incentive Plansq\0~\0t\02http://10.255.210.10:8180/spl/focal/IncentivePlansxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0sq\0~\0\0?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0t\0Comp Frequenciesq\0~\0t\03http://10.255.210.10:8180/spl/focal/CompFrequenciesxsq\0~\0	?@\0\0\0\0\0w\0\0\0\0\0\0q\0~\0sq\0~\0\0\0\0\0\0\0\0q\0~\0q\0~\0x\0xx','exportData'),(1192,2784,'\0sr\0java.lang.Integer8\0I\0valuexr\0java.lang.Number\0\0xp\0\0\0','repeatCount');
/*!40000 ALTER TABLE `serialized` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `switch`
--

DROP TABLE IF EXISTS `switch`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `switch` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `node_id` int(11) DEFAULT NULL,
  `target` varchar(100) DEFAULT NULL,
  `enabled` tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `node_id` (`node_id`),
  CONSTRAINT `switch_ibfk_1` FOREIGN KEY (`node_id`) REFERENCES `node` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `switch_ibfk_2` FOREIGN KEY (`node_id`) REFERENCES `node` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=345 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `switch`
--

LOCK TABLES `switch` WRITE;
/*!40000 ALTER TABLE `switch` DISABLE KEYS */;
INSERT INTO `switch` VALUES (331,2724,'V6 Demo QA (Oracle)',1),(332,2724,'V6 Demo QA (MySQL)',1),(333,2724,'Netsuite Baseline',1),(334,2724,'Sephora Stores NE UAT',1),(335,2724,'V6 Demo Oracle Sales',1),(336,2724,'HSBC Websphere Blackfeather 9080',1),(337,2724,'Victrex UAT',1),(338,2792,'V6 Demo QA (Oracle)',1),(339,2792,'V6 Demo QA (MySQL)',0),(340,2792,'Netsuite Baseline',0),(341,2792,'Sephora Stores NE UAT',0),(342,2792,'V6 Demo Oracle Sales',0),(343,2792,'HSBC Websphere Blackfeather 9080',0),(344,2792,'Victrex UAT',0);
/*!40000 ALTER TABLE `switch` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `test_result`
--

DROP TABLE IF EXISTS `test_result`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `test_result` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2395 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `test_result`
--

LOCK TABLES `test_result` WRITE;
/*!40000 ALTER TABLE `test_result` DISABLE KEYS */;
/*!40000 ALTER TABLE `test_result` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `test_step`
--

DROP TABLE IF EXISTS `test_step`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `test_step` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `test_string` varchar(1000) DEFAULT NULL,
  `expected_equal` varchar(1000) DEFAULT NULL,
  `observed_equal` varchar(1000) DEFAULT NULL,
  `screenshot` mediumblob,
  `successful` tinyint(1) DEFAULT NULL,
  `test_result` int(11) DEFAULT NULL,
  `test_type` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `test_result` (`test_result`),
  CONSTRAINT `test_step_ibfk_1` FOREIGN KEY (`test_result`) REFERENCES `test_result` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=1145987 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `test_step`
--

LOCK TABLES `test_step` WRITE;
/*!40000 ALTER TABLE `test_step` DISABLE KEYS */;
/*!40000 ALTER TABLE `test_step` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `trigger_condition`
--

DROP TABLE IF EXISTS `trigger_condition`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `trigger_condition` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `node_id` int(11) DEFAULT NULL,
  `trigger_watch` varchar(100) DEFAULT NULL,
  `trigger_when` varchar(100) DEFAULT NULL,
  `trigger_then` varchar(100) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `node_id` (`node_id`),
  CONSTRAINT `trigger_condition_ibfk_1` FOREIGN KEY (`node_id`) REFERENCES `node` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `trigger_condition`
--

LOCK TABLES `trigger_condition` WRITE;
/*!40000 ALTER TABLE `trigger_condition` DISABLE KEYS */;
INSERT INTO `trigger_condition` VALUES (1,2764,'Con','New line','Send line on..');
/*!40000 ALTER TABLE `trigger_condition` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user`
--

DROP TABLE IF EXISTS `user`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(100) DEFAULT NULL,
  `last_program` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `last_program` (`last_program`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user`
--

LOCK TABLES `user` WRITE;
/*!40000 ALTER TABLE `user` DISABLE KEYS */;
INSERT INTO `user` VALUES (1,'alex',154);
/*!40000 ALTER TABLE `user` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2015-11-05  7:04:44
